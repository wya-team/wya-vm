(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"./src/libs/vm.min.js":function(t,n,e){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return t&&"object"===r(t)&&"default"in t?t.default:t}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./node_modules/lodash/lodash.js"),a=e("./node_modules/@wya/utils/lib/index.js"),s=i(e("./node_modules/@babel/runtime/helpers/defineProperty.js")),l=i(e("./node_modules/@babel/runtime/helpers/slicedToArray.js")),A=i(e("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js")),d=i(e("./node_modules/@babel/runtime/helpers/classCallCheck.js")),m=i(e("./node_modules/@babel/runtime/helpers/createClass.js")),c=i(e("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),p=i(e("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),u=i(e("./node_modules/@babel/runtime/helpers/inherits.js")),h=i(e("./node_modules/vue/dist/vue.esm.js")),g=i(e("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),b=i(e("./node_modules/@wya/vc/lib/customer/index.js")),f=i(e("./node_modules/@wya/vc/lib/portal/index.js")),v=i(e("./node_modules/@wya/vc/lib/slider/index.js")),x=i(e("./node_modules/@wya/vc/lib/select/index.js")),E=i(e("./node_modules/@wya/vc/lib/option/index.js")),y=i(e("./node_modules/@wya/vc/lib/clipboard/index.js")),w=e("./node_modules/@wya/vc/lib/utils/index.js"),C=(i(w),i(e("./node_modules/@babel/runtime/helpers/typeof.js"))),_=function(){var t=!1;try{var n=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,n)}catch(t){console.log(t)}return t}(),$=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},k=+new Date,B=0,D=function(t){return"vm".concat(t?"-".concat(t):"","-").concat(k).concat(++B)},S=function(t){return t!=t},O=function(t,n){for(var e in n)if(n[e].test(t[e]))return!0;return!1},z=document.documentElement,M=[0,45,90,135,180,225,270,315,360],F={start:["touchstart","mousedown"],move:["touchmove","mousemove"],end:["touchend","touchcancel","mouseup"]},T={replace:!0,name:"vm-draggable",props:{handles:{type:Array,default:function(){return["top","right","bottom","left","top-left","top-right","bottom-right","bottom-left","rotate"]}},w:{type:Number,default:0,validator:function(t){return t>=0}},h:{type:Number,default:0,validator:function(t){return t>=0}},r:{type:Number,default:0},minW:{type:Number,default:36,validator:function(t){return t>0}},minH:{type:Number,default:36,validator:function(t){return t>0}},x:{type:Number,default:0},y:{type:Number,default:0},z:{type:Number,default:1},scale:{type:Number,default:1},grid:{type:Array,default:function(){return[1,1]}},guides:{type:Array,default:function(){return[[],[]]}},restrain:{type:Number,default:0},parent:{type:Boolean,default:!1},entryRegExp:{type:Object,default:function(){return{className:/vm-hack-entry/,id:/^(app|pages)$/}}},editorRegExp:{type:Object,default:function(){return{className:/vm-hack-editor/}}},prevent:{type:Boolean,default:!0},preventRegExp:{type:Object,default:function(){return{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT|OPTION)$/,className:/vm-hack-pevent/}}},module:{type:String},disabled:{type:Boolean,default:!1},closeable:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},rotatable:{type:Boolean,default:!0},active:{type:Boolean,default:!1},offset:{type:Array,default:function(){return[0,0]}}},data:function(){return{isResizing:!1,isDraging:!1,isRotating:!1,isChanging:!1,isActive:!1}},computed:{coord:function(){return{left:this.x+"px",top:this.y+"px",zIndex:this.isActive&&"page"!==this.module?999:this.z}},style:function(){return{width:0===this.w?"auto":"".concat(this.w,"px"),height:0===this.h?"auto":"".concat(this.h,"px"),transform:"rotate(".concat(this.r,"deg)")}},width:function(){var t=Math.floor(1.15*Math.sqrt(this.w*this.w+this.h*this.h));return"".concat(t,"px")},realHandles:function(){var t=this.handles;return this.rotatable||(t=t.filter((function(t){return"rotate"!==t}))),this.resizable||(t=t.filter((function(t){return"rotate"===t}))),t}},watch:{},beforeCreate:function(){this.parentX=0,this.parentY=0,this.parentW=9999,this.parentH=9999,this.mouseX=0,this.mouseY=0,this.lastMouseX=0,this.lastMouseY=0,this.mouseOffX=0,this.mouseOffY=0,this.handle=null,this.eventOpts=!_||{capture:!0,passive:!0},this.beforeStatus=null},mounted:function(){var t=this;this.w&&this.minW>this.w&&this.sync({w:this.minW}),this.h&&this.minH>this.h&&this.sync({h:this.minH}),this.$nextTick((function(){var n=t.$el.parentNode.getBoundingClientRect(),e=n.x,r=n.y;t.parentX=e+t.offset[0],t.parentY=r+t.offset[1],t.parent&&t.calculation(),t.$emit("resizing")}))},destroyed:function(){this.operateDOMEvents("remove")},methods:{calculation:function(){var t=this.$el.parentNode.getBoundingClientRect(),n=t.width,e=t.height;if(!n||!e)throw new Error("@wya/vm: 父层容器宽度计算异常");this.parentW=n/this.scale,this.parentH=e/this.scale,this.w>this.parentW&&this.sync({w:this.parentW}),this.h>this.parentH&&this.sync({h:this.parentH}),this.x+this.w>this.parentW&&this.sync({x:this.parentW-this.w}),this.y+this.h>this.parentH&&this.sync({y:this.parentH-this.h})},sync:function(t){for(var n in t)this[n]!=t[n]&&(!this.beforeStatus&&(this.beforeStatus={x:this.x,y:this.y,z:this.z,w:this.w,r:this.r}),this.$emit("update:".concat(n),t[n]))},operateDOMEvents:function(t){var n=this,e="add"===t?z.addEventListener:z.removeEventListener;F.start.forEach((function(t){e(t,n.handleDeselect,n.eventOpts)})),F.move.forEach((function(t){e(t,n.handleMove,n.eventOpts)})),F.end.forEach((function(t){e(t,n.handleUp,n.eventOpts)}))},setActived:function(){this.handleContainerDown(),this.handleUp()},handleContainerDown:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.prevent&&t.preventDefault&&!O(t.target,this.preventRegExp)&&t.preventDefault(),!this.disabled){var n=t.target||t.srcElement;if(!n||this.$el.contains(n)){if(!this.isActive){var e=this.getPositionByEvent(t),r=e.mousePositionX,i=e.mousePositionY;this.lastMouseX=r+z.scrollLeft,this.lastMouseY=i+z.scrollTop,this.operateDOMEvents("add"),this.isActive=!0,this.$emit("activated")}this.draggable&&(this.isDraging=!0)}}},handleDeselect:function(t){var n=this,e=this.getPositionByEvent(t),r=e.mousePositionX,i=e.mousePositionY;this.mouseX=r+z.scrollLeft,this.mouseY=i+z.scrollTop,this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY;var o=t.target||t.srcElement,a=t.path||t.composedPath&&t.composedPath()||[];!a.some((function(t){return O(t,n.entryRegExp)}))||this.$el.contains(o)||O(o,{className:/is-([(top|right|-|bottom|left)]{2})/})||a.some((function(t){return O(t,n.editorRegExp)}))||this.isActive&&(this.operateDOMEvents("remove"),this.isActive=!1,this.$emit("deactivated",t))},handleDown:function(t,n){this.prevent&&t.preventDefault&&!O(t.target,this.preventRegExp)&&t.preventDefault(),this.handle=n,"rotate"===n?this.rotatable&&(this.isRotating=!0):this.resizable&&(this.isResizing=!0);var e=this.getPositionByEvent(t);e.mousePositionX,e.mousePositionY},handleMove:function(t){var n=this.getPositionByEvent(t),e=n.mousePositionX,r=n.mousePositionY;this.mouseX=e+z.scrollLeft,this.mouseY=r+z.scrollTop;var i=parseInt(this.x,10),o=parseInt(this.y,10),a=parseInt(this.w,10),s=parseInt(this.h,10),l=Math.round((this.mouseX-this.parentX+this.offset[0])/this.scale),A=Math.round((this.mouseY-this.parentY+this.offset[1])/this.scale),d=l-Math.round((this.lastMouseX-this.parentX+this.offset[0])/this.scale),m=A-Math.round((this.lastMouseY-this.parentY+this.offset[1])/this.scale);if(this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY,this.isResizing)this.handle.includes("top")&&(o-A+s<this.minH?A=o+s-this.minH:this.parent&&A<0&&(A=0),s=o+s-A,o=A),this.handle.includes("bottom")&&(A-o<this.minH?A=o+this.minH:this.parent&&A>this.parentH&&(A=Math.round(this.parentH)),s=A-o),this.handle.includes("left")&&(i-l+a<this.minW?l=i+a-this.minW:this.parent&&l<0&&(l=0),a=i+a-l,i=l),this.handle.includes("right")&&(l-i<this.minW?l=i+this.minW:this.parent&&l>this.parentW&&(l=Math.round(this.parentW)),a=l-i),!this.disabled&&this.sync({x:Math.round(i/this.grid[0])*this.grid[0],y:Math.round(o/this.grid[1])*this.grid[1],w:Math.round(a/this.grid[0])*this.grid[0],h:Math.round(s/this.grid[1])*this.grid[1]}),this.$emit("resizing");else if(this.isRotating){var c=this.getAngle([this.parentX+this.x*this.scale+this.w/2*this.scale,-(this.parentY+this.y*this.scale+this.h/2*this.scale)],[this.lastMouseX+this.offset[0],-(this.lastMouseY+this.offset[1])]),p=M.find((function(t){return Math.abs(t-c)<3}));c="number"==typeof p?p:c,!this.disabled&&this.sync({r:360===c?0:c}),this.$emit("rotating")}else if(this.isDraging){var u=this.guides[0]&&this.guides[0].find((function(t){return Math.abs(i+d-t)<3})),h=this.guides[0]&&this.guides[0].find((function(t){return Math.abs(i+d+a-t)<2})),g=this.guides[1]&&this.guides[1].find((function(t){return Math.abs(o+m-t)<3})),b=this.guides[1]&&this.guides[1].find((function(t){return Math.abs(o+m+s-t)<2}));u&&(d=u-i),h&&(d=h-i-a),g&&(m=g-o),b&&(m=b-o-s),this.parent&&((i+d<0||i+d+a>this.parentW)&&(d=0),(o+m<0||o+m+s>this.parentH)&&(m=0)),i+=d,o+=m,!this.disabled&&this.sync({x:Math.round(i/this.grid[0])*this.grid[0],y:Math.round(o/this.grid[1])*this.grid[1]}),this.$emit("dragging")}!this.isChanging&&(this.isRotating||this.isDraging||this.isResizing)&&(this.isChanging=!0)},getAngle:function(t,n){var e=n[0]-t[0],r=n[1]-t[1],i=360*Math.atan2(r,e)/(2*Math.PI);return i=i>90?450-i:90-i,Math.floor(i)},getRestrain:function(t){var n=this.restrain;return(t/n).toFixed(0)*n},getPositionByEvent:function(t){return{mousePositionX:(t.targetTouches?t.targetTouches[0].pageX:t.clientX)||0,mousePositionY:(t.targetTouches?t.targetTouches[0].pageY:t.clientY)||0}},handleUp:function(t){this.isChanging=!1,this.handle=null;var n=this.restrain;n&&n>0&&this.sync({x:this.getRestrain(this.x),y:this.getRestrain(this.y),w:this.getRestrain(this.w),h:this.getRestrain(this.h)}),this.isRotating&&(this.isRotating=!1,this.$emit("rotate-end")),this.isResizing&&(this.isResizing=!1,this.$emit("resize-end")),this.isDraging&&(this.isDraging=!1,this.$emit("drag-end")),this.beforeStatus&&(this.$emit("end",this.beforeStatus),this.beforeStatus=null)}}};function N(t,n,e,r,i,o,a,s,l,A){"boolean"!=typeof a&&(l=s,s=a,a=!1);var d,m="function"==typeof e?e.options:e;if(t&&t.render&&(m.render=t.render,m.staticRenderFns=t.staticRenderFns,m._compiled=!0,i&&(m.functional=!0)),r&&(m._scopeId=r),o?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},m._ssrRegister=d):n&&(d=a?function(t){n.call(this,A(t,this.$root.$options.shadowRoot))}:function(t){n.call(this,s(t))}),d)if(m.functional){var c=m.render;m.render=function(t,n){return d.call(n),c(t,n)}}else{var p=m.beforeCreate;m.beforeCreate=p?[].concat(p,d):[d]}return e}var W,U="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function R(t){return function(t,n){return function(t,n){var e=U?n.media||"default":t,r=Y[e]||(Y[e]={ids:new Set,styles:[]});if(!r.ids.has(t)){r.ids.add(t);var i=n.source;if(n.map&&(i+="\n/*# sourceURL="+n.map.sources[0]+" */",i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n.map))))+" */"),r.element||(r.element=document.createElement("style"),r.element.type="text/css",n.media&&r.element.setAttribute("media",n.media),void 0===W&&(W=document.head||document.getElementsByTagName("head")[0]),W.appendChild(r.element)),"styleSheet"in r.element)r.styles.push(i),r.element.styleSheet.cssText=r.styles.filter(Boolean).join("\n");else{var o=r.ids.size-1,a=document.createTextNode(i),s=r.element.childNodes;s[o]&&r.element.removeChild(s[o]),s.length?r.element.insertBefore(a,s[o]):r.element.appendChild(a)}}}(t,n)}}var Y={};var X=T,P=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-draggable",class:t.draggable?"":"vm-draggable-disabled",style:t.coord,on:{mousedown:t.handleContainerDown,touchstart:function(n){return n.stopPropagation(),t.handleContainerDown(n)}}},[e("div",{class:{"is-events-none":t.isChanging},style:t.style},[t._t("default")],2),t._v(" "),(t.active||t.isActive)&&(t.closeable||t.realHandles.length>0)?e("div",{staticClass:"vm-draggable__handles",class:{"is-disabled":t.disabled,"is-active":t.active||t.isActive},style:t.style},[t._l(t.realHandles,(function(n){return[t.disabled?t._e():e("div",{key:n,staticClass:"vm-draggable__handle",class:"is-"+n,on:{mousedown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])?null:"button"in e&&0!==e.button?null:(e.stopPropagation(),t.handleDown(e,n))},touchstart:function(e){return e.stopPropagation(),t.handleDown(e,n)}}})]})),t._v(" "),t.rotatable&&t.isRotating?e("div",{staticClass:"vm-draggable__rotate",style:{width:t.width}}):t._e(),t._v(" "),t.closeable?e("p",{staticClass:"vm-draggable__delete",on:{click:function(n){return t.$emit("delete")}}},[t._v("✕")]):t._e()],2):t._e(),t._v(" "),t.isRotating?[e("div",{staticClass:"vm-draggable__rotate--deg is-0",style:{width:t.width}}),t._v(" "),e("div",{staticClass:"vm-draggable__rotate--deg is-45",style:{width:t.width}}),t._v(" "),e("div",{staticClass:"vm-draggable__rotate--deg is-90",style:{width:t.width}}),t._v(" "),e("div",{staticClass:"vm-draggable__rotate--deg is-135",style:{width:t.width}}),t._v(" "),e("div",{staticClass:"vm-draggable__rotate--tip"},[t._v(t._s(t.r)+" °")])]:t._e()],2)};P._withStripped=!0;var L=N({render:P,staticRenderFns:[]},(function(t){t&&t("data-v-47c58322_0",{source:'@charset "UTF-8";\n.vm-draggable {\n  padding: 0;\n  position: absolute;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n.vm-draggable:hover {\n  cursor: move;\n}\n.vm-draggable .is-events-none {\n  pointer-events: none;\n}\n.vm-draggable .is-delete {\n  background: #5495F6;\n  position: absolute;\n  right: 0;\n  width: 20px;\n  color: white;\n  text-align: center;\n  z-index: 300;\n}\n.vm-draggable-disabled:hover {\n  cursor: default;\n}\n.vm-draggable__handles.is-active {\n  padding: 0;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  position: absolute;\n  z-index: 2;\n  border: 1px dotted #5495F6;\n}\n.vm-draggable__handles.is-active .vm-draggable__handle {\n  display: block;\n}\n.vm-draggable__handles.is-disabled {\n  border: 1px dotted #e96101;\n}\n.vm-draggable__handles.is-disabled .handle-rotate:after {\n  background: #e96101;\n}\n.vm-draggable__handles.is-disabled .handle-rotate:before {\n  color: #e96101;\n}\n.vm-draggable__handle {\n  display: none;\n  position: absolute;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  z-index: 999;\n}\n.vm-draggable__handle.is-left {\n  top: 0;\n  left: -5px;\n  cursor: ew-resize;\n  position: absolute;\n  height: 100%;\n  width: 5px;\n}\n.vm-draggable__handle.is-left:hover {\n  background: -webkit-gradient(linear, left top, right top, from(rgba(255, 255, 255, 0)), to(#3F51B5));\n  background: linear-gradient(to right, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-right {\n  top: 0;\n  right: -5px;\n  cursor: ew-resize;\n  position: absolute;\n  height: 100%;\n  width: 5px;\n}\n.vm-draggable__handle.is-right:hover {\n  background: -webkit-gradient(linear, right top, left top, from(rgba(255, 255, 255, 0)), to(#3F51B5));\n  background: linear-gradient(to left, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-top {\n  position: absolute;\n  width: 100%;\n  height: 5px;\n  top: -5px;\n  left: 0;\n  cursor: ns-resize;\n}\n.vm-draggable__handle.is-top:hover {\n  background: -webkit-gradient(linear, left top, left bottom, from(rgba(255, 255, 255, 0)), to(#3F51B5));\n  background: linear-gradient(to bottom, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-bottom {\n  position: absolute;\n  width: 100%;\n  height: 5px;\n  bottom: -5px;\n  left: 0;\n  cursor: ns-resize;\n}\n.vm-draggable__handle.is-bottom:hover {\n  background: -webkit-gradient(linear, left bottom, left top, from(rgba(255, 255, 255, 0)), to(#3F51B5));\n  background: linear-gradient(to top, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-top-left {\n  top: 0;\n  left: 0;\n  cursor: nwse-resize;\n  padding: 5px;\n}\n.vm-draggable__handle .is-bottom-left {\n  bottom: 0;\n  left: 0;\n  cursor: nesw-resize;\n  padding: 5px;\n}\n.vm-draggable__handle.is-top-right {\n  top: 0;\n  right: 0;\n  cursor: nesw-resize;\n  padding: 5px;\n}\n.vm-draggable__handle.is-bottom-right {\n  bottom: 0;\n  right: 0;\n  cursor: nwse-resize;\n  padding: 5px;\n}\n.vm-draggable__handle.is-rotate {\n  top: 0;\n  left: 50%;\n  -webkit-transform: translate(-50%, -100%);\n      -ms-transform: translate(-50%, -100%);\n          transform: translate(-50%, -100%);\n  cursor: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" style="font-size: 20px;"><text y="15">↻</text></svg>\') 10 10, default;\n  display: -webkit-box !important;\n  display: -webkit-flex !important;\n  display: -ms-flexbox !important;\n  display: flex !important;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.vm-draggable__handle.is-rotate:after {\n  content: " ";\n  height: 10px;\n  width: 1px;\n  background: #5495F6;\n}\n.vm-draggable__handle.is-rotate:before {\n  content: "☐";\n  -webkit-transform: translateY(26%);\n      -ms-transform: translateY(26%);\n          transform: translateY(26%);\n  color: #5495F6;\n}\n\n/**\n * rotate\n */\n.vm-draggable__rotate {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  z-index: 2;\n  width: 500px;\n  border: 1px solid #1fb6ff;\n  background-color: #1fb6ff;\n  -webkit-transform: translate(-50%, -50%) rotate(90deg);\n      -ms-transform: translate(-50%, -50%) rotate(90deg);\n          transform: translate(-50%, -50%) rotate(90deg);\n}\n.vm-draggable__rotate--deg {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  z-index: 2;\n  width: 500px;\n  border-top: 1px dashed #fff;\n  border-bottom: 1px dashed #262626;\n  opacity: 0.4;\n}\n.vm-draggable__rotate--deg.is-0 {\n  -webkit-transform: translate(-50%, -50%);\n      -ms-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n}\n.vm-draggable__rotate--deg.is-45 {\n  -webkit-transform: translate(-50%, -50%) rotate(45deg);\n      -ms-transform: translate(-50%, -50%) rotate(45deg);\n          transform: translate(-50%, -50%) rotate(45deg);\n}\n.vm-draggable__rotate--deg.is-90 {\n  -webkit-transform: translate(-50%, -50%) rotate(90deg);\n      -ms-transform: translate(-50%, -50%) rotate(90deg);\n          transform: translate(-50%, -50%) rotate(90deg);\n}\n.vm-draggable__rotate--deg.is-135 {\n  -webkit-transform: translate(-50%, -50%) rotate(135deg);\n      -ms-transform: translate(-50%, -50%) rotate(135deg);\n          transform: translate(-50%, -50%) rotate(135deg);\n}\n.vm-draggable__rotate--tip {\n  position: absolute;\n  top: -50px;\n  left: 60%;\n  width: 40px;\n  height: 16px;\n  line-height: 16px;\n  text-align: center;\n  border: 1px solid #262626;\n  border-radius: 8px;\n  background-color: #fff;\n}\n.vm-draggable__delete {\n  background: #5495F6;\n  position: absolute;\n  right: 0px;\n  width: 20px;\n  color: white;\n  text-align: center;\n  z-index: 300;\n  top: 0;\n  right: 0px;\n  cursor: pointer;\n}\n\n/*# sourceMappingURL=draggable.vue.map */',map:{version:3,sources:["draggable.vue","/Users/deot/Desktop/wya/github/wya-vm/src/base/draggable.vue"],names:[],mappings:"AAAA,gBAAgB;ACgoBhB;EACA,UAAA;EACA,kBAAA;EACA,8BAAA;UAAA,sBAAA;EACA,yBAAA;KAAA,sBAAA;MAAA,qBAAA;UAAA,iBAAA;AD9nBA;AC+nBA;EACA,YAAA;AD7nBA;AC+nBA;EACA,oBAAA;AD7nBA;ACgoBA;EACA,mBAAA;EACA,kBAAA;EACA,QAAA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;EACA,YAAA;AD9nBA;ACkoBA;EACA,eAAA;AD/nBA;ACmoBA;EACA,UAAA;EACA,MAAA;EACA,OAAA;EACA,QAAA;EACA,SAAA;EACA,kBAAA;EACA,UAAA;EACA,0BAAA;ADhoBA;ACkoBA;EACA,cAAA;ADhoBA;ACmoBA;EACA,0BAAA;ADjoBA;ACmoBA;EACA,mBAAA;ADjoBA;ACmoBA;EACA,cAAA;ADjoBA;ACsoBA;EACA,aAAA;EACA,kBAAA;EACA,8BAAA;UAAA,sBAAA;EACA,YAAA;ADnoBA;ACooBA;EACA,MAAA;EACA,UAAA;EACA,iBAAA;EACA,kBAAA;EACA,YAAA;EACA,UAAA;ADloBA;ACmoBA;EACA,oGAAA;EAAA,sEAAA;ADjoBA;ACooBA;EACA,MAAA;EACA,WAAA;EACA,iBAAA;EACA,kBAAA;EACA,YAAA;EACA,UAAA;ADloBA;ACmoBA;EACA,oGAAA;EAAA,qEAAA;ADjoBA;ACqoBA;EACA,kBAAA;EACA,WAAA;EACA,WAAA;EACA,SAAA;EACA,OAAA;EACA,iBAAA;ADnoBA;ACooBA;EACA,sGAAA;EAAA,uEAAA;ADloBA;ACqoBA;EACA,kBAAA;EACA,WAAA;EACA,WAAA;EACA,YAAA;EACA,OAAA;EACA,iBAAA;ADnoBA;ACooBA;EACA,sGAAA;EAAA,oEAAA;ADloBA;ACqoBA;EACA,MAAA;EACA,OAAA;EACA,mBAAA;EACA,YAAA;ADnoBA;ACqoBA;EACA,SAAA;EACA,OAAA;EACA,mBAAA;EACA,YAAA;ADnoBA;ACqoBA;EACA,MAAA;EACA,QAAA;EACA,mBAAA;EACA,YAAA;ADnoBA;ACqoBA;EACA,SAAA;EACA,QAAA;EACA,mBAAA;EACA,YAAA;ADnoBA;ACqoBA;EACA,MAAA;EACA,SAAA;EACA,yCAAA;MAAA,qCAAA;UAAA,iCAAA;EACA,yKAAA;EACA,+BAAA;EAAA,gCAAA;EAAA,+BAAA;EAAA,wBAAA;EACA,4BAAA;EAAA,6BAAA;EAAA,8BAAA;MAAA,0BAAA;UAAA,sBAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,wBAAA;EAAA,+BAAA;MAAA,qBAAA;UAAA,uBAAA;ADnoBA;ACooBA;EACA,YAAA;EACA,YAAA;EACA,UAAA;EACA,mBAAA;ADloBA;ACooBA;EACA,YAAA;EACA,kCAAA;MAAA,8BAAA;UAAA,0BAAA;EACA,cAAA;ADloBA;;ACuoBA;;EAAA;AAGA;EACA,kBAAA;EACA,SAAA;EACA,QAAA;EACA,UAAA;EACA,YAAA;EACA,yBAAA;EACA,yBAAA;EACA,sDAAA;MAAA,kDAAA;UAAA,8CAAA;ADpoBA;ACsoBA;EACA,kBAAA;EACA,QAAA;EACA,SAAA;EACA,UAAA;EACA,YAAA;EACA,2BAAA;EACA,iCAAA;EACA,YAAA;ADnoBA;ACooBA;EACA,wCAAA;MAAA,oCAAA;UAAA,gCAAA;ADloBA;ACooBA;EACA,sDAAA;MAAA,kDAAA;UAAA,8CAAA;ADloBA;ACooBA;EACA,sDAAA;MAAA,kDAAA;UAAA,8CAAA;ADloBA;ACooBA;EACA,uDAAA;MAAA,mDAAA;UAAA,+CAAA;ADloBA;ACsoBA;EACA,kBAAA;EACA,UAAA;EACA,SAAA;EACA,WAAA;EACA,YAAA;EACA,iBAAA;EACA,kBAAA;EACA,yBAAA;EACA,kBAAA;EACA,sBAAA;ADnoBA;ACsoBA;EACA,mBAAA;EACA,kBAAA;EACA,UAAA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;EACA,YAAA;EACA,MAAA;EACA,UAAA;EACA,eAAA;ADnoBA;;AAEA,wCAAwC",file:"draggable.vue",sourcesContent:['@charset "UTF-8";\n.vm-draggable {\n  padding: 0;\n  position: absolute;\n  box-sizing: border-box;\n  user-select: none;\n}\n.vm-draggable:hover {\n  cursor: move;\n}\n.vm-draggable .is-events-none {\n  pointer-events: none;\n}\n.vm-draggable .is-delete {\n  background: #5495F6;\n  position: absolute;\n  right: 0;\n  width: 20px;\n  color: white;\n  text-align: center;\n  z-index: 300;\n}\n\n.vm-draggable-disabled:hover {\n  cursor: default;\n}\n\n.vm-draggable__handles.is-active {\n  padding: 0;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  position: absolute;\n  z-index: 2;\n  border: 1px dotted #5495F6;\n}\n.vm-draggable__handles.is-active .vm-draggable__handle {\n  display: block;\n}\n.vm-draggable__handles.is-disabled {\n  border: 1px dotted #e96101;\n}\n.vm-draggable__handles.is-disabled .handle-rotate:after {\n  background: #e96101;\n}\n.vm-draggable__handles.is-disabled .handle-rotate:before {\n  color: #e96101;\n}\n\n.vm-draggable__handle {\n  display: none;\n  position: absolute;\n  box-sizing: border-box;\n  z-index: 999;\n}\n.vm-draggable__handle.is-left {\n  top: 0;\n  left: -5px;\n  cursor: ew-resize;\n  position: absolute;\n  height: 100%;\n  width: 5px;\n}\n.vm-draggable__handle.is-left:hover {\n  background: linear-gradient(to right, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-right {\n  top: 0;\n  right: -5px;\n  cursor: ew-resize;\n  position: absolute;\n  height: 100%;\n  width: 5px;\n}\n.vm-draggable__handle.is-right:hover {\n  background: linear-gradient(to left, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-top {\n  position: absolute;\n  width: 100%;\n  height: 5px;\n  top: -5px;\n  left: 0;\n  cursor: ns-resize;\n}\n.vm-draggable__handle.is-top:hover {\n  background: linear-gradient(to bottom, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-bottom {\n  position: absolute;\n  width: 100%;\n  height: 5px;\n  bottom: -5px;\n  left: 0;\n  cursor: ns-resize;\n}\n.vm-draggable__handle.is-bottom:hover {\n  background: linear-gradient(to top, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-top-left {\n  top: 0;\n  left: 0;\n  cursor: nwse-resize;\n  padding: 5px;\n}\n.vm-draggable__handle .is-bottom-left {\n  bottom: 0;\n  left: 0;\n  cursor: nesw-resize;\n  padding: 5px;\n}\n.vm-draggable__handle.is-top-right {\n  top: 0;\n  right: 0;\n  cursor: nesw-resize;\n  padding: 5px;\n}\n.vm-draggable__handle.is-bottom-right {\n  bottom: 0;\n  right: 0;\n  cursor: nwse-resize;\n  padding: 5px;\n}\n.vm-draggable__handle.is-rotate {\n  top: 0;\n  left: 50%;\n  transform: translate(-50%, -100%);\n  cursor: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" style="font-size: 20px;"><text y="15">↻</text></svg>\') 10 10, default;\n  display: flex !important;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n.vm-draggable__handle.is-rotate:after {\n  content: " ";\n  height: 10px;\n  width: 1px;\n  background: #5495F6;\n}\n.vm-draggable__handle.is-rotate:before {\n  content: "☐";\n  transform: translateY(26%);\n  color: #5495F6;\n}\n\n/**\n * rotate\n */\n.vm-draggable__rotate {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  z-index: 2;\n  width: 500px;\n  border: 1px solid #1fb6ff;\n  background-color: #1fb6ff;\n  transform: translate(-50%, -50%) rotate(90deg);\n}\n\n.vm-draggable__rotate--deg {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  z-index: 2;\n  width: 500px;\n  border-top: 1px dashed #fff;\n  border-bottom: 1px dashed #262626;\n  opacity: 0.4;\n}\n.vm-draggable__rotate--deg.is-0 {\n  transform: translate(-50%, -50%);\n}\n.vm-draggable__rotate--deg.is-45 {\n  transform: translate(-50%, -50%) rotate(45deg);\n}\n.vm-draggable__rotate--deg.is-90 {\n  transform: translate(-50%, -50%) rotate(90deg);\n}\n.vm-draggable__rotate--deg.is-135 {\n  transform: translate(-50%, -50%) rotate(135deg);\n}\n\n.vm-draggable__rotate--tip {\n  position: absolute;\n  top: -50px;\n  left: 60%;\n  width: 40px;\n  height: 16px;\n  line-height: 16px;\n  text-align: center;\n  border: 1px solid #262626;\n  border-radius: 8px;\n  background-color: #fff;\n}\n\n.vm-draggable__delete {\n  background: #5495F6;\n  position: absolute;\n  right: 0px;\n  width: 20px;\n  color: white;\n  text-align: center;\n  z-index: 300;\n  top: 0;\n  right: 0px;\n  cursor: pointer;\n}\n\n/*# sourceMappingURL=draggable.vue.map */',"<template>\n\t<div\n\t\t:style=\"coord\"\n\t\t:class=\"!draggable ? 'vm-draggable-disabled' : ''\"\n\t\tclass=\"vm-draggable\"\n\t\t@mousedown=\"handleContainerDown\"\n\t\t@touchstart.stop=\"handleContainerDown\"\n\t>\n\t\t<div :style=\"style\" :class=\"{ 'is-events-none': isChanging }\" >\n\t\t\t<slot :style=\"style\"/>\n\t\t</div>\n\t\t\x3c!-- handle --\x3e\n\t\t<div\n\t\t\tv-if=\"(active || isActive) && (closeable || realHandles.length > 0)\"\n\t\t\t:class=\"{ 'is-disabled': disabled, 'is-active': (active || isActive) }\"\n\t\t\t:style=\"style\"\n\t\t\tclass=\"vm-draggable__handles\"\n\t\t>\n\t\t\t<template v-for=\"item in realHandles\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"!disabled\"\n\t\t\t\t\t:key=\"item\"\n\t\t\t\t\t:class=\"`is-${item}`\"\n\t\t\t\t\tclass=\"vm-draggable__handle\"\n\t\t\t\t\t@mousedown.left.stop=\"handleDown($event, item)\"\n\t\t\t\t\t@touchstart.stop=\"handleDown($event, item)\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<div v-if=\"rotatable && isRotating\" :style=\"{ width }\" class=\"vm-draggable__rotate\"/>\n\t\t\t\x3c!-- delete --\x3e\n\t\t\t<p v-if=\"closeable\" class=\"vm-draggable__delete\" @click=\"$emit('delete')\">✕</p>\n\t\t</div>\n\n\t\t\x3c!-- 位置不会改变的 --\x3e\n\t\t\x3c!-- grid for rotate --\x3e\n\t\t<template v-if=\"isRotating\">\n\t\t\t<div :style=\"{ width }\" class=\"vm-draggable__rotate--deg is-0\" />\n\t\t\t<div :style=\"{ width }\" class=\"vm-draggable__rotate--deg is-45\" />\n\t\t\t<div :style=\"{ width }\" class=\"vm-draggable__rotate--deg is-90\" />\n\t\t\t<div :style=\"{ width }\" class=\"vm-draggable__rotate--deg is-135\" />\n\t\t\t<div class=\"vm-draggable__rotate--tip\">{{ r }} °</div>\n\t\t</template>\n\t</div>\n</template>\n\n<script>\nimport { isPassiveSupported, eleInRegExp } from '../utils/helper';\n\nconst doc = document.documentElement;\nconst angleArr = [0, 45, 90, 135, 180, 225, 270, 315, 360];\n\nexport const draggableEvents = {\n\tstart: ['touchstart', 'mousedown'],\n\tmove: ['touchmove', 'mousemove'],\n\tend: ['touchend', 'touchcancel', 'mouseup']\n};\n\nexport default {\n\treplace: true,\n\tname: 'vm-draggable',\n\tprops: {\n\t\thandles: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => (['top', 'right', 'bottom', 'left', 'top-left', 'top-right', 'bottom-right', 'bottom-left', 'rotate'])\n\t\t},\n\t\t// 宽度\n\t\tw: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t\tvalidator: val => val >= 0\n\t\t},\n\t\t// 高度\n\t\th: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t\tvalidator: val => val >= 0\n\t\t},\n\t\t// 选择角度\n\t\tr: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\t// 最小宽度\n\t\tminW: {\n\t\t\ttype: Number,\n\t\t\tdefault: 36,\n\t\t\tvalidator: val => val > 0\n\t\t},\n\t\t// 最小高度\n\t\tminH: {\n\t\t\ttype: Number,\n\t\t\tdefault: 36,\n\t\t\tvalidator: val => val > 0\n\t\t},\n\t\t// 距父元素左上角X轴偏移量\n\t\tx: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\t// 距父元素左上角Y轴偏移量\n\t\ty: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\t// zIndex\n\t\tz: {\n\t\t\ttype: Number,\n\t\t\tdefault: 1\n\t\t},\n\t\tscale: {\n\t\t\ttype: Number,\n\t\t\tdefault: 1\n\t\t},\n\t\tgrid: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => {\n\t\t\t\treturn [1, 1];\n\t\t\t}\n\t\t},\n\n\t\tguides: {\n\t\t\ttype: Array,\n\t\t\tdefault() {\n\t\t\t\treturn [[], []];\n\t\t\t}\n\t\t},\n\n\t\t// 约束组件大小\n\t\trestrain: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\tparent: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\n\t\t// 在入口文件下，才会去判断editorRegExp，如弹层不会判断让其失去激活状态（除非配置）\n\t\tentryRegExp: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => ({\n\t\t\t\tclassName: /vm-hack-entry/,\n\t\t\t\tid: /^(app|pages)$/\n\t\t\t})\n\t\t},\n\n\t\teditorRegExp: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => ({\n\t\t\t\tclassName: /vm-hack-editor/\n\t\t\t})\n\t\t},\n\n\t\t/**\n\t\t * 是否屏蔽默认事件\n\t\t */\n\t\tprevent: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tpreventRegExp: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => ({\n\t\t\t\ttagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|OPTION)$/,\n\t\t\t\tclassName: /vm-hack-pevent/,\n\t\t\t})\n\t\t},\n\n\t\tmodule: {\n\t\t\ttype: String,\n\t\t},\n\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\n\t\tcloseable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\n\t\tdraggable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\n\t\tresizable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\n\t\trotatable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\n\t\t// 激活状态， 特殊需求\n\t\tactive: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\n\t\toffset: {\n\t\t\ttype: Array,\n\t\t\tdefault() {\n\t\t\t\treturn [0, 0];\n\t\t\t}\n\t\t},\n\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tisResizing: false,\n\t\t\tisDraging: false,\n\t\t\tisRotating: false,\n\t\t\tisChanging: false,\n\t\t\tisActive: false\n\t\t};\n\t},\n\tcomputed: {\n\t\tcoord() {\n\t\t\treturn {\n\t\t\t\tleft: this.x + 'px',\n\t\t\t\ttop: this.y + 'px',\n\t\t\t\tzIndex: this.isActive && this.module !== 'page' ? 999 : this.z\n\t\t\t};\n\t\t},\n\t\tstyle() {\n\t\t\tconst w = this.w === 0 ? 'auto' : `${this.w}px`;\n\t\t\tconst h = this.h === 0 ? 'auto' : `${this.h}px`;\n\t\t\treturn {\n\t\t\t\twidth: w,\n\t\t\t\theight: h,\n\t\t\t\ttransform: `rotate(${this.r}deg)`\n\t\t\t};\n\t\t},\n\t\twidth() {\n\t\t\tlet num = Math.floor(\n\t\t\t\tMath.sqrt(this.w * this.w + this.h * this.h) * 1.15\n\t\t\t);\n\t\t\treturn `${num}px`;\n\t\t},\n\t\trealHandles() {\n\t\t\tlet handles = this.handles;\n\n\t\t\tif (!this.rotatable) {\n\t\t\t\thandles = handles.filter(i => i !== 'rotate');\n\t\t\t}\n\n\t\t\tif (!this.resizable) {\n\t\t\t\thandles = handles.filter(i => i === 'rotate');\n\t\t\t}\n\n\t\t\treturn handles;\n\t\t}\n\t},\n\twatch: {},\n\tbeforeCreate() {\n\t\tthis.parentX = 0;\n\t\tthis.parentY = 0;\n\t\tthis.parentW = 9999;\n\t\tthis.parentH = 9999;\n\t\tthis.mouseX = 0;\n\t\tthis.mouseY = 0;\n\t\tthis.lastMouseX = 0;\n\t\tthis.lastMouseY = 0;\n\t\tthis.mouseOffX = 0;\n\t\tthis.mouseOffY = 0;\n\n\t\tthis.handle = null;\n\n\t\t// 组件捕获阶段执行\n\t\tthis.eventOpts = !isPassiveSupported || { capture: true, passive: true };\n\n\t\t// 改变前状态\n\t\tthis.beforeStatus = null;\n\t},\n\tmounted() {\n\t\t// 初始化控件宽高, todo: 宽高未零时，是否需要计算\n\t\tif (this.w && this.minW > this.w) {\n\t\t\tthis.sync({ w: this.minW });\n\t\t}\n\t\tif (this.h && this.minH > this.h) {\n\t\t\tthis.sync({ h: this.minH });\n\t\t}\n\n\t\tthis.$nextTick(() => {\n\t\t\tconst { x, y } = this.$el.parentNode.getBoundingClientRect();\n\t\t\tthis.parentX = x + this.offset[0];\n\t\t\tthis.parentY = y + this.offset[1];\n\n\t\t\t// 判断是否只能在父级元素中拖动\n\t\t\tthis.parent && this.calculation();\n\t\t\tthis.$emit('resizing');\n\t\t});\n\t},\n\tdestroyed() {\n\t\tthis.operateDOMEvents('remove');\n\t},\n\tmethods: {\n\t\tcalculation() {\n\t\t\tconst { width, height } = this.$el.parentNode.getBoundingClientRect();\n\t\t\tif (!width || !height) {\n\t\t\t\tthrow new Error('@wya/vm: 父层容器宽度计算异常');\n\t\t\t}\n\n\t\t\t// 原始高度\n\t\t\tthis.parentW = width / this.scale;\n\t\t\tthis.parentH = height / this.scale; // this.$el.parentNode.clientHeight\n\n\t\t\tif (this.w > this.parentW) {\n\t\t\t\tthis.sync({ w: this.parentW });\n\t\t\t}\n\t\t\tif (this.h > this.parentH) {\n\t\t\t\tthis.sync({ h: this.parentH });\n\t\t\t}\n\t\t\tif ((this.x + this.w) > this.parentW) {\n\t\t\t\tthis.sync({ x: this.parentW - this.w });\n\t\t\t}\n\t\t\tif ((this.y + this.h) > this.parentH) {\n\t\t\t\tthis.sync({ y: this.parentH - this.h });\n\t\t\t}\n\t\t},\n\t\tsync(opts) {\n\t\t\tfor (let key in opts) {\n\t\t\t\tif (this[key] != opts[key]) {\n\t\t\t\t\t!this.beforeStatus && (this.beforeStatus = {\n\t\t\t\t\t\tx: this.x,\n\t\t\t\t\t\ty: this.y,\n\t\t\t\t\t\tz: this.z,\n\t\t\t\t\t\tw: this.w,\n\t\t\t\t\t\tr: this.r\n\t\t\t\t\t});\n\t\t\t\t\tthis.$emit(`update:${key}`, opts[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\toperateDOMEvents(type) {\n\t\t\tlet fn = type === 'add' ? doc.addEventListener : doc.removeEventListener;\n\n\t\t\t// 使用原生绑定 不区分移动端还是桌面端\n\t\t\tdraggableEvents.start.forEach(eventName => {\n\t\t\t\tfn(eventName, this.handleDeselect, this.eventOpts);\n\t\t\t});\n\t\t\tdraggableEvents.move.forEach(eventName => {\n\t\t\t\tfn(eventName, this.handleMove, this.eventOpts);\n\t\t\t});\n\t\t\tdraggableEvents.end.forEach(eventName => {\n\t\t\t\tfn(eventName, this.handleUp, this.eventOpts);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * 模拟设置isActive状态\n\t\t */\n\t\tsetActived() {\n\t\t\tthis.handleContainerDown();\n\t\t\tthis.handleUp();\n\t\t},\n\t\t/**\n\t\t * 组件被按下事件\n\t\t */\n\t\thandleContainerDown(e = {}) {\n\t\t\tthis.prevent\n\t\t\t\t&& e.preventDefault\n\t\t\t\t&& !eleInRegExp(e.target, this.preventRegExp)\n\t\t\t\t&& e.preventDefault();\n\n\t\t\t// 判断是否支持拖动\n\t\t\tif (this.disabled) return;\n\t\t\tconst target = e.target || e.srcElement;\n\t\t\t// 确保事件发生在组件内部\n\t\t\tif (!target || this.$el.contains(target)) {\n\t\t\t\tif (!this.isActive) {\n\t\t\t\t\tconst { mousePositionX, mousePositionY } = this.getPositionByEvent(e);\n\n\t\t\t\t\tthis.lastMouseX = mousePositionX + doc.scrollLeft;\n\t\t\t\t\tthis.lastMouseY = mousePositionY + doc.scrollTop;\n\n\t\t\t\t\t// 绑定事件\n\t\t\t\t\tthis.operateDOMEvents('add');\n\n\t\t\t\t\tthis.isActive = true;\n\t\t\t\t\tthis.$emit('activated');\n\t\t\t\t}\n\t\t\t\tthis.draggable && (this.isDraging = true);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 取消选择事件\n\t\t */\n\t\thandleDeselect(e) {\n\t\t\tconst { mousePositionX, mousePositionY } = this.getPositionByEvent(e);\n\n\t\t\tthis.mouseX = mousePositionX + doc.scrollLeft;\n\t\t\tthis.mouseY = mousePositionY + doc.scrollTop;\n\t\t\tthis.lastMouseX = this.mouseX;\n\t\t\tthis.lastMouseY = this.mouseY;\n\t\t\tconst target = e.target || e.srcElement; // body不要带上class, 否则会存在问题\n\n\t\t\t// 内部管理\n\t\t\tconst regex = {\n\t\t\t\tclassName: /is-([(top|right|-|bottom|left)]{2})/\n\t\t\t};\n\n\t\t\tlet path = e.path || (e.composedPath && e.composedPath()) || [];\n\n\t\t\t// 是否是入口下的元素，如果不是，就意味着可能是弹层（避免销毁）\n\t\t\tlet isInline = path.some(item => eleInRegExp(item, this.entryRegExp));\n\n\t\t\tif (\n\t\t\t\tisInline\n\t\t\t\t&& !this.$el.contains(target)\n\t\t\t\t&& !eleInRegExp(target, regex)\n\t\t\t\t&& (!path.some(item => eleInRegExp(item, this.editorRegExp)))\n\t\t\t) {\n\t\t\t\tif (this.isActive) {\n\t\t\t\t\t// 解绑\n\t\t\t\t\tthis.operateDOMEvents('remove');\n\n\t\t\t\t\tthis.isActive = false;\n\t\t\t\t\tthis.$emit('deactivated', e);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 拖动点按下事件\n\t\t */\n\t\thandleDown(e, handle) {\n\t\t\tthis.prevent\n\t\t\t\t&& e.preventDefault\n\t\t\t\t&& !eleInRegExp(e.target, this.preventRegExp)\n\t\t\t\t&& e.preventDefault();\n\n\t\t\t// 将handle设置为当前元素\n\t\t\tthis.handle = handle;\n\t\t\tif (handle === 'rotate') {\n\t\t\t\tthis.rotatable && (this.isRotating = true);\n\t\t\t} else {\n\t\t\t\tthis.resizable && (this.isResizing = true);\n\t\t\t}\n\n\t\t\tconst { mousePositionX, mousePositionY } = this.getPositionByEvent(e);\n\n\t\t\t// this.preMouseX = mousePositionX + doc.scrollLeft;\n\t\t\t// this.preMouseY = mousePositionY + doc.scrollTop;\n\t\t},\n\t\thandleMove(e) {\n\t\t\tconst { mousePositionX, mousePositionY } = this.getPositionByEvent(e);\n\t\t\tthis.mouseX = mousePositionX + doc.scrollLeft;\n\t\t\tthis.mouseY = mousePositionY + doc.scrollTop;\n\n\t\t\t// x, y, w, h\n\t\t\tlet elmX = parseInt(this.x, 10);\n\t\t\tlet elmY = parseInt(this.y, 10);\n\t\t\tlet elmW = parseInt(this.w, 10);\n\t\t\tlet elmH = parseInt(this.h, 10);\n\n\t\t\t// 鼠标所在的轴xy坐标值\n\t\t\tlet axisX = Math.round((this.mouseX - this.parentX + this.offset[0]) / this.scale);\n\t\t\tlet axisY = Math.round((this.mouseY - this.parentY + this.offset[1]) / this.scale);\n\t\t\tlet diffX = axisX - Math.round((this.lastMouseX - this.parentX + this.offset[0]) / this.scale);\n\t\t\tlet diffY = axisY - Math.round((this.lastMouseY - this.parentY + this.offset[1]) / this.scale);\n\t\t\tthis.lastMouseX = this.mouseX;\n\t\t\tthis.lastMouseY = this.mouseY;\n\n\t\t\tif (this.isResizing) {\n\t\t\t\tif (this.handle.includes('top')) {\n\t\t\t\t\tif (elmY - axisY + elmH < this.minH) {\n\t\t\t\t\t\taxisY = elmY + elmH - this.minH;\n\t\t\t\t\t} else if (this.parent && axisY < 0) {\n\t\t\t\t\t\taxisY = 0;\n\t\t\t\t\t}\n\t\t\t\t\telmH = elmY + elmH - axisY;\n\t\t\t\t\telmY = axisY;\n\t\t\t\t}\n\t\t\t\tif (this.handle.includes('bottom')) {\n\t\t\t\t\tif (axisY - elmY < this.minH) {\n\t\t\t\t\t\taxisY = elmY + this.minH;\n\t\t\t\t\t} else if (this.parent && axisY > this.parentH) {\n\t\t\t\t\t\taxisY = Math.round(this.parentH);\n\t\t\t\t\t}\n\t\t\t\t\telmH = axisY - elmY;\n\t\t\t\t}\n\t\t\t\tif (this.handle.includes('left')) {\n\t\t\t\t\tif (elmX - axisX + elmW < this.minW) {\n\t\t\t\t\t\taxisX = elmX + elmW - this.minW;\n\t\t\t\t\t} else if (this.parent && axisX < 0) {\n\t\t\t\t\t\taxisX = 0;\n\t\t\t\t\t}\n\t\t\t\t\telmW = elmX + elmW - axisX;\n\t\t\t\t\telmX = axisX;\n\t\t\t\t}\n\t\t\t\tif (this.handle.includes('right')) {\n\t\t\t\t\tif (axisX - elmX < this.minW) {\n\t\t\t\t\t\taxisX = elmX + this.minW;\n\t\t\t\t\t} else if (this.parent && axisX > this.parentW) {\n\t\t\t\t\t\taxisX = Math.round(this.parentW);\n\t\t\t\t\t}\n\t\t\t\t\telmW = axisX - elmX;\n\t\t\t\t}\n\t\t\t\t!this.disabled && this.sync({\n\t\t\t\t\tx: (Math.round(elmX / this.grid[0]) * this.grid[0]),\n\t\t\t\t\ty: (Math.round(elmY / this.grid[1]) * this.grid[1]),\n\t\t\t\t\tw: (Math.round(elmW / this.grid[0]) * this.grid[0]),\n\t\t\t\t\th: (Math.round(elmH / this.grid[1]) * this.grid[1]),\n\t\t\t\t});\n\t\t\t\tthis.$emit('resizing');\n\t\t\t} else if (this.isRotating) {\n\t\t\t\tlet angle = this.getAngle(\n\t\t\t\t\t[\n\t\t\t\t\t\tthis.parentX + this.x * this.scale + this.w / 2 * this.scale, \n\t\t\t\t\t\t-(this.parentY + this.y * this.scale + this.h / 2 * this.scale)\n\t\t\t\t\t],\n\t\t\t\t\t[\n\t\t\t\t\t\tthis.lastMouseX + this.offset[0], \n\t\t\t\t\t\t-(this.lastMouseY + this.offset[1])\n\t\t\t\t\t]\n\t\t\t\t);\n\n\t\t\t\tlet criticalAngle = angleArr.find(item => Math.abs(item - angle) < 3);\n\t\t\t\tangle = typeof criticalAngle === 'number' ? criticalAngle : angle;\n\n\t\t\t\t!this.disabled && this.sync({\n\t\t\t\t\tr: angle === 360 ? 0 : angle\n\t\t\t\t});\n\t\t\t\tthis.$emit('rotating');\n\t\t\t} else if (this.isDraging) {\n\n\t\t\t\t// 找出可吸附的辅助线\n\t\t\t\tlet leftline = this.guides[0] && this.guides[0].find(item => {\n\t\t\t\t\treturn Math.abs(elmX + diffX - item) < 3;\n\t\t\t\t});\n\t\t\t\tlet rightline = this.guides[0] && this.guides[0].find(item => {\n\t\t\t\t\treturn Math.abs(elmX + diffX + elmW - item) < 2;\n\t\t\t\t});\n\t\t\t\tlet topline = this.guides[1] && this.guides[1].find(item => {\n\t\t\t\t\treturn Math.abs(elmY + diffY - item) < 3;\n\t\t\t\t});\n\t\t\t\tlet bottomline = this.guides[1] && this.guides[1].find(item => {\n\t\t\t\t\treturn Math.abs(elmY + diffY + elmH - item) < 2;\n\t\t\t\t});\n\n\t\t\t\tleftline && (diffX = leftline - elmX);\n\t\t\t\trightline && (diffX = rightline - elmX - elmW);\n\t\t\t\ttopline && (diffY = topline - elmY);\n\t\t\t\tbottomline && (diffY = bottomline - elmY - elmH);\n\n\t\t\t\tif (this.parent) {\n\t\t\t\t\tif (elmX + diffX < 0 || elmX + diffX + elmW > this.parentW) {\n\t\t\t\t\t\tdiffX = 0;\n\t\t\t\t\t}\n\t\t\t\t\tif (elmY + diffY < 0 || elmY + diffY + elmH > this.parentH) {\n\t\t\t\t\t\tdiffY = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telmX += diffX;\n\t\t\t\telmY += diffY;\n\n\t\t\t\t!this.disabled && this.sync({\n\t\t\t\t\tx: (Math.round(elmX / this.grid[0]) * this.grid[0]),\n\t\t\t\t\ty: (Math.round(elmY / this.grid[1]) * this.grid[1]),\n\t\t\t\t});\n\t\t\t\tthis.$emit('dragging');\n\t\t\t}\n\n\t\t\t// 正在改变\n\t\t\t!this.isChanging\n\t\t\t\t&& (this.isRotating || this.isDraging || this.isResizing)\n\t\t\t\t&& (this.isChanging = true);\n\n\t\t},\n\n\t\tgetAngle(center, last) {\n\t\t\tlet diffX = last[0] - center[0];\n\t\t\tlet diffY = last[1] - center[1];\n\t\t\t/**\n\t\t\t * https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Math/atan2\n\t\t\t * -180 <= c < 180\n\t\t\t */\n\t\t\tlet c = 360 * Math.atan2(diffY, diffX) / (2 * Math.PI);\n\t\t\tc = c > 90\n\t\t\t\t? (450 - c) // 第4\n\t\t\t\t: 90 - c; // 第1，2，3象限\n\t\t\treturn Math.floor(c);\n\t\t},\n\t\tgetRestrain(num) {\n\t\t\tconst restrain = this.restrain;\n\t\t\treturn (num / restrain).toFixed(0) * restrain;\n\t\t},\n\t\tgetPositionByEvent(e) {\n\t\t\tconst mousePositionX = e.targetTouches\n\t\t\t\t? e.targetTouches[0].pageX\n\t\t\t\t: e.clientX;\n\t\t\tconst mousePositionY = e.targetTouches\n\t\t\t\t? e.targetTouches[0].pageY\n\t\t\t\t: e.clientY;\n\t\t\treturn {\n\t\t\t\tmousePositionX: mousePositionX || 0,\n\t\t\t\tmousePositionY: mousePositionY || 0\n\t\t\t};\n\t\t},\n\t\thandleUp(e) {\n\t\t\tthis.isChanging = false;\n\t\t\tthis.handle = null;\n\t\t\t// 约束\n\t\t\tconst restrain = this.restrain;\n\t\t\tif (restrain && restrain > 0) {\n\t\t\t\tthis.sync({\n\t\t\t\t\tx: this.getRestrain(this.x),\n\t\t\t\t\ty: this.getRestrain(this.y),\n\t\t\t\t\tw: this.getRestrain(this.w),\n\t\t\t\t\th: this.getRestrain(this.h),\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (this.isRotating) {\n\t\t\t\tthis.isRotating = false;\n\t\t\t\tthis.$emit('rotate-end');\n\t\t\t}\n\t\t\tif (this.isResizing) {\n\t\t\t\tthis.isResizing = false;\n\t\t\t\tthis.$emit('resize-end');\n\t\t\t}\n\t\t\tif (this.isDraging) {\n\t\t\t\tthis.isDraging = false;\n\t\t\t\tthis.$emit('drag-end');\n\t\t\t}\n\t\t\tif (this.beforeStatus) {\n\t\t\t\tthis.$emit('end', this.beforeStatus);\n\t\t\t\tthis.beforeStatus = null;\n\t\t\t}\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang=\"scss\">\n\n$url: 'data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" style=\"font-size: 20px;\"><text y=\"15\">↻</text></svg>';\n\n.vm-draggable {\n\tpadding: 0;\n\tposition: absolute;\n\tbox-sizing: border-box;\n\tuser-select: none;\n\t&:hover {\n\t\tcursor: move;\n\t}\n\t.is-events-none {\n\t\tpointer-events: none;\n\t}\n\t// 重复？\n\t.is-delete {\n\t\tbackground: #5495F6;\n\t\tposition: absolute;\n\t\tright: 0;\n\t\twidth: 20px;\n\t\tcolor: white;\n\t\ttext-align: center;\n\t\tz-index: 300\n\t}\n}\n.vm-draggable-disabled {\n\t&:hover {\n\t\tcursor: default;\n\t}\n}\n.vm-draggable__handles {\n\t&.is-active {\n\t\tpadding: 0;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tposition: absolute;\n\t\tz-index: 2;\n\t\tborder: 1px dotted #5495F6;\n\t\t// cursor: move;\n\t\t.vm-draggable__handle {\n\t\t\tdisplay: block;\n\t\t}\n\t}\n\t&.is-disabled {\n\t\tborder: 1px dotted #e96101;\n\t\t.handle-rotate {\n\t\t\t&:after {\n\t\t\t\tbackground: #e96101;\n\t\t\t}\n\t\t\t&:before {\n\t\t\t\tcolor: #e96101;\n\t\t\t}\n\t\t}\n\t}\n}\n.vm-draggable__handle {\n\tdisplay: none;\n\tposition: absolute;\n\tbox-sizing: border-box;\n\tz-index: 999;\n\t&.is-left {\n\t\ttop: 0;\n\t\tleft: -5px;\n\t\tcursor: ew-resize;\n\t\tposition: absolute;\n\t\theight: 100%;\n\t\twidth: 5px;\n\t\t&:hover {\n\t\t\tbackground: linear-gradient(to right, rgba(255, 255, 255, 0), #3F51B5);\n\t\t}\n\t}\n\t&.is-right {\n\t\ttop: 0;\n\t\tright: -5px;\n\t\tcursor: ew-resize;\n\t\tposition: absolute;\n\t\theight: 100%;\n\t\twidth: 5px;\n\t\t&:hover {\n\t\t\tbackground: linear-gradient(to left, rgba(255, 255, 255, 0), #3F51B5);\n\t\t}\n\t}\n\n\t&.is-top {\n\t\tposition: absolute;\n\t\twidth: 100%;\n\t\theight: 5px;\n\t\ttop: -5px;\n\t\tleft: 0;\n\t\tcursor: ns-resize;\n\t\t&:hover {\n\t\t\tbackground: linear-gradient(to bottom, rgba(255, 255, 255, 0), #3F51B5);\n\t\t}\n\t}\n\t&.is-bottom {\n\t\tposition: absolute;\n\t\twidth: 100%;\n\t\theight: 5px;\n\t\tbottom: -5px;\n\t\tleft: 0;\n\t\tcursor: ns-resize;\n\t\t&:hover {\n\t\t\tbackground: linear-gradient(to top, rgba(255, 255, 255, 0), #3F51B5);\n\t\t}\n\t}\n\t&.is-top-left {\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tcursor: nwse-resize;\n\t\tpadding: 5px;\n\t}\n\t.is-bottom-left {\n\t\tbottom: 0;\n\t\tleft: 0;\n\t\tcursor: nesw-resize;\n\t\tpadding: 5px;\n\t}\n\t&.is-top-right {\n\t\ttop: 0;\n\t\tright: 0;\n\t\tcursor: nesw-resize;\n\t\tpadding: 5px;\n\t}\n\t&.is-bottom-right {\n\t\tbottom: 0;\n\t\tright: 0;\n\t\tcursor: nwse-resize;\n\t\tpadding: 5px;\n\t}\n\t&.is-rotate {\n\t\ttop: 0;\n\t\tleft: 50%;\n\t\ttransform: translate(-50%, -100%);\n\t\tcursor: url($url) 10 10,default;\n\t\tdisplay: flex !important;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\t&:after {\n\t\t\tcontent: ' ';\n\t\t\theight: 10px;\n\t\t\twidth: 1px;\n\t\t\tbackground: #5495F6;\n\t\t}\n\t\t&:before {\n\t\t\tcontent: '☐';\n\t\t\ttransform: translateY(26%);\n\t\t\tcolor: #5495F6;\n\t\t}\n\t}\n}\n\n/**\n * rotate\n */\n.vm-draggable__rotate {\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 50%;\n\tz-index: 2;\n\twidth: 500px;\n\tborder: 1px solid #1fb6ff;\n\tbackground-color: #1fb6ff;\n\ttransform: translate(-50%, -50%) rotate(90deg);\n}\n.vm-draggable__rotate--deg {\n\tposition: absolute;\n\ttop: 50%;\n\tleft: 50%;\n\tz-index: 2;\n\twidth: 500px;\n\tborder-top: 1px dashed #fff;\n\tborder-bottom: 1px dashed #262626;\n\topacity: .4;\n\t&.is-0 {\n\t\ttransform: translate(-50%, -50%);\n\t}\n\t&.is-45 {\n\t\ttransform: translate(-50%, -50%) rotate(45deg);\n\t}\n\t&.is-90 {\n\t\ttransform: translate(-50%, -50%) rotate(90deg);\n\t}\n\t&.is-135 {\n\t\ttransform: translate(-50%, -50%) rotate(135deg);\n\t}\n}\n\n.vm-draggable__rotate--tip {\n\tposition: absolute;\n\ttop: -50px;\n\tleft: 60%;\n\twidth: 40px;\n\theight: 16px;\n\tline-height: 16px;\n\ttext-align: center;\n\tborder: 1px solid #262626;\n\tborder-radius: 8px;\n\tbackground-color: #fff;\n}\n\n.vm-draggable__delete {\n\tbackground: #5495F6;\n\tposition: absolute;\n\tright: 0px;\n\twidth: 20px;\n\tcolor: white;\n\ttext-align: center;\n\tz-index: 300;\n\ttop: 0;\n\tright: 0px;\n\tcursor: pointer;\n}\n\n</style>\n"]},media:void 0})}),X,void 0,!1,void 0,!1,R,void 0,void 0),j=document.documentElement,H=null,I={replace:!0,name:"vm-srot-list-item",props:{index:{type:Number|String,required:!0},type:{type:String,default:"@wya/vm"},disabled:L.props.disabled,editorRegExp:L.props.editorRegExp,entryRegExp:L.props.entryRegExp,prevent:L.props.prevent,preventRegExp:L.props.preventRegExp,closeable:L.props.closeable,draggable:{type:Boolean,default:!0},showHighlight:{type:Boolean,default:!0}},data:function(){return{isActive:!1,isHover:!1,highlight:!1}},computed:{},watch:{},beforeCreate:function(){this.eventOpts=!_||{capture:!0,passive:!0}},mounted:function(){},destroyed:function(){this.operateDOMEvents("remove")},methods:{operateDOMEvents:function(t){("add"===t?j.addEventListener:j.removeEventListener)("mousedown",this.handleDeselect,this.eventOpts)},setActived:function(){this.handleClick()},handleClick:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.prevent&&t.preventDefault&&!O(t.target,this.preventRegExp)&&t.preventDefault(),!this.disabled){var n=t.target||t.srcElement;n&&!this.$el.contains(n)||this.isActive||(this.operateDOMEvents("add"),this.isActive=!0,this.$emit("activated"))}},handleDeselect:function(t){var n=this,e=t.target||t.srcElement,r=t.path||t.composedPath&&t.composedPath()||[];!r.some((function(t){return O(t,n.entryRegExp)}))||this.$el.contains(e)||r.some((function(t){return O(t,n.editorRegExp)}))||this.isActive&&(this.operateDOMEvents("remove"),this.isActive=!1,this.$emit("deactivated"))},handleDragStart:function(t){t.dataTransfer.setData(this.type,this.index),t.dataTransfer.effectAllowed="move",(H=t.target).__START_INDEX__=this.index,H.__END_INDEX__=this.index,H.__DRAGGABLE__=this.draggable,t.target.style.opacity=0},handleDragEnter:function(t){var n=this;if(this.draggable&&H&&H.__DRAGGABLE__&&t.target!=H){if(this.index!=H.__END_INDEX__){if(this.timer)return;this.timer=setTimeout((function(){n.timer=null}),500),this.$emit("sorting",[H.__END_INDEX__,this.index]),H.__END_INDEX__=this.index}}else H||(this.highlight=!0,this.$emit("highlight-change",!0))},handleDragLeave:function(t){this.$refs.highlight!==t.fromElement&&(this.highlight=!1,this.$emit("highlight-change",!1))},handleDragEnd:function(t){t.dataTransfer.clearData(this.type),t.target.style.opacity=1,H&&this.$emit("sort-end",[H.__START_INDEX__,H.__END_INDEX__]),H=null}}},G=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-sortable",class:t.draggable?"":"vm-sortable-disabled",attrs:{draggable:t.draggable&&!t.disabled},on:{click:t.handleClick,dragstart:t.handleDragStart,dragenter:t.handleDragEnter,dragleave:t.handleDragLeave,dragover:function(t){t.preventDefault()},dragend:t.handleDragEnd,mouseenter:function(n){t.isHover=!0},mouseleave:function(n){t.isHover=!1}}},[e("div",{staticStyle:{"pointer-events":"none"}},[t._t("default")],2),t._v(" "),t.isActive||t.isHover?e("div",{staticClass:"vm-sortable__handle",class:{"is-disabled":t.disabled,"is-active":!0}}):t._e(),t._v(" "),t.closeable&&(t.isActive||t.isHover)?e("p",{staticClass:"vm-sortable__delete",on:{click:function(n){return t.$emit("delete")}}},[t._v("✕")]):t._e(),t._v(" "),t.showHighlight&&t.highlight?e("p",{ref:"highlight",staticClass:"vm-sortable__highlight"},[t._v("\n\t\t释放鼠标将模块添加到此处\n\t")]):t._e()])};G._withStripped=!0;var q=N({render:G,staticRenderFns:[]},(function(t){t&&t("data-v-2122c5cc_0",{source:".vm-sortable {\n  padding: 0;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  position: relative;\n  -webkit-transition: opacity 0.5s;\n  transition: opacity 0.5s;\n}\n.vm-sortable:hover {\n  cursor: move;\n}\n.vm-sortable .vm-sortable__handle.is-active {\n  padding: 0;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  position: absolute;\n  z-index: 2;\n  border: 1px dotted #5495F6;\n}\n.vm-sortable.is-disabled {\n  cursor: no-drop;\n}\n.vm-sortable-disabled:hover {\n  cursor: default;\n}\n.vm-sortable__delete {\n  background: #5495F6;\n  position: absolute;\n  right: 0px;\n  width: 20px;\n  color: white;\n  text-align: center;\n  z-index: 300;\n  top: 0;\n  right: 0px;\n  cursor: pointer;\n}\n.vm-sortable__highlight {\n  height: 55px;\n  background: #E7F4FF;\n  color: #5495F6;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  border: 1px dotted #5495F6;\n}\n\n/*# sourceMappingURL=sortable.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/base/sortable.vue","sortable.vue"],names:[],mappings:"AAqOA;EACA,UAAA;EACA,8BAAA;UAAA,sBAAA;EACA,yBAAA;KAAA,sBAAA;MAAA,qBAAA;UAAA,iBAAA;EACA,kBAAA;EACA,gCAAA;EAAA,wBAAA;ACpOA;ADqOA;EACA,YAAA;ACnOA;ADsOA;EACA,UAAA;EACA,MAAA;EACA,OAAA;EACA,QAAA;EACA,SAAA;EACA,kBAAA;EACA,UAAA;EACA,0BAAA;ACpOA;ADwOA;EACA,eAAA;ACtOA;AD0OA;EACA,eAAA;ACvOA;AD0OA;EACA,mBAAA;EACA,kBAAA;EACA,UAAA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;EACA,YAAA;EACA,MAAA;EACA,UAAA;EACA,eAAA;ACvOA;AD0OA;EACA,YAAA;EACA,mBAAA;EACA,cAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,wBAAA;EAAA,+BAAA;MAAA,qBAAA;UAAA,uBAAA;EACA,0BAAA;ACvOA;;AAEA,uCAAuC",file:"sortable.vue",sourcesContent:['<template>\n\t<div\n\t\t:draggable="draggable && !disabled"\n\t\t:class="!draggable ? \'vm-sortable-disabled\' : \'\'"\n\t\tclass="vm-sortable"\n\t\t@click="handleClick"\n\t\t@dragstart="handleDragStart"\n\t\t@dragenter="handleDragEnter"\n\t\t@dragleave="handleDragLeave"\n\t\t@dragover.prevent\n\t\t@dragend="handleDragEnd"\n\t\t@mouseenter="isHover = true"\n\t\t@mouseleave="isHover = false"\n\t>\n\t\t<div style="pointer-events: none;">\n\t\t\t<slot />\n\t\t</div>\n\t\t\x3c!-- handle --\x3e\n\t\t<div\n\t\t\tv-if="isActive || isHover"\n\t\t\t:class="{\n\t\t\t\t\'is-disabled\': disabled,\n\t\t\t\t\'is-active\': true\n\t\t\t}"\n\t\t\tclass="vm-sortable__handle"\n\t\t/>\n\t\t<p\n\t\t\tv-if="closeable && (isActive || isHover)"\n\t\t\tclass="vm-sortable__delete"\n\t\t\t@click="$emit(\'delete\')"\n\t\t>✕</p>\n\n\t\t<p\n\t\t\tv-if="showHighlight && highlight"\n\t\t\tref="highlight"\n\t\t\tclass="vm-sortable__highlight"\n\t\t>\n\t\t\t释放鼠标将模块添加到此处\n\t\t</p>\n\t</div>\n</template>\n\n<script>\nimport { isPassiveSupported, eleInRegExp } from \'../utils/helper\';\nimport Draggable from \'./draggable.vue\';\n\nconst doc = document.documentElement;\nlet eleDrag = null;\n\nexport default {\n\treplace: true,\n\tname: \'vm-srot-list-item\',\n\tprops: {\n\t\t// 当前排序数组的索引值，非order\n\t\tindex: {\n\t\t\ttype: Number | String,\n\t\t\trequired: true\n\t\t},\n\t\t// 用于getData/setData\n\t\ttype: {\n\t\t\ttype: String,\n\t\t\tdefault: \'@wya/vm\'\n\t\t},\n\t\tdisabled: Draggable.props.disabled,\n\t\teditorRegExp: Draggable.props.editorRegExp,\n\t\tentryRegExp: Draggable.props.entryRegExp,\n\t\tprevent: Draggable.props.prevent,\n\t\tpreventRegExp: Draggable.props.preventRegExp,\n\t\tcloseable: Draggable.props.closeable,\n\t\tdraggable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowHighlight: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tisActive: false,\n\t\t\tisHover: false,\n\t\t\thighlight: false\n\t\t};\n\t},\n\tcomputed: {\n\n\t},\n\twatch: {},\n\tbeforeCreate() {\n\t\t// 组件捕获阶段执行\n\t\tthis.eventOpts = !isPassiveSupported || { capture: true, passive: true };\n\t},\n\tmounted() {\n\n\t},\n\tdestroyed() {\n\t\tthis.operateDOMEvents(\'remove\');\n\t},\n\tmethods: {\n\t\toperateDOMEvents(type) {\n\t\t\tlet fn = type === \'add\' ? doc.addEventListener : doc.removeEventListener;\n\n\t\t\tfn(\'mousedown\', this.handleDeselect, this.eventOpts);\n\t\t},\n\t\t/**\n\t\t * 模拟设置Active状态\n\t\t */\n\t\tsetActived() {\n\t\t\tthis.handleClick();\n\t\t},\n\t\t/**\n\t\t * 组件被按下事件\n\t\t */\n\t\thandleClick(e = {}) {\n\t\t\t// 去除默认事件 todo: 匹配输入框\n\t\t\tthis.prevent\n\t\t\t\t&& e.preventDefault\n\t\t\t\t&& !eleInRegExp(e.target, this.preventRegExp)\n\t\t\t\t&& e.preventDefault();\n\n\t\t\t// 判断是否支持拖动\n\t\t\tif (this.disabled) return;\n\t\t\tconst target = e.target || e.srcElement;\n\t\t\t// 确保事件发生在组件内部\n\t\t\tif (!target || this.$el.contains(target)) {\n\t\t\t\tif (!this.isActive) {\n\t\t\t\t\t// 绑定事件\n\t\t\t\t\tthis.operateDOMEvents(\'add\');\n\n\t\t\t\t\tthis.isActive = true;\n\t\t\t\t\tthis.$emit(\'activated\');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 取消选择事件\n\t\t */\n\t\thandleDeselect(e) {\n\t\t\tconst target = e.target || e.srcElement; // body不要带上class, 否则会存在问题\n\n\t\t\tlet path = e.path || (e.composedPath && e.composedPath()) || [];\n\n\t\t\t// 是否是入口下的元素，如果不是，就意味着可能是弹层（避免销毁）\n\t\t\tlet isInline = path.some(item => eleInRegExp(item, this.entryRegExp));\n\n\t\t\tif (\n\t\t\t\tisInline\n\t\t\t\t&& !this.$el.contains(target)\n\t\t\t\t&& (!path.some(item => eleInRegExp(item, this.editorRegExp)))\n\t\t\t) {\n\t\t\t\tif (this.isActive) {\n\t\t\t\t\t// 解绑\n\t\t\t\t\tthis.operateDOMEvents(\'remove\');\n\n\t\t\t\t\tthis.isActive = false;\n\t\t\t\t\tthis.$emit(\'deactivated\');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t* 拖拽开始\n\t\t*/\n\t\thandleDragStart(e) {\n\t\t\t// 定义拖动数据 - 拖到别的输入框展示的内容\n\t\t\te.dataTransfer.setData(this.type, this.index);\n\n\t\t\t// 拖放效果\n\t\t\te.dataTransfer.effectAllowed = "move";\n\n\t\t\teleDrag = e.target;\n\n\t\t\teleDrag.__START_INDEX__ = this.index;\n\t\t\teleDrag.__END_INDEX__ = this.index;\n\t\t\teleDrag.__DRAGGABLE__ = this.draggable;\n\n\t\t\te.target.style.opacity = 0;\n\t\t},\n\n\t\t/**\n\t\t* 拖拽元素进入目标元素头上的时候\n\t\t*/\n\t\thandleDragEnter(e) {\n\t\t\tif (this.draggable && eleDrag && eleDrag.__DRAGGABLE__ && e.target != eleDrag) { // 排序\n\t\t\t\tif (this.index != eleDrag.__END_INDEX__) {\n\t\t\t\t\tif (this.timer) return;\n\t\t\t\t\tthis.timer = setTimeout(() => {\n\t\t\t\t\t\tthis.timer = null;\n\t\t\t\t\t}, 500);\n\n\t\t\t\t\tthis.$emit(\'sorting\', [eleDrag.__END_INDEX__, this.index]);\n\t\t\t\t\teleDrag.__END_INDEX__ = this.index;\n\t\t\t\t}\n\t\t\t} else if (!eleDrag) { // 处理高亮\n\t\t\t\tthis.highlight = true;\n\t\t\t\tthis.$emit(\'highlight-change\', true);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 拖拽离开\n\t\t */\n\t\thandleDragLeave(e) {\n\t\t\tif (this.$refs.highlight === e.fromElement) return;\n\n\t\t\tthis.highlight = false;\n\t\t\tthis.$emit(\'highlight-change\', false);\n\t\t},\n\n\t\t/**\n\t\t* 拖拽结束\n\t\t*/\n\t\thandleDragEnd(e) {\n\t\t\te.dataTransfer.clearData(this.type);\n\n\t\t\te.target.style.opacity = 1;\n\n\t\t\tif (eleDrag) {\n\t\t\t\tthis.$emit(\'sort-end\', [eleDrag.__START_INDEX__, eleDrag.__END_INDEX__]);\n\t\t\t}\n\n\t\t\teleDrag = null;\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\n.vm-sortable {\n\tpadding: 0;\n\tbox-sizing: border-box;\n\tuser-select: none;\n\tposition: relative;\n\ttransition: opacity .5s; // 目的是让拖拽的那个元素保持不透明， 文档流里透明\n\t&:hover {\n\t\tcursor: move;\n\t}\n\t.vm-sortable__handle {\n\t\t&.is-active {\n\t\t\tpadding: 0;\n\t\t\ttop: 0;\n\t\t\tleft: 0;\n\t\t\tright: 0;\n\t\t\tbottom: 0;\n\t\t\tposition: absolute;\n\t\t\tz-index: 2;\n\t\t\tborder: 1px dotted #5495F6;\n\t\t\t// cursor: move;\n\t\t}\n\t}\n\t&.is-disabled {\n\t\tcursor: no-drop;\n\t}\n}\n.vm-sortable-disabled {\n\t&:hover {\n\t\tcursor: default;\n\t}\n}\n.vm-sortable__delete {\n\tbackground: #5495F6;\n\tposition: absolute;\n\tright: 0px;\n\twidth: 20px;\n\tcolor: white;\n\ttext-align: center;\n\tz-index: 300;\n\ttop: 0;\n\tright: 0px;\n\tcursor: pointer;\n}\n\n.vm-sortable__highlight {\n\theight: 55px;\n\tbackground: #E7F4FF;\n\tcolor: #5495F6;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tborder: 1px dotted #5495F6;\n}\n\n</style>\n',".vm-sortable {\n  padding: 0;\n  box-sizing: border-box;\n  user-select: none;\n  position: relative;\n  transition: opacity 0.5s;\n}\n.vm-sortable:hover {\n  cursor: move;\n}\n.vm-sortable .vm-sortable__handle.is-active {\n  padding: 0;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  position: absolute;\n  z-index: 2;\n  border: 1px dotted #5495F6;\n}\n.vm-sortable.is-disabled {\n  cursor: no-drop;\n}\n\n.vm-sortable-disabled:hover {\n  cursor: default;\n}\n\n.vm-sortable__delete {\n  background: #5495F6;\n  position: absolute;\n  right: 0px;\n  width: 20px;\n  color: white;\n  text-align: center;\n  z-index: 300;\n  top: 0;\n  right: 0px;\n  cursor: pointer;\n}\n\n.vm-sortable__highlight {\n  height: 55px;\n  background: #E7F4FF;\n  color: #5495F6;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border: 1px dotted #5495F6;\n}\n\n/*# sourceMappingURL=sortable.vue.map */"]},media:void 0})}),I,void 0,!1,void 0,!1,R,void 0,void 0),K={TOP:"置顶",BOTTOM:"置底",UP:"上移一层",DOWN:"下移一层",DELETE:"删除"},V={name:"vm-widget",props:{draggable:{type:Boolean,default:!0},module:{type:String,required:!0},index:{type:Number}},computed:{style:function(){return this.draggable?{cursor:"move"}:{}}},methods:{handleStart:function(t){t.dataTransfer.setData("@wya/vm",JSON.stringify({module:this.module,index:this.index}))}}},J=function(){var t=this,n=t.$createElement;return(t._self._c||n)("div",{style:t.style,attrs:{draggable:t.draggable},on:{dragstart:function(n){t.draggable&&t.handleStart(n)}}},[t._t("default")],2)};J._withStripped=!0;var Z=N({render:J,staticRenderFns:[]},void 0,V,void 0,!1,void 0,!1,void 0,void 0,void 0),Q={name:"vm-tpl-viewer",components:{},props:{vm:{type:Object,default:function(){return{}}},id:String,x:Number,y:Number,z:Number,w:Number,h:Number,r:Number,name:[Number,String]},data:function(){return{}},computed:{},created:function(){},methods:{}},tt=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{style:[{height:t.h?t.h+"px":"auto",width:t.w?t.w+"px":"auto",color:"black"}]},[t._v("\n\tid: "+t._s(t.id)+" "),e("br"),t._v("\n\tX: "+t._s(t.x)+" "),e("br"),t._v("\n\tY: "+t._s(t.y)+" "),e("br"),t._v("\n\tZ: "+t._s(t.z)+" "),e("br"),t._v("\n\tWidth: "+t._s(t.w?t.w:"auto")+" "),e("br"),t._v("\n\tHeight: "+t._s(t.h?t.h:"auto")+" "),e("br"),t._v("\n\tRotate: "+t._s(t.r)+" "),e("br"),t._v("\n\tName: "+t._s(t.name)+" "),e("br")])};tt._withStripped=!0;var nt=N({render:tt,staticRenderFns:[]},(function(t){t&&t("data-v-f166bc66_0",{source:"\n\n/*# sourceMappingURL=viewer.vue.map */",map:{version:3,sources:["viewer.vue"],names:[],mappings:";;AAEA,qCAAqC",file:"viewer.vue"},media:void 0})}),Q,"data-v-f166bc66",!1,void 0,!1,R,void 0,void 0),et={name:"vm-tpl-editor",components:{},inheritAttrs:!1,props:{},data:function(){return{}},computed:{},created:function(){},methods:{handleChange:function(t,n){this.$emit("change",s({},n,t.target.value))},handleClick:function(){this.$emit("change",{x:this.x+1})}}},rt=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticStyle:{display:"flex","flex-direction":"column"}},[e("div",[t._v("w: "),e("input",{domProps:{value:t.$attrs.w},on:{input:function(n){return t.handleChange(n,"w")}}})]),t._v(" "),e("div",[t._v("h: "),e("input",{domProps:{value:t.$attrs.h},on:{input:function(n){return t.handleChange(n,"h")}}})]),t._v(" "),e("div",[t._v("x: "),e("input",{domProps:{value:t.$attrs.x},on:{input:function(n){return t.handleChange(n,"x")}}})]),t._v(" "),e("div",[t._v("y: "),e("input",{domProps:{value:t.$attrs.y},on:{input:function(n){return t.handleChange(n,"y")}}})]),t._v(" "),e("div",[t._v("z: "),e("input",{domProps:{value:t.$attrs.z},on:{input:function(n){return t.handleChange(n,"z")}}})]),t._v(" "),e("div",[t._v("r: "),e("input",{domProps:{value:t.$attrs.r},on:{input:function(n){return t.handleChange(n,"r")}}})]),t._v(" "),e("div",[t._v("name: "),e("input",{domProps:{value:t.$attrs.name},on:{input:function(n){return t.handleChange(n,"name")}}})])])};rt._withStripped=!0;var it={module:"tpl",type:"基础组件",name:"模版",Viewer:nt,Editor:N({render:rt,staticRenderFns:[]},(function(t){t&&t("data-v-2cf16f80_0",{source:"input {\n  border: 1px solid #000;\n  margin: 10px;\n}\n\n/*# sourceMappingURL=editor.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/modules/tpl/editor.vue","editor.vue"],names:[],mappings:"AAkDA;EACA,sBAAA;EACA,YAAA;ACjDA;;AAEA,qCAAqC",file:"editor.vue",sourcesContent:['<template>\n\t<div style="display: flex; flex-direction: column;">\n\t\t<div>w: <input :value="$attrs.w" @input="handleChange($event, \'w\')"></div>\n\t\t<div>h: <input :value="$attrs.h" @input="handleChange($event, \'h\')"></div>\n\t\t<div>x: <input :value="$attrs.x" @input="handleChange($event, \'x\')"></div>\n\t\t<div>y: <input :value="$attrs.y" @input="handleChange($event, \'y\')"></div>\n\t\t<div>z: <input :value="$attrs.z" @input="handleChange($event, \'z\')"></div>\n\t\t<div>r: <input :value="$attrs.r" @input="handleChange($event, \'r\')"></div>\n\t\t<div>name: <input :value="$attrs.name" @input="handleChange($event, \'name\')"></div>\n\t</div>\n</template>\n\n<script>\n\nexport default {\n\tname: \'vm-tpl-editor\',\n\tcomponents: {\n\t},\n\t// 以下两周都可行，相对的inheritAttrs比较好用的一点\n\tinheritAttrs: false,\n\tprops: {\n\t\t// w: Number,\n\t\t// h: Number,\n\t\t// r: Number,\n\t\t// x: Number,\n\t\t// y: Number,\n\t\t// z: Number,\n\t\t// name: [Number, String],\n\t},\n\tdata() {\n\t\treturn {\n\t\t};\n\t},\n\tcomputed: {\n\t},\n\tcreated() {\n\t},\n\tmethods: {\n\t\thandleChange(e, key) {\n\t\t\tthis.$emit(\'change\', { [key]: e.target.value });\n\t\t},\n\t\thandleClick() {\n\t\t\t// this.$emit(\'update:x\', this.x + 1);\n\t\t\tthis.$emit(\'change\', { x: this.x + 1 });\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\ninput {\n\tborder: 1px solid #000;\n\tmargin: 10px;\n}\n</style>\n',"input {\n  border: 1px solid #000;\n  margin: 10px;\n}\n\n/*# sourceMappingURL=editor.vue.map */"]},media:void 0})}),et,void 0,!1,void 0,!1,R,void 0,void 0),max:5,insertion:"",data:{w:200,h:150,r:0,x:0,y:0,z:1,parent:!1,closeable:!0,name:"名称"},dataValidity:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.name?null:{error:"输入框内容必填"}}},ot={name:"vm-tpl-viewer",components:{},props:{vm:{type:Object,default:function(){return{}}},id:String,x:Number,y:Number,z:Number,w:Number,h:Number,r:Number,name:[Number,String]},data:function(){return{}},computed:{},created:function(){},methods:{}},at=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{style:[{height:t.h?t.h+"px":"auto",width:t.w?t.w+"px":"auto",color:"black"}]},[t._v("\n\tid: "+t._s(t.id)+" "),e("br"),t._v("\n\tX: "+t._s(t.x)+" "),e("br"),t._v("\n\tY: "+t._s(t.y)+" "),e("br"),t._v("\n\tZ: "+t._s(t.z)+" "),e("br"),t._v("\n\tWidth: "+t._s(t.w?t.w:"auto")+" "),e("br"),t._v("\n\tHeight: "+t._s(t.h?t.h:"auto")+" "),e("br"),t._v("\n\tRotate: "+t._s(t.r)+" "),e("br"),t._v("\n\tName: "+t._s(t.name)+" "),e("br")])};at._withStripped=!0;var st=N({render:at,staticRenderFns:[]},(function(t){t&&t("data-v-a7673120_0",{source:"\n\n/*# sourceMappingURL=viewer.vue.map */",map:{version:3,sources:["viewer.vue"],names:[],mappings:";;AAEA,qCAAqC",file:"viewer.vue"},media:void 0})}),ot,void 0,!1,void 0,!1,R,void 0,void 0),lt={name:"vm-array-editor",components:{},inheritAttrs:!1,props:{},data:function(){return{}},computed:{},created:function(){},methods:{handleChange:function(t,n){this.$emit("change",s({},n,t.target.value))},handleClick:function(){this.$emit("change",{x:this.x+1})}}},At=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticStyle:{display:"flex","flex-direction":"column"}},[e("div",[t._v("w: "),e("input",{domProps:{value:t.$attrs.w},on:{input:function(n){return t.handleChange(n,"w")}}})]),t._v(" "),e("div",[t._v("h: "),e("input",{domProps:{value:t.$attrs.h},on:{input:function(n){return t.handleChange(n,"h")}}})]),t._v(" "),e("div",[t._v("x: "),e("input",{domProps:{value:t.$attrs.x},on:{input:function(n){return t.handleChange(n,"x")}}})]),t._v(" "),e("div",[t._v("y: "),e("input",{domProps:{value:t.$attrs.y},on:{input:function(n){return t.handleChange(n,"y")}}})]),t._v(" "),e("div",[t._v("z: "),e("input",{domProps:{value:t.$attrs.z},on:{input:function(n){return t.handleChange(n,"z")}}})]),t._v(" "),e("div",[t._v("r: "),e("input",{domProps:{value:t.$attrs.r},on:{input:function(n){return t.handleChange(n,"r")}}})]),t._v(" "),e("div",[t._v("name: "),e("input",{domProps:{value:t.$attrs.name},on:{input:function(n){return t.handleChange(n,"name")}}})])])};At._withStripped=!0;var dt={tpl:it,array:{module:"array",type:"营销组件",name:"数组模版",widgets:[{render:function(t,n){return t("div",["一行两列"])}},{name:"一行两列",image:"https://avatars3.githubusercontent.com/u/34465004?s=200&v=4"}],Viewer:st,Editor:N({render:At,staticRenderFns:[]},(function(t){t&&t("data-v-7c4434dc_0",{source:"input {\n  border: 1px solid #000;\n  margin: 10px;\n}\n\n/*# sourceMappingURL=editor.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/modules/array/editor.vue","editor.vue"],names:[],mappings:"AAkDA;EACA,sBAAA;EACA,YAAA;ACjDA;;AAEA,qCAAqC",file:"editor.vue",sourcesContent:['<template>\n\t<div style="display: flex; flex-direction: column;">\n\t\t<div>w: <input :value="$attrs.w" @input="handleChange($event, \'w\')"></div>\n\t\t<div>h: <input :value="$attrs.h" @input="handleChange($event, \'h\')"></div>\n\t\t<div>x: <input :value="$attrs.x" @input="handleChange($event, \'x\')"></div>\n\t\t<div>y: <input :value="$attrs.y" @input="handleChange($event, \'y\')"></div>\n\t\t<div>z: <input :value="$attrs.z" @input="handleChange($event, \'z\')"></div>\n\t\t<div>r: <input :value="$attrs.r" @input="handleChange($event, \'r\')"></div>\n\t\t<div>name: <input :value="$attrs.name" @input="handleChange($event, \'name\')"></div>\n\t</div>\n</template>\n\n<script>\n\nexport default {\n\tname: \'vm-array-editor\',\n\tcomponents: {\n\t},\n\t// 以下两周都可行，相对的inheritAttrs比较好用的一点\n\tinheritAttrs: false,\n\tprops: {\n\t\t// w: Number,\n\t\t// h: Number,\n\t\t// r: Number,\n\t\t// x: Number,\n\t\t// y: Number,\n\t\t// z: Number,\n\t\t// name: [Number, String],\n\t},\n\tdata() {\n\t\treturn {\n\t\t};\n\t},\n\tcomputed: {\n\t},\n\tcreated() {\n\t},\n\tmethods: {\n\t\thandleChange(e, key) {\n\t\t\tthis.$emit(\'change\', { [key]: e.target.value });\n\t\t},\n\t\thandleClick() {\n\t\t\t// this.$emit(\'update:x\', this.x + 1);\n\t\t\tthis.$emit(\'change\', { x: this.x + 1 });\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\ninput {\n\tborder: 1px solid #000;\n\tmargin: 10px;\n}\n</style>\n',"input {\n  border: 1px solid #000;\n  margin: 10px;\n}\n\n/*# sourceMappingURL=editor.vue.map */"]},media:void 0})}),lt,void 0,!1,void 0,!1,R,void 0,void 0),max:5,insertion:"",data:function(t){return{w:200,h:150,r:0,x:0,y:0,z:1,parent:!1,closeable:!0,name:"名称".concat(t)}},dataValidity:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.name?null:{error:"输入框内容必填"}}}},mt={name:"vm-assist-preview",components:{},props:{dataSource:Array,mode:String,frameW:Number},data:function(){return{vm:{type:"preview"}}},computed:{isDraggable:function(){return"draggable"===this.mode},scale:function(){return void 0===this.frameW?1:window.innerWidth/this.frameW}},created:function(){this.isWatch=!1,this.currentId=""},methods:{handleClick:function(t){var n=this;this.currentId=this.currentId===t?null:t,this.isWatch||(this.isWatch=!0,this.$watch("dataSource",(function(t){n.currentId&&(console.log("\n----"),console.log(new RegExp((new Date).toString())),console.log(JSON.parse(JSON.stringify(t.find((function(t){return t.id===n.currentId}))))),console.log("----\n\n"))}),{deep:!0,immediate:!0}))}}},ct=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-assist-preview"},[e("div",{staticStyle:{position:"relative"}},t._l(t.dataSource,(function(n){return e("div",{key:n.id,style:t.isDraggable?{position:"absolute",width:n.w?n.w*t.scale+"px":"auto",height:n.h?n.h*t.scale+"px":"auto",left:n.x*t.scale+"px",top:n.y*t.scale+"px",transform:"rotate("+n.r+"deg)"}:{},on:{click:function(e){return e.altKey?e.ctrlKey||e.shiftKey||e.metaKey?null:t.handleClick(n.id):null}}},[e("vm-"+n.module+"-viewer",t._b({tag:"component",attrs:{vm:t.vm}},"component",n,!1))],1)})),0)])};ct._withStripped=!0;var pt=N({render:ct,staticRenderFns:[]},void 0,mt,void 0,!1,void 0,!1,void 0,void 0,void 0),ut={name:"vm-preview",components:{},props:{dataSource:Array,styles:{type:Object},className:{type:String},animate:{type:String,default:"vm-fade"},mask:{type:Boolean,default:!0},mode:{type:String,default:"draggable"}},data:function(){return{visible:!1,transform:"translate(-100px, -100px)"}},computed:{isDraggable:function(){return"draggable"===this.mode}},watch:{},mounted:function(){this.visible=!0},updated:function(){},methods:{handleClose:function(){var t=this;this.visible=!1,setTimeout((function(){t.$emit("close")}),300)}}},ht=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-assist-preview-popup"},[t.mask?e("transition",{attrs:{name:t.animate}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"vm-assist-preview-popup__mask",on:{click:t.handleClose}})]):t._e(),t._v(" "),t.mask?e("transition",{attrs:{name:t.animate}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"vm-assist-preview-popup__close",on:{click:t.handleClose}},[t._v("✕")])]):t._e(),t._v(" "),e("transition",{attrs:{name:t.animate}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"vm-assist-preview-popup__content"},[e("vm-preview",{style:t.styles,attrs:{"data-source":t.dataSource,mode:t.mode}})],1)])],1)};ht._withStripped=!0;var gt={Preview:pt,PreviewPopup:N({render:ht,staticRenderFns:[]},(function(t){t&&t("data-v-77aa6c13_0",{source:".vm-assist-preview-popup {\n  position: fixed;\n  top: 0;\n  right: 0;\n  left: 0;\n  bottom: 0;\n  z-index: 999;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.vm-assist-preview-popup__mask {\n  position: absolute;\n  z-index: 997;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, .2);\n  -webkit-transition: opacity 0.2s;\n  transition: opacity 0.2s;\n}\n.vm-assist-preview-popup__content {\n  position: relative;\n  z-index: 998;\n  overflow: auto;\n  max-height: 100vh;\n  max-width: 100vw;\n  -webkit-transition: opacity 0.2s, -webkit-transform 0.2s;\n  transition: opacity 0.2s, -webkit-transform 0.2s;\n  transition: transform 0.2s, opacity 0.2s;\n  transition: transform 0.2s, opacity 0.2s, -webkit-transform 0.2s;\n}\n.vm-assist-preview-popup__close {\n  position: absolute;\n  right: 30px;\n  top: 30px;\n  font-size: 24px;\n  z-index: 999;\n}\n.vm-fade-enter, .vm-fade-leave-active {\n  opacity: 0;\n}\n\n/*# sourceMappingURL=popup.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/assist/components/preview/popup.vue","popup.vue"],names:[],mappings:"AA8EA;EACA,eAAA;EACA,MAAA;EACA,QAAA;EACA,OAAA;EACA,SAAA;EACA,YAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,wBAAA;EAAA,+BAAA;MAAA,qBAAA;UAAA,uBAAA;AC7EA;AD+EA;EACA,kBAAA;EACA,YAAA;EACA,MAAA;EACA,OAAA;EACA,WAAA;EACA,YAAA;EACA,mCAAA;EAEA,gCAAA;EAAA,wBAAA;AC7EA;AD+EA;EACA,kBAAA;EACA,YAAA;EACA,cAAA;EACA,iBAAA;EACA,gBAAA;EACA,wDAAA;EAAA,gDAAA;EAAA,wCAAA;EAAA,gEAAA;AC5EA;AD8EA;EACA,kBAAA;EACA,WAAA;EACA,SAAA;EACA,eAAA;EACA,YAAA;AC3EA;AD6EA;EACA,UAAA;AC1EA;;AAEA,oCAAoC",file:"popup.vue",sourcesContent:['<template>\n\t<div class="vm-assist-preview-popup">\n\t\t<transition v-if="mask" :name="animate" >\n\t\t\t<div v-show="visible" class="vm-assist-preview-popup__mask" @click="handleClose" />\n\t\t</transition>\n\t\t<transition v-if="mask" :name="animate" >\n\t\t\t<div v-show="visible" class="vm-assist-preview-popup__close" @click="handleClose">&#10005;</div>\n\t\t</transition>\n\t\t<transition :name="animate">\n\t\t\t<div v-show="visible" class="vm-assist-preview-popup__content">\n\t\t\t\t<vm-preview \n\t\t\t\t\t:style="styles"\n\t\t\t\t\t:data-source="dataSource" \n\t\t\t\t\t:mode="mode"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</transition>\n\t</div>\n</template>\n\n<script>\nexport default {\n\tname: \'vm-preview\',\n\tcomponents: {\n\t\t\n\t},\n\tprops: {\n\t\tdataSource: Array,\n\t\tstyles: {\n\t\t\ttype: Object\n\t\t},\n\t\tclassName: {\n\t\t\ttype: String\n\t\t},\n\t\tanimate: {\n\t\t\ttype: String,\n\t\t\tdefault: \'vm-fade\'\n\t\t},\n\t\tmask: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tmode: {\n\t\t\ttype: String,\n\t\t\tdefault: \'draggable\'\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tvisible: false,\n\t\t\ttransform: `translate(-100px, -100px)`\n\t\t};\n\t},\n\tcomputed: {\n\t\tisDraggable() {\n\t\t\treturn this.mode === \'draggable\';\n\t\t}\n\t},\n\twatch: {\n\t\t\n\t},\n\tmounted() {\n\t\tthis.visible = true;\n\t},\n\tupdated() {\n\t},\n\tmethods: {\n\t\thandleClose() {\n\t\t\tthis.visible = false;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.$emit(\'close\');\n\t\t\t}, 300); // 动画时间\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\n.vm-assist-preview-popup {\n\tposition: fixed;\n\ttop: 0;\n\tright: 0;\n\tleft: 0;\n\tbottom: 0;\n\tz-index: 999;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n.vm-assist-preview-popup__mask {\n\tposition: absolute;\n\tz-index: 997;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\tbackground-color: rgba(#000, 0.2);\n\t// opacity: 0;\n\ttransition: opacity 0.2s;\n}\n.vm-assist-preview-popup__content {\n\tposition: relative;\n\tz-index: 998;\n\toverflow: auto; // 区域之外不形式\n\tmax-height: 100vh; \n\tmax-width: 100vw; \n\ttransition: transform 0.2s, opacity 0.2s;\n}\n.vm-assist-preview-popup__close {\n\tposition: absolute;\n\tright: 30px; \n\ttop: 30px;\n\tfont-size: 24px;\n\tz-index: 999;\n}\n.vm-fade-enter, .vm-fade-leave-active {\n\topacity: 0;\n}\n</style>\n',".vm-assist-preview-popup {\n  position: fixed;\n  top: 0;\n  right: 0;\n  left: 0;\n  bottom: 0;\n  z-index: 999;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.vm-assist-preview-popup__mask {\n  position: absolute;\n  z-index: 997;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.2);\n  transition: opacity 0.2s;\n}\n\n.vm-assist-preview-popup__content {\n  position: relative;\n  z-index: 998;\n  overflow: auto;\n  max-height: 100vh;\n  max-width: 100vw;\n  transition: transform 0.2s, opacity 0.2s;\n}\n\n.vm-assist-preview-popup__close {\n  position: absolute;\n  right: 30px;\n  top: 30px;\n  font-size: 24px;\n  z-index: 999;\n}\n\n.vm-fade-enter, .vm-fade-leave-active {\n  opacity: 0;\n}\n\n/*# sourceMappingURL=popup.vue.map */"]},media:void 0})}),ut,void 0,!1,void 0,!1,R,void 0,void 0)},bt={keyboard:{mounted:function(){},destroyed:function(){},methods:{operateDOMEvents:function(t){}}}},ft={components:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map((function(t){return gt[t]})).filter((function(t){return!!t}))},mixins:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map((function(t){return bt[t]})).filter((function(t){return!!t}))}},vt={data:function(){return{states:{currentSnapshot:0,totalSnapshot:0}}},created:function(){this.historyData=[]},methods:{verifyChange:function(t){if(!t)throw new Error("[wya-vm/combo]: id / original 必传")},updateHistory:function(t,n){var e=this.states,r=e.currentSnapshot,i=e.totalSnapshot,a=n.id,s=n.original,l=n.index,A=n.data,d={type:t,id:a,original:s,index:l,data:o.cloneDeep(A)};r===i?this.historyData.push(d):this.historyData.splice(r,i-r,d);var m=this.historyData.length;this.states.currentSnapshot=m,this.states.totalSnapshot=m}}},xt={data:function(){return{states:{currentEditor:null,pageEditor:null,frameW:0,frameH:0}}},watch:{"states.pageEditor":{deep:!0,immediate:!0,handler:function(t){t&&t.w&&(this.states.frameW=t.w),t&&t.h&&(this.states.frameH=t.h)}}},methods:{updatePageEditor:function(t){if(!t.length)return{};for(var n=0;n<t.length;n++){var e=t[n];if("page"===e.module){this.states.pageEditor=e;break}}},resetCurrentEditor:function(t){this.states.currentEditor=t||this.states.pageEditor||null},updateCurrentEditor:function(){var t,n=this.states,e=n.data,r=void 0===e?[]:e,i=n.currentEditor;i&&(t=r.find((function(t){return t.id===i.id}))),this.states.currentEditor=t||this.states.pageEditor||null}}};function Et(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function yt(t){for(var n=arguments,e=1;e<arguments.length;e++){var r=null!=n[e]?n[e]:{};e%2?Et(r,!0).forEach((function(n){s(t,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Et(r).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}var wt=function(t){function n(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(d(this,n),(e=c(this,p(n).call(this))).mutations={INIT:function(t,n){if(t._data!==n&&!o.isEqualWith(n,t.data)){var e=this._makeRebuildData(n);t._data=e,t.data=e,this.updatePageEditor(e),this.updateCurrentEditor()}},CREATE:function(t,n){var e=n.id,r=n.index,i=n.data;this.verifyChange(e),t.data.splice(r,0,i),this.updateHistory("CREATE",yt({},n,{data:i,index:r}))},DELETE:function(t,n){var e=n.id,r=t.data.findIndex((function(t){return t.id===e})),i=t.data[r];this.verifyChange(e),t.data.splice(r,1),this.resetCurrentEditor(),this.updateHistory("DELETE",yt({},n,{data:i,index:r}))},UPDATE:function(t,n){var e=n.id,r=n.changed,i=n.original,o=void 0===i?{}:i;this.verifyChange(e);var a=t.data.findIndex((function(t){return t.id===e}));r&&Object.keys(r).forEach((function(n){o[n]=t.data[a][n],t.data[a][n]=r[n]})),this.updateHistory("UPDATE",yt({},n,{original:o,data:t.data[a],index:a}))},SORT:function(t,n){var e=n.changed,r=n.original,i=n.history;if(e&&e[0]!==e[1]){this.verifyChange(e);var o=t.data[e[0]],a=t.data[e[1]];a.z&&o.z&&o.z!=a.z&&(o.z=a.z),t.data.splice(e[1]+(e[0]<e[1]),0,o),t.data.splice(e[0]+(e[0]>e[1]),1)}!i||r&&r[0]===r[1]||this.updateHistory("SORT",{original:e||r})},UNDO:function(t,n){var e=this,r=n.current;t.currentSnapshot=r;var i=this.historyData[r]||{},a=i.type,s=i.id,l=i.data,A=i.index,d=i.original,m={CREATE:function(){return t.data.splice(A,1)},DELETE:function(){return t.data.splice(A,0,l)},UPDATE:function(){return t.data.splice(A,1,o.cloneDeep(yt({},l,{},d)))},SORT:function(){return e.commit("SORT",{changed:d,history:!1})}};m[a]&&m[a](),t.pagesEditor&&t.pagesEditor.id===s&&this.resetCurrentEditor(t.data[A])},REDO:function(t,n){var e=this,r=n.current;t.currentSnapshot=r;var i=this.historyData[r-1]||{},o=i.type,a=i.id,s=i.data,l=i.index,A=i.original,d={CREATE:function(){return t.data.splice(l,1,s)},DELETE:function(){return t.data.splice(l,1)},UPDATE:function(){return t.data.splice(l,1,s)},SORT:function(){return e.commit("SORT",{changed:A,history:!1})}};d[o]&&d[o](),t.pagesEditor&&t.pagesEditor.id===a&&this.resetCurrentEditor(t.data[l])}},!t)throw new Error("combo必传");return e.combo=t,Object.keys(r).forEach((function(t){e.states[t]=r[t]})),e}return u(n,t),m(n,[{key:"commit",value:function(t){var n=arguments;t=t.toUpperCase();var e=this.mutations;if(!e[t])throw new Error("[wya-vm/combo]: mutation 未定义 - ".concat(t));for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=n[o];e[t].apply(this,[this.states].concat(i))}},{key:"_makeRebuildData",value:function(t){var n=this.combo.$options.modules;return o.cloneDeep(t).map((function(t){var e=n[t.module]||{},r=e.data,i=void 0===r?{}:r,o=e.rebuilder,a=void 0===o?{}:o;return"function"==typeof i&&(i=i()),"function"==typeof a&&(a=a()),Object.keys(t).forEach((function(n){a[n]&&(t[n]instanceof Array?t[n]=t[n].map((function(t){return yt({},a[n],{},t)})):t[n]instanceof Object&&(t[n]=yt({},a[n],{},t[n])))})),yt({},i,{},t)}))}}]),n}(h.extend({mixins:[vt,xt],data:function(){return{states:{data:[]}}},computed:{},methods:{}}));function Ct(t,n){void 0===n&&(n={});var e=n.insertAt;if(t&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===e&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}}function _t(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function $t(t){for(var n=arguments,e=1;e<arguments.length;e++){var r=null!=n[e]?n[e]:{};e%2?_t(r,!0).forEach((function(n){s(t,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_t(r).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}Ct(".vm-combo__theme--dark .vm-widget .vm-widget__wrapper{background:#535353;color:#fff}.vm-combo__theme--dark .vm-widget .vm-widget__header{color:#fff}.vm-combo__theme--dark .vm-widget .vm-widget__title{color:#fff;border-bottom:1px solid #4c4c4c}.vm-combo__theme--dark .vm-widget .vm-widget__tabs{color:#bdbdbd;border-right:none;border-bottom:none}.vm-combo__theme--dark .vm-widget .vm-widget__tabs p.is-active{color:#fff;background:#424242}.vm-combo__theme--dark .vm-widget .vm-widget__menu{border-top:1px solid #4c4c4c}.vm-combo__theme--dark .vm-widget .vm-widget__content{background:#424242}.vm-combo__theme--dark .vm-widget .vm-widget__arrow{border:2px solid #fff;border-top:0;border-left:0}.vm-combo__theme--dark .vm-widget .vm-widget__combo{border-bottom:1px solid #4c4c4c}.vm-combo__theme--dark .vm-editor .vm-editor__wrapper{background:#535353;color:#fff}.vm-combo__theme--dark .vm-frame-draggable--inner{border-left:1px solid #000;border-right:1px solid #000}.vm-combo__theme--dark .vm-ruler .vm-ruler__canvas{background:#474747}.vm-combo__theme--dark .vm-ruler .vm-ruler__guide{background:#535353}.vm-combo__theme--dark .vm-thumbnail{background:#424242}.vm-combo__theme--dark .vm-zoom-bar{background:#343434;-webkit-box-shadow:none;box-shadow:none}");var kt,Bt,Dt={name:"vm-combo",components:{"vm-assist-operation":ft.Operation,"vm-assist-save":ft.Save},model:{prop:"data-source",event:"change"},props:{width:Number,height:Number,dataSource:{type:Array,default:function(){return[]}},frameStyle:Object,frameW:Number,frameH:Number,frameOpts:Object,widgetStyle:Object,widgetContentStyle:Object,widgetW:Number,widgetH:Number,widgetOpts:Object,editorStyle:Object,editorW:Number,editorH:Number,editorOpts:Object,theme:{type:String,default:"default"},showAssist:{type:Boolean,default:!1},showWidget:{type:Boolean,default:!0},showEditor:{type:Boolean,default:!0},showLines:{type:Boolean,default:!0},showRuler:{type:Boolean,default:!0},showZoomBar:{type:Boolean,default:!0},showThumbnail:{type:Boolean,default:!0}},data:function(){return this.store=new wt(this,{frameW:this.frameW,frameH:this.frameH}),{}},computed:$t({style:function(){return{width:this.width?"".concat(this.width,"px"):"auto",height:this.height?"".concat(this.height,"px"):"auto"}},classes:function(){return{"vm-combo__theme--dark":"dark"===this.theme}}},(kt={rebuildData:"data",rebuildFrameW:"frameW",rebuildFrameH:"frameH",current:"currentSnapshot",total:"totalSnapshot",editor:"currentEditor",pageEditor:"pageEditor"},Bt={},Object.keys(kt).forEach((function(t){var n,e=kt[t];"string"==typeof e?n=function(){return this.store.states[e]}:"function"==typeof e?n=function(){return e.call(this,this.store.states)}:console.error("invalid value type"),n&&(Bt[t]=n)})),Bt)),watch:{dataSource:{deep:!0,immediate:!0,handler:function(t){this.store.commit("INIT",t)}}},created:function(){this.create=this.add,this.delete=this.remove},destroyed:function(){this.$options.previewManager.destroy()},methods:{syncData:function(){this.$emit("change",this.rebuildData),this.$emit("update:data-source",this.rebuildData)},handleActivated:function(t){this.store.resetCurrentEditor(t)},handleDeactivated:function(t,n){this.store.resetCurrentEditor()},handleWidgetChange:function(t){for(var n=arguments,e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=n[i];this.$emit.apply(this,["widget-change",t].concat(r))},handleChange:function(t){var n=t.type,e=A(t,["type"]);this.store.commit(n,e),this.syncData()},add:function(t,n){this.$refs.frame.handleDrop({fake:!0,dataTransfer:{getData:function(){return JSON.stringify({module:t,index:n})}}},!0),this.syncData()},remove:function(t){(t=t||(this.editor||{}).id)&&"page"!==this.editor.module?(this.handleChange({type:"DELETE",id:t}),this.syncData()):this.$emit("error",{type:"id",msg:"请先选择操作对象"})},undo:function(){var t=this.current-1;t<0?this.$emit("error",{type:"undo",msg:"目前已经是初始状态"}):(this.store.commit("UNDO",{current:t}),this.syncData())},redo:function(){var t=this.current+1;t>this.total?this.$emit("error",{type:"undo",msg:"目前已经是最终状态"}):(this.store.commit("REDO",{current:t}),this.syncData())},save:function(){var t=o.cloneDeep(this.rebuildData)||[];if(0===t.length)return this.$emit("error",{type:"save",msg:"保存对象不能为空"}),!1;for(var n=this.$options.modules,e=0;e<t.length;e++){var r=t[e].module;if(n[r].dataValidity){var i=n[r].dataValidity(t[e]);if(i)return this.$emit("error",{type:"save",msg:"第".concat(e+1,"个 - ").concat(i.error),index:e}),this.$refs.frame.setActived(e),!1}}return this.$emit("save",t),!0},preview:function(){return 0===this.rebuildData.length?(this.$emit("error",{type:"preview",msg:"预览数据对象不能为空"}),!1):(this.$options.previewManager.popup({dataSource:o.cloneDeep(this.rebuildData),styles:$t({},this.frameStyle,{width:0===this.rebuildFrameW?"auto":"".concat(this.rebuildFrameW,"px"),height:0===this.rebuildFrameH?"auto":"".concat(this.rebuildFrameH,"px")}),className:"vm-combo__frame"}),!0)}}},St=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-combo",class:t.classes,style:t.style},[t.showWidget?e("vm-widget",t._b({style:t.widgetStyle,attrs:{"content-style":t.widgetContentStyle,theme:t.theme},on:{change:t.handleWidgetChange}},"vm-widget",t.widgetOpts,!1)):t._e(),t._v(" "),e("vm-frame",t._b({ref:"frame",attrs:{"frame-style":t.frameStyle,width:t.rebuildFrameW,height:t.rebuildFrameH,"data-source":t.rebuildData,editor:t.editor,"show-lines":t.showLines,"show-ruler":t.showRuler,"show-zoom-bar":t.showZoomBar,"show-thumbnail":t.showThumbnail,theme:t.theme},on:{activated:t.handleActivated,deactivated:t.handleDeactivated,change:t.handleChange,error:function(n){return t.$emit("error",arguments[0])}}},"vm-frame",t.frameOpts,!1),[t._t("frame-header"),t._v(" "),t._t("frame-footer")],2),t._v(" "),t.showEditor&&t.editor?e("vm-editor",t._b({style:t.editorStyle,attrs:{value:t.editor,"data-source":t.rebuildData,theme:t.theme,width:t.editorW,height:t.editorH},on:{change:t.handleChange}},"vm-editor",t.editorOpts,!1)):t._e()],1)};St._withStripped=!0;var Ot=N({render:St,staticRenderFns:[]},(function(t){t&&t("data-v-0ceba0d8_0",{source:"@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-combo {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n}\n\n/*# sourceMappingURL=combo.vue.map */",map:{version:3,sources:["combo.vue","/Users/deot/Desktop/wya/github/wya-vm/src/combo/combo.vue"],names:[],mappings:"AAAA,gBAAgB;AAChB;;;;EAIE;AACF;;;;;EAKE;AACF;;;;EAIE;AACF;;;;;EAKE;AACF;;;;;;;EAOE;AACF;;;;;;;EAOE;AACF;;;;EAIE;AACF;;EAEE;AACF;;EAEE;AACF;;EAEE;AACF,sBAAsB;AACtB;;;EAGE;AACF;6BAC6B;AAC7B;6BAC6B;AAC7B;6BAC6B;AAC7B;;EAEE;AACF;;;;;EAKE;AACF;;;EAGE;AACF;;;EAGE;AACF;;EAEE;AACF;;EAEE;AC8PF;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;AD5PA;;AAEA,oCAAoC",file:"combo.vue",sourcesContent:["@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-combo {\n  display: flex;\n}\n\n/*# sourceMappingURL=combo.vue.map */","<template>\n\t<div :style=\"style\" :class=\"classes\" class=\"vm-combo\">\n\t\t<vm-widget \n\t\t\tv-if=\"showWidget\"\n\t\t\t:style=\"widgetStyle\" \n\t\t\t:content-style=\"widgetContentStyle\" \n\t\t\t:theme=\"theme\"\n\t\t\tv-bind=\"widgetOpts\"\n\t\t\t@change=\"handleWidgetChange\"\n\t\t/>\n\t\t<vm-frame \n\t\t\tref=\"frame\"\n\t\t\t:frame-style=\"frameStyle\" \n\t\t\t:width=\"rebuildFrameW\" \n\t\t\t:height=\"rebuildFrameH\" \n\t\t\t:data-source=\"rebuildData\" \n\t\t\t:editor=\"editor\" \n\t\t\t:show-lines=\"showLines\"\n\t\t\t:show-ruler=\"showRuler\"\n\t\t\t:show-zoom-bar=\"showZoomBar\"\n\t\t\t:show-thumbnail=\"showThumbnail\"\n\t\t\t:theme=\"theme\"\n\t\t\tv-bind=\"frameOpts\"\n\t\t\t@activated=\"handleActivated\"\n\t\t\t@deactivated=\"handleDeactivated\"\n\t\t\t@change=\"handleChange\"\n\t\t\t@error=\"$emit('error', arguments[0])\"\n\t\t>\n\t\t\t<slot name=\"frame-header\" />\n\t\t\t<slot name=\"frame-footer\" />\n\t\t</vm-frame>\n\t\t\x3c!--  vue.sync遇到引用类型可跨层级修改，Object/Array. 如Object, 不要操作对象，把每个值解构出来v-bind.sync. --\x3e\n\t\t<vm-editor \n\t\t\tv-if=\"showEditor && editor\"\n\t\t\t:value=\"editor\"\n\t\t\t:data-source=\"rebuildData\"\n\t\t\t:theme=\"theme\"\n\t\t\t:style=\"editorStyle\"\n\t\t\t:width=\"editorW\"\n\t\t\t:height=\"editorH\"\n\t\t\tv-bind=\"editorOpts\"\n\t\t\t@change=\"handleChange\"\n\t\t/>\n\t</div>\n</template>\n\n<script>\nimport { Assist } from './assist';\nimport { Store, mapStates } from './store';\nimport { cloneDeep, isEqualWith } from '../utils/helper';\nimport { PAGE_MOULE } from '../utils/constants';\nimport './theme-dark.scss';\n\nexport default {\n\tname: 'vm-combo',\n\tcomponents: {\n\t\t// 会被注入vm-frame, vm-widget, vm-editor,\n\t\t'vm-assist-operation': Assist.Operation,\n\t\t'vm-assist-save': Assist.Save,\n\t},\n\tmodel: {\n\t\tprop: 'data-source',\n\t\tevent: 'change'\n\t},\n\tprops: {\n\t\twidth: Number,\n\t\theight: Number,\n\t\tdataSource: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => ([])\n\t\t},\n\t\t/**\n\t\t * frame\n\t\t */\n\t\tframeStyle: Object,\n\t\tframeW: Number,\n\t\tframeH: Number,\n\t\tframeOpts: Object,\n\t\t/**\n\t\t * widget\n\t\t */\n\t\twidgetStyle: Object,\n\t\twidgetContentStyle: Object,\n\t\twidgetW: Number,\n\t\twidgetH: Number,\n\t\twidgetOpts: Object,\n\n\t\t/**\n\t\t * widget\n\t\t */\n\t\teditorStyle: Object,\n\t\teditorW: Number,\n\t\teditorH: Number,\n\t\teditorOpts: Object,\n\n\t\t/**\n\t\t * combo\n\t\t */\n\t\ttheme: {\n\t\t\ttype: String,\n\t\t\tdefault: 'default' // default / light / dark\n\t\t},\n\t\tshowAssist: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tshowWidget: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowEditor: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowLines: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowRuler: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowZoomBar: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowThumbnail: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t},\n\tdata() {\n\t\tthis.store = new Store(this, {\n\t\t\tframeW: this.frameW,\n\t\t\tframeH: this.frameH,\n\t\t});\n\t\treturn {};\n\t},\n\tcomputed: {\n\t\tstyle() {\n\t\t\tconst w = !this.width ? 'auto' : `${this.width}px`;\n\t\t\tconst h = !this.height ? 'auto' : `${this.height}px`;\n\n\t\t\treturn {\n\t\t\t\twidth: w,\n\t\t\t\theight: h\n\t\t\t};\n\t\t},\n\n\t\tclasses() {\n\t\t\treturn {\n\t\t\t\t'vm-combo__theme--dark': this.theme === 'dark'\n\t\t\t};\n\t\t},\n\n\t\t...mapStates({\n\t\t\trebuildData: 'data',\n\t\t\trebuildFrameW: 'frameW',\n\t\t\trebuildFrameH: 'frameH',\n\t\t\tcurrent: 'currentSnapshot',\n\t\t\ttotal: 'totalSnapshot',\n\t\t\teditor: 'currentEditor',\n\t\t\tpageEditor: 'pageEditor',\n\t\t})\n\t},\n\twatch: {\n\t\tdataSource: {\n\t\t\tdeep: true,\n\t\t\timmediate: true,\n\t\t\thandler(v) {\n\t\t\t\tthis.store.commit('INIT', v);\n\t\t\t}\n\t\t}\n\t},\n\tcreated() {\n\t\t// 处理历史暴露的API映射\n\t\tthis.create = this.add;\n\t\tthis.delete = this.remove;\n\t},\n\tdestroyed() {\n\t\tthis.$options.previewManager.destroy();\n\t},\n\tmethods: {\n\n\t\tsyncData() {\n\t\t\tthis.$emit('change', this.rebuildData);\n\t\t\tthis.$emit('update:data-source', this.rebuildData);\n\t\t},\n\n\t\t/**\n\t\t * draggable\n\t\t */\n\t\thandleActivated(it) {\n\t\t\tthis.store.resetCurrentEditor(it);\n\t\t},\n\n\t\thandleDeactivated(e, it) {\n\t\t\tthis.store.resetCurrentEditor();\n\t\t},\n\n\t\t/**\n\t\t * 用户处理widget出来的数据, 暂时做不到记忆\n\t\t * TODO: 可能被废弃\n\t\t */\n\t\thandleWidgetChange(module, ...rest) {\n\t\t\tthis.$emit('widget-change', module, ...rest);\n\t\t},\n\n\t\t/**\n\t\t * 数据变化\n\t\t */\n\t\thandleChange({ type, ...payload }) {\n\t\t\tthis.store.commit(type, payload);\n\t\t\tthis.syncData();\n\t\t},\n\n\t\t/**\n\t\t * 模拟添加\n\t\t */\n\t\tadd(module, index) {\n\t\t\tthis.$refs.frame.handleDrop({\n\t\t\t\tfake: true,\n\t\t\t\tdataTransfer: {\n\t\t\t\t\tgetData: () => {\n\t\t\t\t\t\treturn JSON.stringify({\n\t\t\t\t\t\t\tmodule,\n\t\t\t\t\t\t\tindex\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, true);\n\t\t\tthis.syncData();\n\t\t},\n\n\t\t/**\n\t\t * 删除\n\t\t */\n\t\tremove(id, force = false) {\n\t\t\tid = id || (this.editor || {}).id;\n\t\t\tif (!id || (this.editor.module === PAGE_MOULE)) {\n\t\t\t\tthis.$emit('error', { \n\t\t\t\t\ttype: 'id', \n\t\t\t\t\tmsg: \"请先选择操作对象\" \n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.handleChange({ type: 'DELETE', id });\n\t\t\tthis.syncData();\n\t\t},\n\n\t\tundo() {\n\t\t\tlet current = this.current - 1;\n\t\t\tif (current < 0) {\n\t\t\t\tthis.$emit('error', { \n\t\t\t\t\ttype: 'undo', \n\t\t\t\t\tmsg: \"目前已经是初始状态\" \n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.store.commit('UNDO', { current });\n\t\t\tthis.syncData();\n\t\t},\n\n\t\tredo() {\n\t\t\tlet current = this.current + 1;\n\t\t\tif (current > this.total) {\n\t\t\t\tthis.$emit('error', { \n\t\t\t\t\ttype: 'undo', \n\t\t\t\t\tmsg: \"目前已经是最终状态\" \n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.store.commit('REDO', { current });\n\t\t\tthis.syncData();\n\t\t},\n\n\t\t/**\n\t\t * widget-save\n\t\t */\n\t\tsave() {\n\t\t\tconst data = cloneDeep(this.rebuildData) || [];\n\n\t\t\tif (data.length === 0) {\n\t\t\t\tthis.$emit('error', { \n\t\t\t\t\ttype: 'save', \n\t\t\t\t\tmsg: `保存对象不能为空` \n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst { modules } = this.$options;\n\t\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\t\tlet { module: mod } = data[i];\n\t\t\t\tif (modules[mod].dataValidity) {\n\t\t\t\t\tlet error = modules[mod].dataValidity(data[i]);\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tthis.$emit('error', { \n\t\t\t\t\t\t\ttype: 'save', \n\t\t\t\t\t\t\tmsg: `第${i + 1}个 - ${error.error}`, \n\t\t\t\t\t\t\tindex: i \n\t\t\t\t\t\t});\n\t\t\t\t\t\t// 错误元素激活\n\t\t\t\t\t\tthis.$refs.frame.setActived(i);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t/**\n\t\t\t * 数据验证\n\t\t\t */\n\t\t\tthis.$emit('save', data);\n\t\t\treturn true;\n\t\t},\n\n\t\tpreview() {\n\t\t\tif (this.rebuildData.length === 0) {\n\t\t\t\tthis.$emit('error', { \n\t\t\t\t\ttype: 'preview', \n\t\t\t\t\tmsg: `预览数据对象不能为空` \n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.$options.previewManager.popup({\n\t\t\t\tdataSource: cloneDeep(this.rebuildData),\n\t\t\t\tstyles: {\n\t\t\t\t\t...this.frameStyle,\n\t\t\t\t\twidth: this.rebuildFrameW === 0 ? 'auto' : `${this.rebuildFrameW}px`,\n\t\t\t\t\theight: this.rebuildFrameH === 0 ? 'auto' : `${this.rebuildFrameH}px`\n\t\t\t\t},\n\t\t\t\tclassName: 'vm-combo__frame'\n\t\t\t});\n\n\t\t\treturn true;\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang=\"scss\">\n@import \"../style/index.scss\";\n\n.vm-combo {\n\tdisplay: flex;\n}\n</style>\n"]},media:void 0})}),Dt,void 0,!1,void 0,!1,R,void 0,void 0),zt={name:"vm-grid-lines",components:{},props:{width:Number,height:Number,grid:{type:Array,default:function(){return[10,10]}}},data:function(){return{}},computed:{xArr:function(){var t=this,n=Math.floor(this.width/this.grid[0]);return Array.from({length:n},(function(n,e){return e*t.grid[0]}))},yArr:function(){var t=this,n=Math.floor(this.height/this.grid[1]);return Array.from({length:n},(function(n,e){return e*t.grid[1]}))}},watch:{},created:function(){},methods:{}},Mt=function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"vm-grid-lines"},[this._l(this.yArr,(function(t){return n("div",{key:"y_"+t,staticClass:"vm-grid-lines__y",style:{top:t+"px"}})})),this._v(" "),this._l(this.xArr,(function(t){return n("div",{key:"x_"+t,staticClass:"vm-grid-lines__x",style:{left:t+"px"}})}))],2)};Mt._withStripped=!0;var Ft=N({render:Mt,staticRenderFns:[]},(function(t){t&&t("data-v-02acb640_0",{source:".vm-grid-lines {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  z-index: 0;\n}\n.vm-grid-lines__x {\n  position: absolute;\n  left: 0;\n  width: 1px;\n  height: 100%;\n  border-left-width: 1px;\n  border-left-style: dotted;\n  border-left-color: #d6d6d6;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n.vm-grid-lines__y {\n  position: absolute;\n  top: 0;\n  width: 100%;\n  height: 1px;\n  border-top-width: 1px;\n  border-top-style: dotted;\n  border-top-color: #d6d6d6;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n\n/*# sourceMappingURL=grid-lines.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/draggable/grid-lines.vue","grid-lines.vue"],names:[],mappings:"AA4DA;EACA,kBAAA;EACA,MAAA;EACA,OAAA;EACA,WAAA;EACA,YAAA;EACA,gBAAA;EACA,UAAA;AC3DA;AD6DA;EACA,kBAAA;EACA,OAAA;EACA,UAAA;EACA,YAAA;EACA,sBAAA;EACA,yBAAA;EACA,0BAAA;EACA,8BAAA;UAAA,sBAAA;AC1DA;AD4DA;EACA,kBAAA;EACA,MAAA;EACA,WAAA;EACA,WAAA;EACA,qBAAA;EACA,wBAAA;EACA,yBAAA;EACA,8BAAA;UAAA,sBAAA;ACzDA;;AAEA,yCAAyC",file:"grid-lines.vue",sourcesContent:['<template>\n\t<div class="vm-grid-lines">\n\t\t<div \n\t\t\tv-for="item in yArr" \n\t\t\t:key="`y_${item}`" \n\t\t\t:style="{top: `${item}px`}"  \n\t\t\tclass="vm-grid-lines__y"\n\t\t/>\n\t\t<div \n\t\t\tv-for="item in xArr" \n\t\t\t:key="`x_${item}`" \n\t\t\t:style="{left: `${item}px`}"  \n\t\t\tclass="vm-grid-lines__x"\n\t\t/>\n\t</div>\n</template>\n\n<script>\nexport default {\n\tname: \'vm-grid-lines\',\n\tcomponents: {\n\n\t},\n\tprops: {\n\t\twidth: Number,\n\t\theight: Number,\n\t\tgrid: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => {\n\t\t\t\treturn [10, 10];\n\t\t\t}\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t};\n\t},\n\tcomputed: {\n\t\txArr() {\n\t\t\tlet length = Math.floor(this.width / this.grid[0]);\n\t\t\treturn Array.from({ length }, (v, i) => i * this.grid[0]);\n\t\t},\n\t\tyArr() {\n\t\t\tlet length = Math.floor(this.height / this.grid[1]);\n\t\t\treturn Array.from({ length }, (v, i) => i * this.grid[1]);\n\t\t}\n\t},\n\twatch: {\n\t\t\n\t},\n\tcreated() {\n\t\t\n\t},\n\tmethods: {\n\n\t},\n};\n<\/script>\n\n<style lang="scss">\n.vm-grid-lines {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\toverflow: hidden;\n\tz-index: 0;\n}\n.vm-grid-lines__x {\n\tposition: absolute;\n\tleft: 0;\n\twidth: 1px;\n\theight: 100%;\n\tborder-left-width: 1px;\n\tborder-left-style: dotted;\n\tborder-left-color: rgb(214, 214, 214);\n\tbox-sizing: border-box;\n}\n.vm-grid-lines__y {\n\tposition: absolute;\n\ttop: 0;\n\twidth: 100%;\n\theight: 1px;\n\tborder-top-width: 1px;\n\tborder-top-style: dotted;\n\tborder-top-color: rgb(214, 214, 214); \n\tbox-sizing: border-box;\n}\n</style>\n',".vm-grid-lines {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  z-index: 0;\n}\n\n.vm-grid-lines__x {\n  position: absolute;\n  left: 0;\n  width: 1px;\n  height: 100%;\n  border-left-width: 1px;\n  border-left-style: dotted;\n  border-left-color: #d6d6d6;\n  box-sizing: border-box;\n}\n\n.vm-grid-lines__y {\n  position: absolute;\n  top: 0;\n  width: 100%;\n  height: 1px;\n  border-top-width: 1px;\n  border-top-style: dotted;\n  border-top-color: #d6d6d6;\n  box-sizing: border-box;\n}\n\n/*# sourceMappingURL=grid-lines.vue.map */"]},media:void 0})}),zt,void 0,!1,void 0,!1,R,void 0,void 0),Tt={name:"vm-align-lines",components:{},props:{dataSource:{type:Array,default:function(){return[]}},editor:Object},data:function(){return{}},computed:{alignData:function(){var t=this;if(this.dataSource.length<=1||!this.editor)return{xArr:[],yArr:[]};var n=this.editor||{},e=n.x,r=n.y,i=n.w,o=n.h,a=[e,e+i/2,e+i],s=[r,r+o/2,r+o],l=this.dataSource.reduce((function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.x,i=e.y,o=e.w,a=e.h,s=e.id;if(s!==t.editor.id){var l=[r,r+o/2,r+o],A=[i,i+a/2,i+a];n.xArr=[].concat(g(n.xArr),l),n.yArr=[].concat(g(n.yArr),A)}return n}),{xArr:[],yArr:[]});return{xArr:a.filter((function(t){return l.xArr.includes(t)})),yArr:s.filter((function(t){return l.yArr.includes(t)}))}}},watch:{},created:function(){},methods:{}},Nt=function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"vm-align-lines"},[this._l(this.alignData.yArr,(function(t){return n("div",{key:"y_"+t,staticClass:"vm-align-lines__y",style:{top:t+"px"}})})),this._v(" "),this._l(this.alignData.xArr,(function(t){return n("div",{key:"x_"+t,staticClass:"vm-align-lines__x",style:{left:t+"px"}})}))],2)};Nt._withStripped=!0;var Wt=N({render:Nt,staticRenderFns:[]},(function(t){t&&t("data-v-1c8b90fd_0",{source:".vm-align-lines {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  z-index: 0;\n}\n.vm-align-lines__x {\n  position: absolute;\n  left: 0;\n  width: 1px;\n  height: 100%;\n  border-left-width: 1px;\n  border-left-style: dotted;\n  border-left-color: #1fb6ff;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n.vm-align-lines__y {\n  position: absolute;\n  top: 0;\n  width: 100%;\n  height: 1px;\n  border-top-width: 1px;\n  border-top-style: dotted;\n  border-top-color: #1fb6ff;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n\n/*# sourceMappingURL=align-lines.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/draggable/align-lines.vue","align-lines.vue"],names:[],mappings:"AA+EA;EACA,kBAAA;EACA,MAAA;EACA,OAAA;EACA,WAAA;EACA,YAAA;EACA,gBAAA;EACA,UAAA;AC9EA;ADgFA;EACA,kBAAA;EACA,OAAA;EACA,UAAA;EACA,YAAA;EACA,sBAAA;EACA,yBAAA;EACA,0BAAA;EACA,8BAAA;UAAA,sBAAA;AC7EA;AD+EA;EACA,kBAAA;EACA,MAAA;EACA,WAAA;EACA,WAAA;EACA,qBAAA;EACA,wBAAA;EACA,yBAAA;EACA,8BAAA;UAAA,sBAAA;AC5EA;;AAEA,0CAA0C",file:"align-lines.vue",sourcesContent:['<template>\n\t<div class="vm-align-lines">\n\t\t<div \n\t\t\tv-for="item in alignData.yArr" \n\t\t\t:key="`y_${item}`" \n\t\t\t:style="{top: `${item}px`}"  \n\t\t\tclass="vm-align-lines__y"\n\t\t/>\n\t\t<div \n\t\t\tv-for="item in alignData.xArr" \n\t\t\t:key="`x_${item}`" \n\t\t\t:style="{left: `${item}px`}"  \n\t\t\tclass="vm-align-lines__x"\n\t\t/>\n\t</div>\n</template>\n\n<script>\nexport default {\n\tname: \'vm-align-lines\',\n\tcomponents: {\n\n\t},\n\tprops: {\n\t\tdataSource: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => ([])\n\t\t},\n\t\teditor: Object\n\t},\n\tdata() {\n\t\treturn {\n\t\t};\n\t},\n\tcomputed: {\n\t\talignData() {\n\t\t\tif (this.dataSource.length <= 1 || !this.editor) {\n\t\t\t\treturn {\n\t\t\t\t\txArr: [],\n\t\t\t\t\tyArr: []\n\t\t\t\t};\n\t\t\t}\n\t\t\tconst { x, y, w, h } = this.editor || {};\n\t\t\tlet xArr = [x, x + w / 2, x + w];\n\t\t\tlet yArr = [y, y + h / 2, y + h];\n\n\t\t\tlet xyObj = this.dataSource.reduce((result, itemData = {}) => {\n\n\t\t\t\tconst { x, y, w, h, id } = itemData;\n\t\t\t\tif (id !== this.editor.id) {\n\t\t\t\t\tlet xArr = [x, x + w / 2, x + w];\n\t\t\t\t\tlet yArr = [y, y + h / 2, y + h];\n\t\t\t\t\tresult.xArr = [...result.xArr, ...xArr];\n\t\t\t\t\tresult.yArr = [...result.yArr, ...yArr];\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}, {\n\t\t\t\txArr: [],\n\t\t\t\tyArr: []\n\t\t\t});\n\t\t\treturn {\n\t\t\t\txArr: xArr.filter(item => xyObj.xArr.includes(item)),\n\t\t\t\tyArr: yArr.filter(item => xyObj.yArr.includes(item))\n\t\t\t};\n\t\t}\n\t},\n\twatch: {\n\t\t\n\t},\n\tcreated() {\n\t\t\n\t},\n\tmethods: {\n\n\t},\n};\n<\/script>\n\n<style lang="scss">\n.vm-align-lines {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\toverflow: hidden;\n\tz-index: 0;\n}\n.vm-align-lines__x {\n\tposition: absolute;\n\tleft: 0;\n\twidth: 1px;\n\theight: 100%;\n\tborder-left-width: 1px;\n\tborder-left-style: dotted;\n\tborder-left-color: #1fb6ff;\n\tbox-sizing: border-box;\n}\n.vm-align-lines__y {\n\tposition: absolute;\n\ttop: 0;\n\twidth: 100%;\n\theight: 1px;\n\tborder-top-width: 1px;\n\tborder-top-style: dotted;\n\tborder-top-color: #1fb6ff; \n\tbox-sizing: border-box;\n}\n</style>\n',".vm-align-lines {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  z-index: 0;\n}\n\n.vm-align-lines__x {\n  position: absolute;\n  left: 0;\n  width: 1px;\n  height: 100%;\n  border-left-width: 1px;\n  border-left-style: dotted;\n  border-left-color: #1fb6ff;\n  box-sizing: border-box;\n}\n\n.vm-align-lines__y {\n  position: absolute;\n  top: 0;\n  width: 100%;\n  height: 1px;\n  border-top-width: 1px;\n  border-top-style: dotted;\n  border-top-color: #1fb6ff;\n  box-sizing: border-box;\n}\n\n/*# sourceMappingURL=align-lines.vue.map */"]},media:void 0})}),Tt,void 0,!1,void 0,!1,R,void 0,void 0);Ct("#test{color:red}");var Ut={name:"vm-ruler",components:{},props:{scrollTop:{type:Number,default:0},scrollLeft:{type:Number,default:0},frameW:{type:Number,default:0},frameH:{type:Number,default:0},clientW:{type:Number,default:0},clientH:{type:Number,default:0},scale:{type:Number,default:1},guides:Array,theme:String,borderSize:{type:Object,default:function(){return{top:0,left:0,bottom:0,right:0}}}},data:function(){return{guideSize:20,showGuide:!0,showGuideX:!1,showGuideY:!1,mouseX:0,mouseY:0,offsetX:0,offsetY:0,linesX:[],linesY:[],movingAxias:"",movingIndex:-1}},computed:{canvasW:function(){var t=this.frameW,n=this.frameH,e=this.scale,r=this.borderSize,i=this.guideSize,o=this.clientW,a=this.clientH,s=r.left+r.right+i,l=r.top+r.bottom+i;return 30+Math.max(t*e+s,n*e+l,o,a)},placeholderW:function(){return this.borderSize.left+this.guideSize},interval:function(){return 100*this.scale},isDark:function(){return"dark"===this.theme}},watch:{linesX:{deep:!0,handler:function(){this.$emit("guides-change",[this.linesX,this.linesY])}},linesY:{deep:!0,handler:function(){this.$emit("guides-change",[this.linesX,this.linesY])}}},created:function(){var t=this,n=o.debounce(this.refreshCanvas,50);["frameW","frameH","scale","clientW","clientH","theme"].forEach((function(e){return t.$watch(e,n)}))},mounted:function(){var t=this;this.$nextTick((function(){t.canvas=[t.$refs.canvasX,t.$refs.canvasY],t.offsetX=t.$refs.x.getBoundingClientRect().x,t.offsetY=t.$refs.y.getBoundingClientRect().y,t.refreshCanvas()}))},destroyed:function(){this.operateDOMEvents("remove")},methods:{refreshCanvas:function(){var t=this;this.canvas.forEach((function(n){return t.repaint(n)})),window.canvas=this.canvas},repaint:function(t){if(this._isMounted&&t){var n=this.canvasW,e=this.guideSize,r=this.placeholderW,i=this.interval,o=this.isDark,a=t.getContext("2d");t.height=t.height,a.beginPath(),a.fillStyle=o?"#474747":"#FAFAFA",a.fillRect(0,0,n,e),a.translate(r,0),a.fillStyle=o?"#615E5B":"#000",a.save();for(var s=0;s<n/i;s++)a.fillStyle=o?"#615E5B":"#000",a.translate(s*i,0),a.fillRect(0,0,1,e),a.restore(),a.save(),a.fillStyle="#8C8D89",a.font="12px",a.fillText(100*s,s*i+4,e/5*3);a.restore(),a.translate(0,e-3),a.save();for(var l=0;l<n/i*10;l++)l%10!=0&&(a.translate(l*i/10,0),a.fillRect(0,0,1,3),a.restore(),a.save())}},handleShowGuideX:function(t){var n=this.offsetX,e=this.placeholderW,r=this.scrollLeft,i=this.scale;this.$refs.x.contains(t.target)&&!a.$(t.target).hasClass("is-solid")?(this.showGuideX=!0,this.mouseX=Math.floor((t.clientX-n-e+r)/i)):this.showGuideX=!1},handleShowGuideY:function(t){var n=this.offsetY,e=this.placeholderW,r=this.scrollTop,i=this.scale;this.$refs.y.contains(t.target)&&!a.$(t.target).hasClass("is-solid")?(this.showGuideY=!0,this.mouseY=Math.floor((t.clientY-n-e+r)/i)):this.showGuideY=!1},handleAddLineX:function(){!this.linesX.includes(this.mouseX)&&this.linesX.push(this.mouseX)},handleAddLineY:function(){!this.linesY.includes(this.mouseY)&&this.linesY.push(this.mouseY)},operateDOMEvents:function(t){var n="add"===t?document.documentElement.addEventListener:document.documentElement.removeEventListener;n("mouseup",this.handleMouseUp),n("mousemove",this.handleMouseMove)},handleMouseDown:function(t,n){y.clearSelection(),this.movingIndex=n,this.movingAxias=t,this.operateDOMEvents("add")},handleMouseUp:function(){y.clearSelection(),this.operateDOMEvents("remove")},handleMouseMove:function(t){var n=this.offsetX,e=this.offsetY,r=this.placeholderW,i=this.scrollLeft,o=this.scrollTop,a=this.scale;"x"!==this.movingAxias?"y"!==this.movingAxias||this.$set(this.linesY,this.movingIndex,Math.floor((t.clientY-e-r+o)/a)):this.$set(this.linesX,this.movingIndex,Math.floor((t.clientX-n-r+i)/a))}}},Rt=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-ruler",class:{"is-dark":t.isDark}},[e("div",{staticClass:"vm-ruler__guide",style:{width:t.guideSize+"px",height:t.guideSize+"px"},attrs:{title:"单击"+(t.showGuide?"隐藏":"显示")+"辅助线"},on:{click:function(n){t.showGuide=!t.showGuide}}}),t._v(" "),e("div",{ref:"x",staticClass:"vm-ruler__x",style:{transform:"translateX("+-t.scrollLeft+"px)"},on:{mousemove:t.handleShowGuideX,mouseleave:function(n){t.showGuideX=!1}}},[e("canvas",{ref:"canvasX",staticClass:"vm-ruler__canvas",attrs:{width:t.canvasW,height:t.guideSize}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showGuideX,expression:"showGuideX"}],ref:"guideX",staticClass:"vm-ruler__guide-x",style:{left:t.mouseX*t.scale+t.placeholderW+"px"},on:{click:function(n){return n.stopPropagation(),t.handleAddLineX(n)}}},[e("span",[t._v("\n\t\t\t\t"+t._s(t.mouseX)+"\n\t\t\t")])]),t._v(" "),t.showGuide?t._l(t.linesX,(function(n,r){return e("div",{key:r,staticClass:"vm-ruler__guide-x is-solid",style:{left:n*t.scale+t.placeholderW+"px"},attrs:{title:"双击删除参考线"},on:{mousedown:function(n){return n.stopPropagation(),t.handleMouseDown("x",r)},dblclick:function(n){return t.linesX.splice(r,1)}}},[e("span",[t._v("\n\t\t\t\t\t"+t._s(n)+"\n\t\t\t\t")])])})):t._e()],2),t._v(" "),e("div",{staticClass:"vm-ruler__wrapper"},[e("div",{staticClass:"vm-ruler__y"},[e("div",{ref:"y",staticClass:"vm-ruler__y-rotate",style:{transform:"rotate(90deg) translateX("+-t.scrollTop+"px)"},on:{mousemove:t.handleShowGuideY,mouseleave:function(n){t.showGuideY=!1}}},[e("canvas",{ref:"canvasY",staticClass:"vm-ruler__canvas",attrs:{width:t.canvasW,height:t.guideSize}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showGuideY,expression:"showGuideY"}],staticClass:"vm-ruler__guide-y",style:{left:t.mouseY*t.scale+t.placeholderW+"px"},on:{click:function(n){return n.stopPropagation(),t.handleAddLineY(n)}}},[e("span",[t._v("\n\t\t\t\t\t\t"+t._s(t.mouseY)+"\n\t\t\t\t\t")])]),t._v(" "),t.showGuide?t._l(t.linesY,(function(n,r){return e("div",{key:r,staticClass:"vm-ruler__guide-y is-solid",style:{left:n*t.scale+t.placeholderW+"px"},attrs:{title:"双击删除参考线"},on:{mousedown:function(n){return n.stopPropagation(),t.handleMouseDown("y",r)},dblclick:function(n){return t.linesY.splice(r,1)}}},[e("span",[t._v("\n\t\t\t\t\t\t\t"+t._s(n)+"\n\t\t\t\t\t\t")])])})):t._e()],2)]),t._v(" "),t._t("default")],2)])};Rt._withStripped=!0;var Yt=N({render:Rt,staticRenderFns:[]},(function(t){t&&t("data-v-0bb9c5fc_0",{source:"@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-ruler {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  height: 100%;\n  position: relative;\n}\n.vm-ruler__x {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  position: relative;\n  z-index: 2;\n}\n.vm-ruler__wrapper {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  height: 100%;\n}\n.vm-ruler__y {\n  height: 100%;\n  width: 20px;\n  z-index: 2;\n}\n.vm-ruler__y-rotate {\n  -webkit-transform-origin: 0 100% 0;\n      -ms-transform-origin: 0 100% 0;\n          transform-origin: 0 100% 0;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  position: relative;\n  margin-top: -39px;\n}\n.vm-ruler__guide {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 20px;\n  height: 20px;\n  background: #efefef;\n  cursor: pointer;\n  z-index: 3;\n}\n.vm-ruler__canvas {\n  background: #FAFAFA;\n}\n.vm-ruler.is-dark .vm-ruler__canvas {\n  background: #474747;\n}\n.vm-ruler.is-dark .vm-ruler__guide {\n  background: #535353;\n}\n.vm-ruler.is-dark .vm-ruler__guide {\n  background: #535353;\n}\n.vm-ruler__guide-x {\n  position: absolute;\n  height: 100vh;\n  top: 0;\n  border-left: 1px dashed rgba(0, 173, 255, .84);\n  padding-left: 5px;\n  cursor: ew-resize;\n}\n.vm-ruler__guide-x > span {\n  position: absolute;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  color: #fff;\n  padding: 0 4px;\n  line-height: 20px;\n  border-radius: 1px;\n  -webkit-box-shadow: 0 0 5px -3px #000;\n          box-shadow: 0 0 5px -3px #000;\n  background: rgba(64, 116, 180, .7);\n}\n.vm-ruler__guide-x.is-solid {\n  border-left: 1px solid rgba(0, 173, 255, .84);\n}\n.vm-ruler__guide-y {\n  -webkit-transform: rotate(-90deg);\n      -ms-transform: rotate(-90deg);\n          transform: rotate(-90deg);\n  -webkit-transform-origin: 0 100% 0;\n      -ms-transform-origin: 0 100% 0;\n          transform-origin: 0 100% 0;\n  position: absolute;\n  width: 100vw;\n  top: 20px;\n  border-bottom: 1px dashed rgba(0, 173, 255, .84);\n  padding-bottom: 5px;\n  cursor: ns-resize;\n}\n.vm-ruler__guide-y > span {\n  -webkit-transform: rotate(90deg);\n      -ms-transform: rotate(90deg);\n          transform: rotate(90deg);\n  -webkit-transform-origin: 0 0 0;\n      -ms-transform-origin: 0 0 0;\n          transform-origin: 0 0 0;\n  position: absolute;\n  left: 25px;\n  top: 5px;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  color: #fff;\n  padding: 0 4px;\n  line-height: 20px;\n  border-radius: 1px;\n  -webkit-box-shadow: 0 0 5px -3px #000;\n          box-shadow: 0 0 5px -3px #000;\n  background: rgba(64, 116, 180, .7);\n}\n.vm-ruler__guide-y.is-solid {\n  border-bottom: 1px solid rgba(0, 173, 255, .84);\n}\n\n/*# sourceMappingURL=ruler.vue.map */",map:{version:3,sources:["ruler.vue","/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/draggable/ruler.vue"],names:[],mappings:"AAAA,gBAAgB;AAChB;;;;EAIE;AACF;;;;;EAKE;AACF;;;;EAIE;AACF;;;;;EAKE;AACF;;;;;;;EAOE;AACF;;;;;;;EAOE;AACF;;;;EAIE;AACF;;EAEE;AACF;;EAEE;AACF;;EAEE;AACF,sBAAsB;AACtB;;;EAGE;AACF;6BAC6B;AAC7B;6BAC6B;AAC7B;6BAC6B;AAC7B;;EAEE;AACF;;;;;EAKE;AACF;;;EAGE;AACF;;;EAGE;AACF;;EAEE;AACF;;EAEE;AACF;ECqUA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,4BAAA;EAAA,6BAAA;EAAA,8BAAA;MAAA,0BAAA;UAAA,sBAAA;EACA,YAAA;EACA,kBAAA;ADnUA;AACA;ECoUA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,kBAAA;EACA,UAAA;ADlUA;AAEA;ECmUA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,YAAA;ADjUA;AAEA;ECkUA,YAAA;EACA,WAAA;EACA,UAAA;ADhUA;AAEA;ECiUA,kCAAA;MAAA,8BAAA;UAAA,0BAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,kBAAA;EACA,iBAAA;AD/TA;AAEA;ECiUA,kBAAA;EACA,MAAA;EACA,OAAA;EACA,WAAA;EACA,YAAA;EACA,mBAAA;EACA,eAAA;EACA,UAAA;AD/TA;AAEA;ECgUA,mBAAA;AD9TA;AAEA;ECiUA,mBAAA;AD/TA;AAEA;ECgUA,mBAAA;AD9TA;AAEA;EC+TA,mBAAA;AD7TA;AAEA;ECiUA,kBAAA;EACA,aAAA;EACA,MAAA;EACA,8CAAA;EACA,iBAAA;EACA,iBAAA;AD/TA;ACgUA;EACA,kBAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,wBAAA;EAAA,+BAAA;MAAA,qBAAA;UAAA,uBAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,yBAAA;KAAA,sBAAA;MAAA,qBAAA;UAAA,iBAAA;EACA,WAAA;EACA,cAAA;EACA,iBAAA;EACA,kBAAA;EACA,qCAAA;UAAA,6BAAA;EACA,kCAzEA;ADrPA;AACA;ECgUA,6CAAA;AD9TA;AAEA;ECkUA,iCAAA;MAAA,6BAAA;UAAA,yBAAA;EACA,kCAAA;MAAA,8BAAA;UAAA,0BAAA;EACA,kBAAA;EACA,YAAA;EACA,SAAA;EACA,gDAAA;EACA,mBAAA;EACA,iBAAA;ADhUA;ACiUA;EACA,gCAAA;MAAA,4BAAA;UAAA,wBAAA;EACA,+BAAA;MAAA,2BAAA;UAAA,uBAAA;EACA,kBAAA;EACA,UAAA;EACA,QAAA;EACA,yBAAA;KAAA,sBAAA;MAAA,qBAAA;UAAA,iBAAA;EACA,WAAA;EACA,cAAA;EACA,iBAAA;EACA,kBAAA;EACA,qCAAA;UAAA,6BAAA;EACA,kCAtGA;ADzNA;AACA;ECiUA,+CAAA;AD/TA;;AAEA,oCAAoC",file:"ruler.vue",sourcesContent:["@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-ruler {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  position: relative;\n}\n.vm-ruler__x {\n  display: flex;\n  position: relative;\n  z-index: 2;\n}\n\n.vm-ruler__wrapper {\n  display: flex;\n  height: 100%;\n}\n\n.vm-ruler__y {\n  height: 100%;\n  width: 20px;\n  z-index: 2;\n}\n\n.vm-ruler__y-rotate {\n  transform-origin: 0 100% 0;\n  display: flex;\n  position: relative;\n  margin-top: -39px;\n}\n\n.vm-ruler__guide {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 20px;\n  height: 20px;\n  background: #efefef;\n  cursor: pointer;\n  z-index: 3;\n}\n\n.vm-ruler__canvas {\n  background: #FAFAFA;\n}\n\n.vm-ruler.is-dark .vm-ruler__canvas {\n  background: #474747;\n}\n\n.vm-ruler.is-dark .vm-ruler__guide {\n  background: #535353;\n}\n\n.vm-ruler.is-dark .vm-ruler__guide {\n  background: #535353;\n}\n\n.vm-ruler__guide-x {\n  position: absolute;\n  height: 100vh;\n  top: 0;\n  border-left: 1px dashed rgba(0, 173, 255, 0.84);\n  padding-left: 5px;\n  cursor: ew-resize;\n}\n.vm-ruler__guide-x > span {\n  position: absolute;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  user-select: none;\n  color: #fff;\n  padding: 0 4px;\n  line-height: 20px;\n  border-radius: 1px;\n  box-shadow: 0 0 5px -3px #000;\n  background: rgba(64, 116, 180, 0.7);\n}\n.vm-ruler__guide-x.is-solid {\n  border-left: 1px solid rgba(0, 173, 255, 0.84);\n}\n\n.vm-ruler__guide-y {\n  transform: rotate(-90deg);\n  transform-origin: 0 100% 0;\n  position: absolute;\n  width: 100vw;\n  top: 20px;\n  border-bottom: 1px dashed rgba(0, 173, 255, 0.84);\n  padding-bottom: 5px;\n  cursor: ns-resize;\n}\n.vm-ruler__guide-y > span {\n  transform: rotate(90deg);\n  transform-origin: 0 0 0;\n  position: absolute;\n  left: 25px;\n  top: 5px;\n  user-select: none;\n  color: #fff;\n  padding: 0 4px;\n  line-height: 20px;\n  border-radius: 1px;\n  box-shadow: 0 0 5px -3px #000;\n  background: rgba(64, 116, 180, 0.7);\n}\n.vm-ruler__guide-y.is-solid {\n  border-bottom: 1px solid rgba(0, 173, 255, 0.84);\n}\n\n/*# sourceMappingURL=ruler.vue.map */",'<template>\n\t<div :class="{ \'is-dark\': isDark }" class="vm-ruler">\n\t\t\x3c!-- 坐标原点，定位 --\x3e\n\t\t<div\n\t\t\t:style="{\n\t\t\t\twidth: `${guideSize}px`,\n\t\t\t\theight: `${guideSize}px`,\n\t\t\t}"\n\t\t\t:title="`单击${showGuide ? \'隐藏\' : \'显示\'}辅助线`"\n\t\t\tclass="vm-ruler__guide"\n\t\t\t@click="showGuide = !showGuide"\n\t\t/>\n\t\t\x3c!-- x轴 --\x3e\n\t\t<div \n\t\t\tref="x"\n\t\t\t:style="{ transform: `translateX(${-scrollLeft}px)` }"\n\t\t\tclass="vm-ruler__x"\n\t\t\t@mousemove="handleShowGuideX"\n\t\t\t@mouseleave="showGuideX = false"\n\t\t>\n\t\t\t<canvas\n\t\t\t\tref="canvasX"\n\t\t\t\t:width="canvasW"\n\t\t\t\t:height="guideSize"\n\t\t\t\tclass="vm-ruler__canvas"\n\t\t\t/>\n\t\t\t\x3c!-- X虚线 --\x3e\n\t\t\t<div\n\t\t\t\tv-show="showGuideX"\n\t\t\t\tref="guideX"\n\t\t\t\t:style="{ left: `${mouseX * scale + placeholderW}px`}"\n\t\t\t\tclass="vm-ruler__guide-x"\n\t\t\t\t@click.stop="handleAddLineX"\n\t\t\t>\n\t\t\t\t<span>\n\t\t\t\t\t{{ mouseX }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t\x3c!-- X实线 --\x3e\n\t\t\t<template v-if="showGuide">\n\t\t\t\t<div\n\t\t\t\t\tv-for="(item, index) in linesX"\n\t\t\t\t\t:key="index"\n\t\t\t\t\t:style="{\n\t\t\t\t\t\tleft: `${item * scale + placeholderW}px`,\n\t\t\t\t\t}"\n\t\t\t\t\ttitle="双击删除参考线"\n\t\t\t\t\tclass="vm-ruler__guide-x is-solid"\n\t\t\t\t\t@mousedown.stop="handleMouseDown(\'x\', index)"\n\t\t\t\t\t@dblclick="linesX.splice(index, 1)"\n\t\t\t\t>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t{{ item }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t\t<div class="vm-ruler__wrapper">\n\t\t\t<div class="vm-ruler__y">\n\t\t\t\t<div\n\t\t\t\t\tref="y"\n\t\t\t\t\t:style="{\n\t\t\t\t\t\ttransform: `rotate(90deg) translateX(${-scrollTop}px)`,\n\t\t\t\t\t}"\n\t\t\t\t\tclass="vm-ruler__y-rotate"\n\t\t\t\t\t@mousemove="handleShowGuideY"\n\t\t\t\t\t@mouseleave="showGuideY = false"\n\t\t\t\t>\n\t\t\t\t\t<canvas\n\t\t\t\t\t\tref="canvasY"\n\t\t\t\t\t\t:width="canvasW"\n\t\t\t\t\t\t:height="guideSize"\n\t\t\t\t\t\tclass="vm-ruler__canvas"\n\t\t\t\t\t/>\n\t\t\t\t\t\n\t\t\t\t\t\x3c!-- Y虚线 --\x3e\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-show="showGuideY"\n\t\t\t\t\t\t:style="{\n\t\t\t\t\t\t\tleft: `${mouseY * scale + placeholderW}px`,\n\t\t\t\t\t\t}"\n\t\t\t\t\t\tclass="vm-ruler__guide-y"\n\t\t\t\t\t\t@click.stop="handleAddLineY"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{{ mouseY }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t\x3c!-- Y实线 --\x3e\n\t\t\t\t\t<template v-if="showGuide">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-for="(item, index) in linesY"\n\t\t\t\t\t\t\t:key="index"\n\t\t\t\t\t\t\t:style="{\n\t\t\t\t\t\t\t\tleft: `${item * scale + placeholderW}px`,\n\t\t\t\t\t\t\t}"\n\t\t\t\t\t\t\tclass="vm-ruler__guide-y is-solid"\n\t\t\t\t\t\t\ttitle="双击删除参考线"\n\t\t\t\t\t\t\t@mousedown.stop="handleMouseDown(\'y\', index)"\n\t\t\t\t\t\t\t@dblclick="linesY.splice(index, 1)"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t{{ item }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<slot />\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { Clipboard } from \'../../../vc\';\nimport { $, debounce } from \'../../../utils/helper\';\n\nconst SCROLL_BAR_WIDTH = 30; // TODO: 计算滚动条宽度\n\nexport default {\n\tname: \'vm-ruler\',\n\tcomponents: {\n\n\t},\n\tprops: {\n\t\tscrollTop: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\tscrollLeft: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\tframeW: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\tframeH: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\tclientW: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\tclientH: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\tscale: {\n\t\t\ttype: Number,\n\t\t\tdefault: 1\n\t\t},\n\t\tguides: Array,\n\t\ttheme: String,\n\t\tborderSize: {\n\t\t\ttype: Object,\n\t\t\tdefault() {\n\t\t\t\treturn {\n\t\t\t\t\ttop: 0,\n\t\t\t\t\tleft: 0,\n\t\t\t\t\tbottom: 0,\n\t\t\t\t\tright: 0\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\t// 辅助线开关区域宽高\n\t\t\tguideSize: 20,\n\n\t\t\t// 是否显示鼠标移动的X/Y轴辅助线 (虚线)\n\t\t\tshowGuide: true,\n\t\t\tshowGuideX: false,\n\t\t\tshowGuideY: false,\n\t\t\t// 鼠标在X/Y轴的坐标\n\t\t\tmouseX: 0,\n\t\t\tmouseY: 0,\n\t\t\t// 横轴起始X/Y位置\n\t\t\toffsetX: 0,\n\t\t\toffsetY: 0,\n\n\t\t\t// X/Y轴辅助线 (实线)\n\t\t\tlinesX: [],\n\t\t\tlinesY: [],\n\n\t\t\tmovingAxias: \'\',\n\t\t\tmovingIndex: -1,\n\t\t};\n\t},\n\tcomputed: {\n\t\t// 刻度的宽度, 5000用于滚动距离避免重绘\n\t\tcanvasW() {\n\t\t\tconst { frameW, frameH, scale, borderSize, guideSize, clientW, clientH } = this;\n\n\t\t\tconst offsetW = borderSize.left + borderSize.right + guideSize;\n\t\t\tconst offsetH = borderSize.top + borderSize.bottom + guideSize;\n\n\t\t\tlet width = Math.max(\n\t\t\t\tframeW * scale + offsetW, \n\t\t\t\tframeH * scale + offsetH, \n\t\t\t\tclientW, \n\t\t\t\tclientH\n\t\t\t);\n\t\t\treturn SCROLL_BAR_WIDTH + width;\n\t\t},\n\t\t// 0刻度距离轴容器左边的距离\n\t\tplaceholderW() {\n\t\t\treturn this.borderSize.left + this.guideSize;\n\t\t},\n\n\t\t// 10刻度间隔(缩放后)\n\t\tinterval() {\n\t\t\treturn 100 * this.scale;\n\t\t},\n\n\t\tisDark() {\n\t\t\treturn this.theme === \'dark\';\n\t\t}\n\t},\n\twatch: {\n\t\tlinesX: {\n\t\t\tdeep: true,\n\t\t\thandler() {\n\t\t\t\tthis.$emit(\'guides-change\', [this.linesX, this.linesY]);\n\t\t\t}\n\t\t},\n\t\tlinesY: {\n\t\t\tdeep: true,\n\t\t\thandler() {\n\t\t\t\tthis.$emit(\'guides-change\', [this.linesX, this.linesY]);\n\t\t\t}\n\t\t}\n\t},\n\n\tcreated() {\n\t\tlet watchArr = [\n\t\t\t\'frameW\', \n\t\t\t\'frameH\', \n\t\t\t\'scale\', \n\t\t\t\'clientW\', \n\t\t\t\'clientH\',\n\t\t\t\'theme\'\n\t\t];\n\n\t\tlet hook = debounce(this.refreshCanvas, 50);\n\n\t\twatchArr.forEach(item => this.$watch(item, hook));\n\t},\n\tmounted() {\n\t\tthis.$nextTick(() => {\n\t\t\tthis.canvas = [this.$refs.canvasX, this.$refs.canvasY];\n\t\t\tthis.offsetX = this.$refs.x.getBoundingClientRect().x;\n\t\t\tthis.offsetY = this.$refs.y.getBoundingClientRect().y;\n\t\t\tthis.refreshCanvas();\n\t\t});\n\t},\n\n\tdestroyed() {\n\t\tthis.operateDOMEvents(\'remove\');\n\t},\n\n\tmethods: {\n\t\trefreshCanvas() {\n\t\t\tthis.canvas.forEach(canvas => this.repaint(canvas));\n\t\t\twindow.canvas = this.canvas;\n\t\t},\n\n\t\t/**\n\t\t * 轴距离容器左边有20px的间距和辅助线开关区域的宽度\n\t\t */\n\t\trepaint(canvas) {\n\t\t\tif (!this._isMounted || !canvas) return;\n\t\t\tlet { canvasW, guideSize, placeholderW, interval, isDark } = this;\n\t\t\tlet ctx = canvas.getContext(\'2d\');\n\t\t\t// 重置画布\n\t\t\tcanvas.height = canvas.height;\n\n\t\t\tctx.beginPath();\n\t\t\tctx.fillStyle = isDark ? \'#474747\' : \'#FAFAFA\';\n\t\t\tctx.fillRect(0, 0, canvasW, guideSize);\n\t\t\tctx.translate(placeholderW, 0); // (20, 0)坐标开始画10刻度线\n\t\t\tctx.fillStyle = isDark ? "#615E5B" : \'#000\';\n\t\t\tctx.save();\n\t\t\tfor (let i = 0; i < canvasW / interval; i++) {\n\t\t\t\t// 画刻度线\n\t\t\t\tctx.fillStyle = isDark ? "#615E5B" : \'#000\';\n\t\t\t\tctx.translate(i * interval, 0);\n\t\t\t\tctx.fillRect(0, 0, 1, guideSize);\n\t\t\t\tctx.restore();\n\t\t\t\tctx.save();\n\t\t\t\t// 返回画刻度数字\n\t\t\t\tctx.fillStyle = "#8C8D89";\n\t\t\t\tctx.font = "12px";\n\t\t\t\t// 文字在轴内的 3/5 位置\n\t\t\t\tctx.fillText(i * 100, i * interval + 4, guideSize / 5 * 3);\n\t\t\t}\n\t\t\t// 还原到 (20, 0)坐标\n\t\t\tctx.restore();\n\t\t\t// 移到 (20, 17)坐标\n\t\t\tctx.translate(0, guideSize - 3);\n\t\t\tctx.save(); // (20, 17)坐标开始画1刻度线\n\t\t\tfor (let i = 0; i < canvasW / interval * 10; i++) {\n\t\t\t\tif (i % 10 !== 0) {\n\t\t\t\t\tctx.translate(i * interval / 10, 0);\n\t\t\t\t\tctx.fillRect(0, 0, 1, 3);\n\t\t\t\t\tctx.restore();\n\t\t\t\t\tctx.save();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 参考X虚线显示\n\t\t */\n\t\thandleShowGuideX(e) {\n\t\t\tconst { offsetX, placeholderW, scrollLeft, scale } = this;\n\t\t\tif (\n\t\t\t\tthis.$refs.x.contains(e.target)\n\t\t\t\t&& !$(e.target).hasClass(\'is-solid\')\n\t\t\t) {\n\t\t\t\tthis.showGuideX = true;\n\t\t\t\tthis.mouseX = Math.floor((e.clientX - offsetX - placeholderW + scrollLeft) / scale);\n\t\t\t} else {\n\t\t\t\tthis.showGuideX = false;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 参考Y虚线显示\n\t\t */\n\t\thandleShowGuideY(e) {\n\t\t\tconst { offsetY, placeholderW, scrollTop, scale } = this;\n\t\t\tif (\n\t\t\t\tthis.$refs.y.contains(e.target) \n\t\t\t\t&& !$(e.target).hasClass(\'is-solid\')\n\t\t\t) {\n\t\t\t\tthis.showGuideY = true;\n\t\t\t\tthis.mouseY = Math.floor((e.clientY - offsetY - placeholderW + scrollTop) / scale);\n\t\t\t} else {\n\t\t\t\tthis.showGuideY = false;\n\t\t\t}\n\t\t},\n\n\t\thandleAddLineX() {\n\t\t\t!this.linesX.includes(this.mouseX) && this.linesX.push(this.mouseX);\n\t\t},\n\n\t\thandleAddLineY() {\n\t\t\t!this.linesY.includes(this.mouseY) && this.linesY.push(this.mouseY);\n\t\t},\n\n\t\toperateDOMEvents(type) {\n\t\t\tlet fn = type === \'add\' \n\t\t\t\t? document.documentElement.addEventListener \n\t\t\t\t: document.documentElement.removeEventListener;\n\n\t\t\tfn(\'mouseup\', this.handleMouseUp);\n\t\t\tfn(\'mousemove\', this.handleMouseMove);\n\t\t},\n\n\t\t// 鼠标按下事件\n\t\thandleMouseDown(axias, index) {\n\t\t\tClipboard.clearSelection();\n\n\t\t\tthis.movingIndex = index;\n\t\t\tthis.movingAxias = axias;\n\n\t\t\tthis.operateDOMEvents(\'add\');\n\t\t},\n\n\t\t// 鼠标放手事件\n\t\thandleMouseUp() {\n\t\t\tClipboard.clearSelection();\n\t\t\tthis.operateDOMEvents(\'remove\');\n\t\t},\n\n\t\thandleMouseMove(e) {\n\t\t\tconst { offsetX, offsetY, placeholderW, scrollLeft, scrollTop, scale } = this;\n\t\t\tif (this.movingAxias === \'x\') {\n\t\t\t\tthis.$set(\n\t\t\t\t\tthis.linesX, \n\t\t\t\t\tthis.movingIndex, \n\t\t\t\t\tMath.floor((e.clientX - offsetX - placeholderW + scrollLeft) / scale),\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tif (this.movingAxias === \'y\') {\n\t\t\t\tthis.$set(\n\t\t\t\t\tthis.linesY, \n\t\t\t\t\tthis.movingIndex, \n\t\t\t\t\tMath.floor((e.clientY - offsetY - placeholderW + scrollTop) / scale),\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t},\n\t},\n};\n<\/script>\n\n<style lang="scss">\n@import "../../../style/index.scss";\n\n$block: vm-ruler;\n$blue-guide: rgba(0, 173, 255, .84);\n$blue-label: rgba(64, 116, 180, .7);\n\n@include block($block) {\n\tdisplay: flex; \n\tflex-direction: column;\n\theight: 100%;\n\tposition: relative;\n\t@include element(x) {\n\t\tdisplay: flex; \n\t\tposition: relative;\n\t\tz-index: 2;\n\t}\n\t@include element(wrapper) {\n\t\tdisplay: flex; \n\t\theight: 100%\n\t}\n\t@include element(y) {\n\t\theight: 100%; \n\t\twidth: 20px;\n\t\tz-index: 2;\n\t}\n\t@include element(y-rotate) {\n\t\ttransform-origin: 0 100% 0;\n\t\tdisplay: flex;\n\t\tposition: relative;\n\t\tmargin-top: -39px;\n\t}\n\n\t@include element(guide) {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\twidth: 20px;\n\t\theight: 20px;\n\t\tbackground: $theme-light-bg; \n\t\tcursor: pointer;\n\t\tz-index: 3;\n\t}\n\t@include element(canvas) {\n\t\tbackground: $theme-light-ruler-bg;\n\t}\n\n\t@include when(dark) {\n\t\t@include element(canvas) {\n\t\t\tbackground: $theme-dark-ruler-bg;\n\t\t}\n\t\t@include element(guide) {\n\t\t\tbackground: $theme-dark-guide-bg;\n\t\t}\n\t\t@include element(guide) {\n\t\t\tbackground: $theme-dark-guide-bg; \n\t\t}\n\t}\n}\n\n@include block(vm-ruler__guide-x) {\n\tposition: absolute;\n\theight: 100vh;\n\ttop: 0;\n\tborder-left: 1px dashed $blue-guide;\n\tpadding-left: 5px;\n\tcursor: ew-resize;\n\t> span {\n\t\tposition: absolute;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tuser-select: none;\n\t\tcolor: #fff;\n\t\tpadding: 0 4px;\n\t\tline-height: 20px;\n\t\tborder-radius: 1px;\n\t\tbox-shadow: 0 0 5px -3px #000;\n\t\tbackground: $blue-label;\n\t}\n\t@include when(solid) {\n\t\tborder-left: 1px solid $blue-guide;\n\t}\n}\n\n\n@include block(vm-ruler__guide-y) {\n\ttransform: rotate(-90deg);\n\ttransform-origin: 0 100% 0;\n\tposition: absolute;\n\twidth: 100vw;\n\ttop: 20px;\n\tborder-bottom: 1px dashed $blue-guide;\n\tpadding-bottom: 5px;\n\tcursor: ns-resize;\n\t> span {\n\t\ttransform: rotate(90deg);\n\t\ttransform-origin: 0 0 0;\n\t\tposition: absolute;\n\t\tleft: 25px;\n\t\ttop: 5px;\n\t\tuser-select: none;\n\t\tcolor: #fff;\n\t\tpadding: 0 4px;\n\t\tline-height: 20px;\n\t\tborder-radius: 1px;\n\t\tbox-shadow: 0 0 5px -3px #000;\n\t\tbackground: $blue-label;\n\t}\n\t@include when(solid) {\n\t\tborder-bottom: 1px solid $blue-guide;\n\t}\n}\n\n</style>\n']},media:void 0})}),Ut,void 0,!1,void 0,!1,R,void 0,void 0);function Xt(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}var Pt={name:"vm-frame-inner",components:{"vm-ruler":Yt},props:function(t){for(var n=arguments,e=1;e<arguments.length;e++){var r=null!=n[e]?n[e]:{};e%2?Xt(r,!0).forEach((function(n){s(t,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Xt(r).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}({showRuler:Boolean},Yt.props),mounted:function(){w.Resize.on(this.$el,this.handleResize)},destroyed:function(){w.Resize.off(this.$el,this.handleResize)},methods:{handleResize:o.throttle((function(t){if(this.$el){var n=+(this.$refs.ruler&&this.$refs.ruler.guideSize+2),e=this.$el.offsetWidth-n,r=this.$el.offsetHeight-n;e&&r&&this.$emit("client-resize",e,r)}}),50)}},Lt=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-frame-draggable--inner",class:{"is-hide-border":!t.showRuler}},[t.showRuler?e("vm-ruler",{ref:"ruler",attrs:{"scroll-left":t.scrollLeft,"scroll-top":t.scrollTop,"frame-w":t.frameW,"frame-h":t.frameH,"client-w":t.clientW,"client-h":t.clientH,scale:t.scale,guides:t.guides,theme:t.theme,"border-size":t.borderSize},on:{"guides-change":function(n){return t.$emit("update:guides",arguments[0])}}},[t._t("content")],2):t._t("content"),t._v(" "),t._t("content-extra"),t._v(" "),t._t("footer")],2)};Lt._withStripped=!0;var jt=N({render:Lt,staticRenderFns:[]},(function(t){t&&t("data-v-766c2978_0",{source:"@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-frame-draggable--inner {\n  -webkit-box-flex: 1;\n  -webkit-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  overflow: hidden;\n  background: #d9d9d9;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  position: relative;\n  border-left: 1px solid #BDBDBD;\n}\n.vm-frame-draggable--inner.is-hide-border {\n  border-left: none;\n  border-right: none;\n}\n\n/*# sourceMappingURL=inner.vue.map */",map:{version:3,sources:["inner.vue","/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/draggable/inner.vue"],names:[],mappings:"AAAA,gBAAgB;AAChB;;;;EAIE;AACF;;;;;EAKE;AACF;;;;EAIE;AACF;;;;;EAKE;AACF;;;;;;;EAOE;AACF;;;;;;;EAOE;AACF;;;;EAIE;AACF;;EAEE;AACF;;EAEE;AACF;;EAEE;AACF,sBAAsB;AACtB;;;EAGE;AACF;6BAC6B;AAC7B;6BAC6B;AAC7B;6BAC6B;ACG7B;;EAAA;ADCA;;;;;EAKE;AACF;;;EAGE;AACF;;;EAGE;AACF;;EAEE;AACF;;EAEE;AACF;ECjBA,mBAAA;EAAA,eAAA;MAAA,WAAA;UAAA,OAAA;EACA,gBAAA;EACA,mBAAA;EAEA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,4BAAA;EAAA,6BAAA;EAAA,8BAAA;MAAA,0BAAA;UAAA,sBAAA;EACA,kBAAA;EAEA,8BAAA;ADiBA;AACA;EChBA,iBAAA;EACA,kBAAA;ADkBA;;AAEA,oCAAoC",file:"inner.vue",sourcesContent:["@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-frame-draggable--inner {\n  flex: 1;\n  overflow: hidden;\n  background: #d9d9d9;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  border-left: 1px solid #BDBDBD;\n}\n.vm-frame-draggable--inner.is-hide-border {\n  border-left: none;\n  border-right: none;\n}\n\n/*# sourceMappingURL=inner.vue.map */",'<template>\n\t<div :class="{ \'is-hide-border\': !showRuler }" class="vm-frame-draggable--inner">\n\t\t<vm-ruler\n\t\t\tv-if="showRuler"\n\t\t\tref="ruler"\n\t\t\t:scroll-left="scrollLeft"\n\t\t\t:scroll-top="scrollTop"\n\t\t\t:frame-w="frameW"\n\t\t\t:frame-h="frameH"\n\t\t\t:client-w="clientW"\n\t\t\t:client-h="clientH"\n\t\t\t:scale="scale"\n\t\t\t:guides="guides"\n\t\t\t:theme="theme"\n\t\t\t:border-size="borderSize"\n\t\t\t@guides-change="$emit(\'update:guides\', arguments[0])"\n\t\t>\n\t\t\t<slot name="content" />\n\t\t</vm-ruler>\n\t\t<slot v-else name="content" />\n\t\t<slot name="content-extra" />\n\t\t<slot name="footer" />\n\t</div>\n</template>\n\n<script>\nimport Ruler from \'./ruler.vue\';\nimport { Resize } from \'../../../vc\';\nimport { throttle } from \'../../../utils/helper\';\n\nexport default {\n\tname: \'vm-frame-inner\',\n\tcomponents: {\n\t\t\'vm-ruler\': Ruler\n\t},\n\tprops: {\n\t\tshowRuler: Boolean,\n\t\t...Ruler.props,\n\t},\n\tmounted() {\n\t\tResize.on(this.$el, this.handleResize);\n\t},\n\tdestroyed() {\n\t\tResize.off(this.$el, this.handleResize);\n\t},\n\tmethods: {\n\t\thandleResize: throttle(function (e) {\n\t\t\tif (!this.$el) return;\n\n\t\t\t// 2为border描边\n\t\t\tlet offset = +(this.$refs.ruler && (this.$refs.ruler.guideSize + 2));\n\t\t\tlet w = this.$el.offsetWidth - offset;\n\t\t\tlet h = this.$el.offsetHeight - offset;\n\n\t\t\tif (!w || !h) return;\n\t\t\tthis.$emit(\n\t\t\t\t\'client-resize\', \n\t\t\t\tw, \n\t\t\t\th,\n\t\t\t);\n\t\t}, 50),\n\t}\n};\n<\/script>\n\n<style lang="scss">\n@import "../../../style/index.scss";\n\n$block: vm-frame-draggable--inner;\n@include block($block) {\n\tflex: 1;\n\toverflow: hidden;\n\tbackground: $theme-light-frame-bg;\n\t\n\tdisplay: flex; \n\tflex-direction: column;\n\tposition: relative;\n\t\n\tborder-left: 1px solid #BDBDBD;\n\t@include when(hide-border) {\n\t\tborder-left: none; \n\t\tborder-right: none; \n\t}\n}\n</style>']},media:void 0})}),Pt,void 0,!1,void 0,!1,R,void 0,void 0),Ht=[{label:"50%",value:.5},{label:"100%",value:1},{label:"150%",value:1.5},{label:"200%",value:2}],It={name:"vm-zoom-bar",components:{"vc-slider":v,"vc-select":x,"vc-option":E},props:{scale:{type:Number,default:1},theme:String,frameW:{type:Number,default:0},frameH:{type:Number,default:0},clientW:{type:Number,default:0},clientH:{type:Number,default:0},borderSize:{type:Object,default:function(){return{top:0,left:0,bottom:0,right:0}}}},data:function(){return{currentScale:1,currentSelect:1}},computed:{autoScale:function(){var t=this.frameW,n=this.frameH,e=this.clientW,r=this.clientH,i=this.borderSize;return t&&n&&e&&r?Math.min((e-i.left-i.right)/t,(r-i.top-i.bottom)/n,1):1},options:function(){var t=this;return!this.autoScale||Ht.some((function(n){return n.value===t.autoScale}))?Ht:Ht.concat([{label:"自适应",value:this.autoScale}])}},watch:{scale:{immediate:!0,handler:function(t){this.currentScale=t,this.currentPlaceholder=(100*t).toFixed(0)+"%"}}},mounted:function(){setTimeout(this.resetScale,0)},methods:{handleChangeSlider:function(t){this.$emit("update:scale",this.currentScale)},handleChangeSelect:function(t){this.$emit("update:scale",this.currentScale)},resetScale:function(){this.currentScale=this.autoScale,this.$emit("update:scale",this.currentScale)}}},Gt=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-zoom-bar vm-hack-editor"},[e("div",{staticClass:"vm-zoom-bar__wrapper"},[e("vc-select",{staticStyle:{width:"75px"},attrs:{placeholder:t.currentPlaceholder,"portal-class-name":["vm-zoom-bar__select",{"is-dark":"dark"===t.theme}]},on:{change:t.handleChangeSelect},model:{value:t.currentScale,callback:function(n){t.currentScale=n},expression:"currentScale"}},t._l(t.options,(function(n,r){return e("vc-option",{key:r,attrs:{value:n.value}},[t._v("\n\t\t\t\t"+t._s(n.label)+"\n\t\t\t")])})),1),t._v(" "),e("vc-slider",{staticStyle:{width:"160px","margin-left":"16px","margin-right":"15px"},attrs:{step:.01,min:.5,max:2,formatter:function(t){return(100*t).toFixed(0)+"%"}},on:{change:t.handleChangeSlider},model:{value:t.currentScale,callback:function(n){t.currentScale=n},expression:"currentScale"}})],1)])};Gt._withStripped=!0;var qt=N({render:Gt,staticRenderFns:[]},(function(t){t&&t("data-v-6fb2c356_0",{source:"@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-zoom-bar {\n  height: 40px;\n  z-index: 2;\n  background: #efefef;\n  -webkit-box-shadow: 0px -2px 10px 0px rgba(0, 0, 0, .08);\n          box-shadow: 0px -2px 10px 0px rgba(0, 0, 0, .08);\n}\n.vm-zoom-bar__wrapper {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: end;\n  -webkit-justify-content: flex-end;\n      -ms-flex-pack: end;\n          justify-content: flex-end;\n}\n\n/*# sourceMappingURL=zoom-bar.vue.map */",map:{version:3,sources:["zoom-bar.vue","/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/draggable/zoom-bar.vue"],names:[],mappings:"AAAA,gBAAgB;AAChB;;;;EAIE;AACF;;;;;EAKE;AACF;;;;EAIE;AACF;;;;;EAKE;AACF;;;;;;;EAOE;AACF;;;;;;;EAOE;AACF;;;;EAIE;AACF;;EAEE;AACF;;EAEE;AACF;;EAEE;AACF,sBAAsB;AACtB;;;EAGE;AACF;6BAC6B;AAC7B;6BAC6B;AAC7B;6BAC6B;AAC7B;;EAEE;AACF;;;;;EAKE;AC+GF;;;EAAA;AD1GA;;;EAGE;AACF;;EAEE;AACF;;EAEE;AACF;EC0FA,YAAA;EACA,UAAA;EACA,mBAAA;EACA,wDAAA;UAAA,gDAAA;ADxFA;AACA;ECyFA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,qBAAA;EAAA,iCAAA;MAAA,kBAAA;UAAA,yBAAA;ADvFA;;AAEA,uCAAuC",file:"zoom-bar.vue",sourcesContent:["@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-zoom-bar {\n  height: 40px;\n  z-index: 2;\n  background: #efefef;\n  box-shadow: 0px -2px 10px 0px rgba(0, 0, 0, 0.08);\n}\n.vm-zoom-bar__wrapper {\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n}\n\n/*# sourceMappingURL=zoom-bar.vue.map */",'<template>\n\t<div class="vm-zoom-bar vm-hack-editor">\n\t\t<div class="vm-zoom-bar__wrapper">\n\t\t\t<vc-select\n\t\t\t\tv-model="currentScale"\n\t\t\t\t:placeholder="currentPlaceholder"\n\t\t\t\t:portal-class-name="[\'vm-zoom-bar__select\', { \'is-dark\': theme === \'dark\' }]"\n\t\t\t\tstyle="width: 75px"\n\t\t\t\t@change="handleChangeSelect"\n\t\t\t>\n\t\t\t\t<vc-option\n\t\t\t\t\tv-for="(item, index) in options"\n\t\t\t\t\t:value="item.value"\n\t\t\t\t\t:key="index"\n\t\t\t\t>\n\t\t\t\t\t{{ item.label }}\n\t\t\t\t</vc-option>\n\t\t\t</vc-select>\n\t\t\t<vc-slider\n\t\t\t\tv-model="currentScale"\n\t\t\t\t:step="0.01"\n\t\t\t\t:min="0.5"\n\t\t\t\t:max="2"\n\t\t\t\t:formatter="v => (v * 100).toFixed(0) + \'%\'"\n\t\t\t\tstyle="width: 160px; margin-left: 16px; margin-right: 15px;"\n\t\t\t\t@change="handleChangeSlider"\n\t\t\t/>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { Slider, Select, Option } from \'../../../vc\';\n\nconst OPTIONS = [\n\t{\n\t\tlabel: \'50%\',\n\t\tvalue: 0.5\n\t},\n\t{\n\t\tlabel: \'100%\',\n\t\tvalue: 1\n\t},\n\t{\n\t\tlabel: \'150%\',\n\t\tvalue: 1.5\n\t},\n\t{\n\t\tlabel: \'200%\',\n\t\tvalue: 2\n\t}\n];\n\nexport default {\n\tname: \'vm-zoom-bar\',\n\tcomponents: {\n\t\t\'vc-slider\': Slider,\n\t\t\'vc-select\': Select,\n\t\t\'vc-option\': Option\n\t},\n\tprops: {\n\t\tscale: {\n\t\t\ttype: Number,\n\t\t\tdefault: 1\n\t\t},\n\t\ttheme: String,\n\t\tframeW: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tframeH: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tclientW: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tclientH: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tborderSize: {\n\t\t\ttype: Object,\n\t\t\tdefault() {\n\t\t\t\treturn {\n\t\t\t\t\ttop: 0,\n\t\t\t\t\tleft: 0,\n\t\t\t\t\tbottom: 0,\n\t\t\t\t\tright: 0\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tcurrentScale: 1,\n\t\t\tcurrentSelect: 1,\n\t\t};\n\t},\n\tcomputed: {\n\t\tautoScale() {\n\t\t\tlet { frameW, frameH, clientW, clientH, borderSize } = this;\n\t\t\t\n\t\t\tif (!frameW \n\t\t\t\t|| !frameH \n\t\t\t\t|| !clientW \n\t\t\t\t|| !clientH\n\t\t\t) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\treturn Math.min(\n\t\t\t\t(clientW - borderSize.left - borderSize.right) / frameW, \n\t\t\t\t(clientH - borderSize.top - borderSize.bottom) / frameH, \n\t\t\t\t1\n\t\t\t);\n\t\t},\n\n\t\toptions() {\n\t\t\tif (!this.autoScale \n\t\t\t\t|| OPTIONS.some(i => i.value === this.autoScale)\n\t\t\t) {\n\t\t\t\treturn OPTIONS;\n\t\t\t}\n\n\t\t\treturn OPTIONS.concat([\n\t\t\t\t{\n\t\t\t\t\tlabel: \'自适应\',\n\t\t\t\t\tvalue: this.autoScale\n\t\t\t\t}\n\t\t\t]);\n\t\t}\n\t},\n\twatch: {\n\t\tscale: {\n\t\t\timmediate: true,\n\t\t\thandler(v) {\n\t\t\t\tthis.currentScale = v;\n\t\t\t\tthis.currentPlaceholder = (v * 100).toFixed(0) + \'%\';\n\t\t\t}\n\t\t},\n\t\t// 被吐槽， 变化太频繁（宽度变化会影响）\n\t\t// clientW() {\n\t\t// \tsetTimeout(this.resetScale, 0);\n\t\t// }\n\t},\n\tmounted() {\n\t\t/**\n\t\t * 1. 自动调整至最合适的位置\n\t\t * TODO: 考虑初始数据异步的情况\n\t\t */\n\t\tsetTimeout(this.resetScale, 0);\n\t},\n\tmethods: {\n\t\thandleChangeSlider(v) {\n\t\t\tthis.$emit(\'update:scale\', this.currentScale);\n\t\t},\n\t\thandleChangeSelect(v) {\n\t\t\tthis.$emit(\'update:scale\', this.currentScale);\n\t\t},\n\t\tresetScale() {\n\t\t\tthis.currentScale = this.autoScale;\n\t\t\tthis.$emit(\'update:scale\', this.currentScale);\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\n@import "../../../style/index.scss";\n\n$block: vm-zoom-bar;\n@include block($block) { \n\theight: 40px; \n\tz-index: 2;\n\tbackground: $theme-light-zoom-bg;\n\tbox-shadow: 0px -2px 10px 0px rgba(0, 0, 0, 0.08);\n\t@include element(wrapper) {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: flex-end;\n\t}\n}\n</style>\n']},media:void 0})}),It,void 0,!1,void 0,!1,R,void 0,void 0),Kt={name:"vm-thumbnail",components:{},props:{dataSource:{type:Array,default:function(){return[]}},scale:{type:Number,default:1},frameW:{type:Number,default:0},frameH:{type:Number,default:0},clientW:{type:Number,default:0},clientH:{type:Number,default:0},scrollTop:{type:Number,default:0},scrollLeft:{type:Number,default:0},theme:String,borderSize:{type:Object,default:function(){return{top:0,left:0,bottom:0,right:0}}}},data:function(){return{width:192,height:108}},computed:{shrink:function(){var t=this.width,n=this.height,e=this.frameW,r=this.frameH,i=this.borderSize;this.scale;return Math.max((e+i.left+i.right)/t,(r+i.top+i.bottom)/n)},visibleStyle:function(){var t=this.width,n=this.height,e=this.clientW,r=this.clientH,i=this.scale,o=this.shrink,a=this.scrollLeft,s=this.scrollTop,l=Math.min(e/o/i,t),A=Math.min(r/o/i,n),d=a/o/i,m=s/o/i;return{width:"".concat(l,"px"),height:"".concat(A,"px"),left:"".concat(d+l>t?t-l:d,"px"),top:"".concat(m+A>n?n-A:m,"px")}},maxScrollLeft:function(){var t=this.frameW,n=this.clientW,e=this.borderSize;return t*this.scale-n+e.left+e.right},maxScrollTop:function(){var t=this.frameH,n=this.clientH,e=this.borderSize;return t*this.scale-n+e.top+e.bottom}},created:function(){var t=this,n=o.debounce(this.repaint,50);["dataSource","frameW","frameH","scale","clientW","clientH","theme"].forEach((function(e){return t.$watch(e,n,{deep:!0})}))},mounted:function(){this.repaint()},destroyed:function(){this.operateDOMEvents("remove")},methods:{repaint:function(){var t=this.$refs.canvas;if(this._isMounted&&t){var n=this.dataSource,e=this.shrink,r=t.getContext("2d");t.height=t.height,r.beginPath(),r.translate(40/e,40/e),r.save(),n.forEach((function(t){if("page"!==t.module){var n=t.x,i=t.y,o=t.w,a=t.h,s=t.r;r.translate((n+o/2)/e,(i+a/2)/e),r.fillStyle="#DBDBDB",r.rotate(s*Math.PI/180),r.fillRect(-o/2/e,-a/2/e,o/e,a/e),r.restore(),r.save()}}))}},operateDOMEvents:function(t){var n="add"===t?document.documentElement.addEventListener:document.documentElement.removeEventListener;n("mouseup",this.handleMouseUp),n("mousemove",this.handleMouseMove)},handleMouseDown:function(t){y.clearSelection(),this.lastMouseX=t.clientX,this.lastMouseY=t.clientY,this.operateDOMEvents("add")},handleMouseMove:function(t){var n=this.scrollLeft,e=this.scrollTop,r=this.shrink,i=this.scale,o=this.maxScrollLeft,a=this.maxScrollTop,s=t.clientX,l=t.clientY,A=s-this.lastMouseX,d=l-this.lastMouseY;this.lastMouseX=s,this.lastMouseY=l;var m=n+A*r*i,c=e+d*r*i;m>o&&(m=o),c>a&&(c=a),m<0&&(m=0),c<0&&(c=0),this.$emit("scroll",m,c)},handleMouseUp:function(){y.clearSelection(),this.operateDOMEvents("remove")}}},Vt=function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"vm-thumbnail vm-hack-editor"},[n("div",{staticStyle:{position:"relative"}},[n("canvas",{ref:"canvas",attrs:{width:this.width,height:this.height}}),this._v(" "),n("div",{staticClass:"vm-thumbnail__visible",style:this.visibleStyle,on:{mousedown:this.handleMouseDown}})])])};Vt._withStripped=!0;var Jt=N({render:Vt,staticRenderFns:[]},(function(t){t&&t("data-v-1fe09760_0",{source:"@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-thumbnail {\n  position: absolute;\n  bottom: 50px;\n  right: 10px;\n  background: #efefef;\n  border: 1px solid #5495f6;\n  z-index: 2;\n}\n.vm-thumbnail__visible {\n  position: absolute;\n  z-index: 2;\n  border: 1px solid #DBDBDB;\n  background: rgba(68, 68, 68, .5);\n  cursor: move;\n}\n\n/*# sourceMappingURL=thumbnail.vue.map */",map:{version:3,sources:["thumbnail.vue","/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/draggable/thumbnail.vue"],names:[],mappings:"AAAA,gBAAgB;AAChB;;;;EAIE;AACF;;;;;EAKE;AACF;;;;EAIE;AACF;;;;;EAKE;AACF;;;;;;;EAOE;AACF;;;;;;;EAOE;AACF;;;;EAIE;AC4LF;;EAAA;AASA;;EAAA;AAIA;;EAAA;AD/LA,sBAAsB;AACtB;;;EAGE;AACF;6BAC6B;AAC7B;6BAC6B;AAC7B;6BAC6B;AAC7B;;EAEE;AACF;;;;;EAKE;AACF;;;EAGE;AACF;;;EAGE;AACF;;EAEE;AACF;;EAEE;AACF;ECkJA,kBAAA;EACA,YAAA;EACA,WAAA;EACA,mBAAA;EACA,yBAAA;EACA,UAAA;ADhJA;AACA;ECiJA,kBAAA;EACA,UAAA;EACA,yBAAA;EACA,gCAAA;EACA,YAAA;AD/IA;;AAEA,wCAAwC",file:"thumbnail.vue",sourcesContent:["@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-thumbnail {\n  position: absolute;\n  bottom: 50px;\n  right: 10px;\n  background: #efefef;\n  border: 1px solid #5495f6;\n  z-index: 2;\n}\n.vm-thumbnail__visible {\n  position: absolute;\n  z-index: 2;\n  border: 1px solid #DBDBDB;\n  background: rgba(68, 68, 68, 0.5);\n  cursor: move;\n}\n\n/*# sourceMappingURL=thumbnail.vue.map */","<template>\n\t<div class=\"vm-thumbnail vm-hack-editor\">\n\t\t<div style=\"position: relative;\">\n\t\t\t<canvas\n\t\t\t\tref=\"canvas\"\n\t\t\t\t:width=\"width\"\n\t\t\t\t:height=\"height\"\n\t\t\t/>\n\t\t\t<div\n\t\t\t\t:style=\"visibleStyle\"\n\t\t\t\tclass=\"vm-thumbnail__visible\"\n\t\t\t\t@mousedown=\"handleMouseDown\"\n\t\t\t/>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { Clipboard } from '../../../vc';\nimport { debounce } from '../../../utils/helper';\n\nexport default {\n\tname: 'vm-thumbnail',\n\tcomponents: {\n\n\t},\n\tprops: {\n\t\tdataSource: {\n\t\t\ttype: Array,\n\t\t\tdefault() {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t},\n\n\t\tscale: {\n\t\t\ttype: Number,\n\t\t\tdefault: 1\n\t\t},\n\n\t\tframeW: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tframeH: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tclientW: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tclientH: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tscrollTop: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tscrollLeft: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\ttheme: String,\n\t\tborderSize: {\n\t\t\ttype: Object,\n\t\t\tdefault() {\n\t\t\t\treturn {\n\t\t\t\t\ttop: 0,\n\t\t\t\t\tleft: 0,\n\t\t\t\t\tbottom: 0,\n\t\t\t\t\tright: 0\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\twidth: 192,\n\t\t\theight: 108\n\t\t};\n\t},\n\tcomputed: {\n\t\tshrink() {\n\t\t\tconst { width, height, frameW, frameH, borderSize, scale } = this;\n\t\t\treturn Math.max(\n\t\t\t\t(frameW + borderSize.left + borderSize.right) / width,\n\t\t\t\t(frameH + borderSize.top + borderSize.bottom) / height\n\t\t\t);\n\t\t},\n\t\tvisibleStyle() {\n\t\t\tconst { width, height, clientW, clientH, scale, shrink, scrollLeft, scrollTop } = this;\n\n\t\t\tlet visibleW = Math.min(clientW / shrink / scale, width);\n\t\t\tlet visibleH = Math.min(clientH / shrink / scale, height);\n\t\t\tlet left = scrollLeft / shrink / scale;\n\t\t\tlet top = scrollTop / shrink / scale;\n\n\t\t\treturn {\n\t\t\t\twidth: `${visibleW}px`,\n\t\t\t\theight: `${visibleH}px`,\n\t\t\t\tleft: `${left + visibleW > width ? width - visibleW : left}px`,\n\t\t\t\ttop: `${top + visibleH > height ? height - visibleH : top}px`\n\t\t\t};\n\t\t},\n\t\tmaxScrollLeft() {\n\t\t\tconst { frameW, clientW, borderSize, scale } = this;\n\t\t\treturn frameW * scale - clientW + borderSize.left + borderSize.right;\n\t\t},\n\t\tmaxScrollTop() {\n\t\t\tconst { frameH, clientH, borderSize, scale } = this;\n\t\t\treturn frameH * scale - clientH + borderSize.top + borderSize.bottom;\n\t\t}\n\t},\n\n\tcreated() {\n\t\tlet watchArr = [\n\t\t\t'dataSource',\n\t\t\t'frameW', \n\t\t\t'frameH', \n\t\t\t'scale', \n\t\t\t'clientW', \n\t\t\t'clientH',\n\t\t\t'theme'\n\t\t];\n\t\tlet hook = debounce(this.repaint, 50);\n\t\t\n\t\twatchArr.forEach(item => this.$watch(item, hook, { deep: true }));\n\t},\n\n\tmounted() {\n\t\tthis.repaint();\n\t},\n\n\tdestroyed() {\n\t\tthis.operateDOMEvents('remove');\n\t},\n\n\tmethods: {\n\t\trepaint() {\n\t\t\tlet canvas = this.$refs.canvas;\n\n\t\t\tif (!this._isMounted || !canvas) return;\n\n\t\t\tlet { dataSource, shrink } = this;\n\t\t\tlet ctx = canvas.getContext('2d');\n\n\t\t\tcanvas.height = canvas.height; // 重设高度，清空画布\n\n\t\t\tctx.beginPath();\n\t\t\tctx.translate(40 / shrink, 40 / shrink);\n\t\t\tctx.save();\n\t\t\tdataSource.forEach(item => {\n\t\t\t\tif (item.module === 'page') return;\n\n\t\t\t\tlet { x, y, w, h, r } = item;\n\t\t\t\tctx.translate(\n\t\t\t\t\t(x + w / 2) / shrink,\n\t\t\t\t\t(y + h / 2) / shrink\n\t\t\t\t);\n\t\t\t\tctx.fillStyle = '#DBDBDB';\n\t\t\t\tctx.rotate(r * Math.PI / 180);\n\t\t\t\tctx.fillRect(\n\t\t\t\t\t-w / 2 / shrink,\n\t\t\t\t\t-h / 2 / shrink,\n\t\t\t\t\tw / shrink,\n\t\t\t\t\th / shrink\n\t\t\t\t);\n\t\t\t\tctx.restore();\n\t\t\t\tctx.save();\n\t\t\t});\n\t\t},\n\n\t\toperateDOMEvents(type) {\n\t\t\tlet fn = type === 'add' \n\t\t\t\t? document.documentElement.addEventListener \n\t\t\t\t: document.documentElement.removeEventListener;\n\n\t\t\tfn('mouseup', this.handleMouseUp);\n\t\t\tfn('mousemove', this.handleMouseMove);\n\t\t},\n\t\thandleMouseDown(e) {\n\t\t\tClipboard.clearSelection();\n\t\t\t\n\t\t\tthis.lastMouseX = e.clientX;\n\t\t\tthis.lastMouseY = e.clientY;\n\n\t\t\tthis.operateDOMEvents('add');\n\t\t},\n\n\t\thandleMouseMove(e) {\n\t\t\tconst { scrollLeft, scrollTop, shrink, scale, maxScrollLeft, maxScrollTop } = this;\n\n\t\t\tlet mouseX = e.clientX;\n\t\t\tlet mouseY = e.clientY;\n\t\t\tlet diffX = mouseX - this.lastMouseX;\n\t\t\tlet diffY = mouseY - this.lastMouseY;\n\n\t\t\tthis.lastMouseX = mouseX;\n\t\t\tthis.lastMouseY = mouseY;\n\n\t\t\tlet x = scrollLeft + diffX * shrink * scale;\n\t\t\tlet y = scrollTop + diffY * shrink * scale;\n\n\t\t\tx > maxScrollLeft && (x = maxScrollLeft);\n\t\t\ty > maxScrollTop && (y = maxScrollTop);\n\n\t\t\t// maxScrollLeft / maxScrollTop 自适应下宽度不够, 计算为零\n\t\t\tx < 0 && (x = 0);\n\t\t\ty < 0 && (y = 0);\n\n\t\t\tthis.$emit('scroll', x, y);\n\t\t},\n\n\t\thandleMouseUp() {\n\t\t\tClipboard.clearSelection();\n\t\t\tthis.operateDOMEvents('remove');\n\t\t}\n\n\t},\n};\n<\/script>\n\n<style lang=\"scss\">\n@import \"../../../style/index.scss\";\n\n$block: vm-thumbnail;\n@include block($block) {\n\tposition: absolute;\n\tbottom: 50px;\n\tright: 10px;\n\tbackground: $theme-light-bg;\n\tborder: 1px solid $primary;\n\tz-index: 2;\n\t@include element(visible) {\n\t\tposition: absolute;\n\t\tz-index: 2;\n\t\tborder: 1px solid #DBDBDB;\n\t\tbackground: rgba(68, 68, 68, 0.5);\n\t\tcursor: move;\n\t}\n}\n</style>\n"]},media:void 0})}),Kt,void 0,!1,void 0,!1,R,void 0,void 0),Zt={name:"vm-right-menu",props:{event:MouseEvent,onSelect:{type:Function,default:function(){return function(){}}}},data:function(){return{visible:!1,wrapHeight:175,menu:Object.keys(K).map((function(t){return K[t]}))}},computed:{top:function(){return window.innerHeight-this.event.clientY<this.wrapHeight?this.event.clientY-this.wrapHeight:this.event.clientY}},mounted:function(){this.visible=!0,this.operateDOMEvents("add")},destroyed:function(){this.operateDOMEvents("remove")},methods:{handleClick:function(t){this.visible=!1,this.onSelect(t),this.$emit("close")},operateDOMEvents:function(t){("add"===t?document.documentElement.addEventListener:document.documentElement.removeEventListener)("click",this.handleDeselect)},handleDeselect:function(t){var n=this;(t.path||t.composedPath()||[]).some((function(t){return t===n.$el||t===n.event.target}))||(this.visible=!1,this.$emit("close"))}}},Qt=new f(Zt,{promise:!1}),tn=Zt,nn=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],ref:"vm-right-menu",staticClass:"vm-right-menu",style:{left:t.event.clientX+"px",top:t.top+"px"}},[e("div",{staticClass:"vm-right-menu__content"},t._l(t.menu,(function(n){return e("span",{key:n,staticClass:"vm-right-menu__item",on:{click:function(e){return t.handleClick(n)},mousedown:function(t){t.stopPropagation()}}},[t._v("\n\t\t\t"+t._s(n)+"\n\t\t")])})),0)])};nn._withStripped=!0;function en(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}N({render:nn,staticRenderFns:[]},(function(t){t&&t("data-v-437944a3_0",{source:".vm-right-menu {\n  position: fixed;\n  z-index: 999;\n  width: 104px;\n  background: #444;\n  padding: 6px 0px;\n  border: 1px solid #47DAFF;\n  border-radius: 4px;\n}\n.vm-right-menu .vm-right-menu__content {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.vm-right-menu .vm-right-menu__content .vm-right-menu__item {\n  height: 32px;\n  width: 100%;\n  line-height: 32px;\n  text-align: center;\n  display: block;\n  color: #fff;\n  cursor: pointer;\n}\n.vm-right-menu .vm-right-menu__content .vm-right-menu__item:hover {\n  background: #343434;\n  color: #16F2F6;\n}\n\n/*# sourceMappingURL=right-menu.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/draggable/right-menu.vue","right-menu.vue"],names:[],mappings:"AA6FA;EACA,eAAA;EACA,YAAA;EACA,YAAA;EACA,gBAAA;EACA,gBAAA;EACA,yBAAA;EACA,kBAAA;AC5FA;AD6FA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,4BAAA;EAAA,6BAAA;EAAA,8BAAA;MAAA,0BAAA;UAAA,sBAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;AC3FA;AD4FA;EACA,YAAA;EACA,WAAA;EACA,iBAAA;EACA,kBAAA;EACA,cAAA;EACA,WAAA;EACA,eAAA;AC1FA;AD2FA;EACA,mBAAA;EACA,cAAA;ACzFA;;AAEA,yCAAyC",file:"right-menu.vue",sourcesContent:["<template>\n\t<div\n\t\tv-show=\"visible\"\n\t\tref=\"vm-right-menu\"\n\t\t:style=\"{\n\t\t\tleft: `${event.clientX}px`,\n\t\t\ttop: `${top}px`\n\t\t}\"\n\t\tclass=\"vm-right-menu\"\n\t>\n\t\t<div class=\"vm-right-menu__content\">\n\t\t\t<span\n\t\t\t\tv-for=\"item in menu\"\n\t\t\t\t:key=\"item\"\n\t\t\t\tclass=\"vm-right-menu__item\"\n\t\t\t\t@click=\"handleClick(item)\"\n\t\t\t\t@mousedown.stop\n\t\t\t>\n\t\t\t\t{{ item }}\n\t\t\t</span>\n\t\t</div>\n\t</div>\n</template>\n<script>\nimport { Portal } from '../../../vc';\nimport { RIGHT_MENU_MAP } from '../../../utils/constants';\nimport { $ } from '../../../utils/helper';\n\nexport const config = {\n\tname: 'vm-right-menu',\n\tprops: {\n\t\tevent: MouseEvent,\n\t\tonSelect: {\n\t\t\ttype: Function,\n\t\t\tdefault() {\n\t\t\t\treturn () => {};\n\t\t\t}\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tvisible: false,\n\t\t\twrapHeight: 175,\n\t\t\tmenu: Object.keys(RIGHT_MENU_MAP).map((key) => RIGHT_MENU_MAP[key])\n\t\t};\n\t},\n\tcomputed: {\n\t\ttop() {\n\t\t\treturn (window.innerHeight - this.event.clientY) < this.wrapHeight\n\t\t\t\t? (this.event.clientY - this.wrapHeight) : this.event.clientY;\n\t\t}\n\t},\n\tmounted() {\n\t\tthis.visible = true;\n\t\tthis.operateDOMEvents('add');\n\t},\n\n\tdestroyed() {\n\t\tthis.operateDOMEvents('remove');\n\t},\n\tmethods: {\n\t\thandleClick(item) {\n\t\t\tthis.visible = false;\n\t\t\tthis.onSelect(item);\n\n\t\t\tthis.$emit('close');\n\t\t},\n\n\t\toperateDOMEvents(type) {\n\t\t\tlet fn = type === 'add' \n\t\t\t\t? document.documentElement.addEventListener \n\t\t\t\t: document.documentElement.removeEventListener;\n\n\t\t\tfn('click', this.handleDeselect);\n\t\t},\n\n\t\thandleDeselect(e) {\n\t\t\tlet path = e.path || e.composedPath() || [];\n\t\t\tlet inArea = path.some(el => el === this.$el || el === this.event.target);\n\n\t\t\tif (!inArea) {\n\t\t\t\tthis.visible = false;\n\t\t\t\tthis.$emit('close');\n\t\t\t}\n\t\t}\n\t},\n};\n\nexport default config;\nexport const RightMenu = new Portal(config, { promise: false });\n\n<\/script>\n<style lang=\"scss\">\n.vm-right-menu {\n\tposition: fixed;\n\tz-index: 999;\n\twidth: 104px;\n\tbackground: #444;\n\tpadding: 6px 0px;\n\tborder: 1px solid #47DAFF;\n\tborder-radius:4px;\n\t.vm-right-menu__content {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\t.vm-right-menu__item {\n\t\t\theight: 32px;\n\t\t\twidth: 100%;\n\t\t\tline-height: 32px;\n\t\t\ttext-align: center;\n\t\t\tdisplay: block;\n\t\t\tcolor: #fff;\n\t\t\tcursor: pointer;\n\t\t\t&:hover {\n\t\t\t\tbackground: #343434;\n\t\t\t\tcolor: #16F2F6;\n\t\t\t}\n\t\t}\n\t}\n}\n</style>\n",".vm-right-menu {\n  position: fixed;\n  z-index: 999;\n  width: 104px;\n  background: #444;\n  padding: 6px 0px;\n  border: 1px solid #47DAFF;\n  border-radius: 4px;\n}\n.vm-right-menu .vm-right-menu__content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n.vm-right-menu .vm-right-menu__content .vm-right-menu__item {\n  height: 32px;\n  width: 100%;\n  line-height: 32px;\n  text-align: center;\n  display: block;\n  color: #fff;\n  cursor: pointer;\n}\n.vm-right-menu .vm-right-menu__content .vm-right-menu__item:hover {\n  background: #343434;\n  color: #16F2F6;\n}\n\n/*# sourceMappingURL=right-menu.vue.map */"]},media:void 0})}),tn,void 0,!1,void 0,!1,R,void 0,void 0);var rn={name:"vm-frame",components:{"vm-draggable":L,"vm-grid-lines":Ft,"vm-align-lines":Wt,"vm-inner":jt,"vm-zoom-bar":qt,"vm-thumbnail":Jt},props:{width:{type:Number,validator:function(t){return t>0}},height:{type:Number,validator:function(t){return t>0}},dataSource:Array,editor:Object,frameStyle:Object,showLines:{type:Boolean,default:!0},showRuler:{type:Boolean,default:!0},showZoomBar:{type:Boolean,default:!0},showThumbnail:{type:Boolean,default:!0},theme:String},data:function(){return{vm:{type:"frame"},scrollLeft:0,scrollTop:0,scale:1,xRuleLines:[],yRuleLines:[],clientW:0,clientH:0,guides:[[],[]]}},computed:{borderSize:function(){var t=this.showRuler?20:0;return{top:t,left:t,bottom:t,right:t}},wrapperStyle:function(){return{paddingTop:"".concat(this.borderSize.top,"px"),paddingLeft:"".concat(this.borderSize.left,"px")}},contentStyle:function(){return{width:"".concat(this.width,"px"),height:"".concat(this.height,"px"),transform:"scale(".concat(this.scale,")"),transformOrigin:"0 0"}},hackStyle:function(){return{width:"".concat(Math.max(this.clientW-this.borderSize.left,this.width*this.scale+this.borderSize.left),"px"),height:"".concat(this.height*this.scale+this.borderSize.bottom,"px")}},classes:function(){return{"is-dark":"dark"===this.theme}}},methods:{handleClientResize:function(t,n){this.$refs.wrapper&&(this.clientW=t,this.clientH=n)},handleScroll:o.throttle((function(t){this.scrollLeft=t.target.scrollLeft,this.scrollTop=t.target.scrollTop}),50),handleScrollThumbnail:function(t,n){this.scrollLeft=t,this.$refs.wrapper.scrollLeft=t,this.scrollTop=n,this.$refs.wrapper.scrollTop=n},handleDrop:function(t){var n=JSON.parse(t.dataTransfer.getData("@wya/vm"))||{},e=n.module,r=n.index,i=this.$parent.$options.modules[e];if(i)if(i.max&&i.max<=this.dataSource.filter((function(t){return t.module===e})).length)this.$emit("error",{type:"create",msg:"当前模块最多只能创建".concat(i.max,"个")});else{var a=this.$refs.content.getBoundingClientRect(),l=a.x,A=a.y,d=t.pageX||t.clientX+document.documentElement.scrollLeft||0,m=t.pageY||t.clientY+document.documentElement.scrollTop||0,c=D(),p=this.dataSource.length,u=function(t){for(var n=arguments,e=1;e<arguments.length;e++){var r=null!=n[e]?n[e]:{};e%2?en(r,!0).forEach((function(n){s(t,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):en(r).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}({},o.cloneDeep("function"==typeof i.data?i.data(r,this.dataSource):i.data),{module:e,id:c});t.fake||!u.draggable&&void 0!==u.draggable?(u.x=0,u.y=0):(u.x=Math.round((d-l)/this.scale),u.y=Math.round((m-A)/this.scale));var h={type:"CREATE",index:p,id:c,data:u};this.$emit("change",h),this.setActived(p)}},handleEnd:function(t,n,e){var r={type:"UPDATE",id:n,index:e,original:t};this.$emit("change",r)},setActived:function(t){var n=this;this.$nextTick((function(){try{n.$refs.draggable[t].setActived()}catch(t){console.error(t)}}))},handleShowMenu:function(t,n){var e=this;if("page"!==n.module){Qt.popup({event:t,onSelect:function(t){var r,i=e.dataSource.slice().filter((function(t){return"page"!==t.module})).reverse().sort((function(t,n){return n.z-t.z})),o=i.findIndex((function(t){return t.id===n.id}));switch(t){case K.TOP:if(0===o)return;r=i[0];break;case K.BOTTOM:if(o===i.length-1)return;r=i[i.length-1];break;case K.UP:if(0===o)return;r=i[o-1];break;case K.DOWN:if(o===i.length-1)return;r=i[o+1];break;case K.DELETE:return void e.$emit("change",{type:"DELETE",id:n.id});default:return}var a={type:"SORT",changed:[e.dataSource.findIndex((function(t){return t.id===n.id})),e.dataSource.findIndex((function(t){return t.id===r.id}))],history:!0};e.$emit("change",a)}})}}}},on=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("vm-inner",{ref:"inner",staticClass:"vm-frame-draggable",class:t.classes,attrs:{"show-ruler":t.showRuler,"scroll-left":t.scrollLeft,"scroll-top":t.scrollTop,"frame-w":t.width,"frame-h":t.height,"client-w":t.clientW,"client-h":t.clientH,scale:t.scale,"border-size":t.borderSize,guides:t.guides,theme:t.theme},on:{"update:guides":function(n){t.guides=n},"client-resize":t.handleClientResize},scopedSlots:t._u([{key:"content",fn:function(){return[e("div",{ref:"wrapper",staticClass:"vm-frame-draggable__wrapper",style:t.wrapperStyle,on:{scroll:t.handleScroll}},[e("div",{style:t.hackStyle},[e("div",{ref:"content",staticClass:"vm-frame-draggable__content",staticStyle:{position:"relative"},style:[t.contentStyle,t.frameStyle],on:{dragover:function(t){t.preventDefault()},drop:t.handleDrop}},[t.showLines?e("vm-grid-lines",{attrs:{width:t.width,height:t.height,grid:[10,10]}}):t._e(),t._v(" "),t.showLines?e("vm-align-lines",{attrs:{"data-source":t.dataSource,editor:t.editor}}):t._e(),t._v(" "),t._l(t.dataSource,(function(n,r){return e("vm-draggable",{key:n.id,ref:"draggable",refInFor:!0,attrs:{x:n.x,y:n.y,z:n.z,w:n.w,h:n.h,r:n.r,module:n.module,parent:n.parent,disabled:n.disabled,handles:n.handles,"min-w":n.minW,"min-h":n.minH,scale:t.scale,grid:n.grid,guides:t.guides,offset:[t.scrollLeft||0,t.scrollTop||0],active:n.active,restrain:n.restrain,closeable:n.closeable||void 0===n.closeable,draggable:n.draggable||void 0===n.draggable,rotatable:n.rotatable||void 0===n.rotatable,resizable:n.resizable||void 0===n.resizable},on:{"update:x":function(e){return t.$set(n,"x",e)},"update:y":function(e){return t.$set(n,"y",e)},"update:z":function(e){return t.$set(n,"z",e)},"update:w":function(e){return t.$set(n,"w",e)},"update:h":function(e){return t.$set(n,"h",e)},"update:r":function(e){return t.$set(n,"r",e)},activated:function(e){return t.$emit("activated",n)},deactivated:function(e){return t.$emit("deactivated",arguments[0],n)},dragging:function(e){return t.$emit("dragging",n)},resizing:function(e){return t.$emit("resizing",n)},rotating:function(e){return t.$emit("rotating",n)},"resize-end":function(e){return t.$emit("resize-end",n)},"drag-end":function(e){return t.$emit("drag-end",n)},delete:function(e){return t.$emit("change",{type:"DELETE",id:n.id})},end:function(e){return t.handleEnd(arguments[0],n.id,r)}},nativeOn:{contextmenu:function(e){return e.preventDefault(),t.handleShowMenu(e,n)}}},[e("vm-"+n.module+"-viewer",t._b({tag:"component",attrs:{index:r,vm:t.vm}},"component",n,!1))],1)}))],2)])])]},proxy:!0},{key:"content-extra",fn:function(){return[t.showThumbnail?e("vm-thumbnail",{class:t.classes,attrs:{"data-source":t.dataSource,scale:t.scale,"frame-w":t.width,"frame-h":t.height,"client-w":t.clientW,"client-h":t.clientH,"scroll-left":t.scrollLeft,"scroll-top":t.scrollTop,"border-size":t.borderSize,theme:t.theme},on:{scroll:t.handleScrollThumbnail}}):t._e()]},proxy:!0},{key:"footer",fn:function(){return[t.showZoomBar?e("vm-zoom-bar",{class:t.classes,attrs:{scale:t.scale,"border-size":t.borderSize,"frame-w":t.width,"frame-h":t.height,"client-w":t.clientW,"client-h":t.clientH,theme:t.theme},on:{"update:scale":function(n){t.scale=n}}}):t._e()]},proxy:!0}])})};on._withStripped=!0;var an=N({render:on,staticRenderFns:[]},(function(t){t&&t("data-v-1a39b3e9_0",{source:"@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-frame-draggable__wrapper {\n  overflow: auto;\n  height: 100%;\n  /**\n   * scrollbar width\n   */\n  /**\n   * scrollbar bg\n   */\n  /**\n   * Handle\n   */\n}\n.vm-frame-draggable__wrapper::-webkit-scrollbar {\n  width: 4px;\n}\n.vm-frame-draggable__wrapper::-webkit-scrollbar:horizontal {\n  height: 4px;\n}\n.vm-frame-draggable__wrapper::-webkit-scrollbar-track {\n  background: rgba(0, 0, 0, 0);\n  z-index: 0;\n}\n.vm-frame-draggable__wrapper::-webkit-scrollbar-thumb {\n  background: rgba(0, 0, 0, .2);\n  border: 1px solid rgba(0, 0, 0, .2);\n}\n.vm-frame-draggable__wrapper::-webkit-scrollbar-corner {\n  background: rgba(0, 0, 0, .2);\n}\n.vm-frame-draggable__content {\n  -webkit-flex-shrink: 0;\n      -ms-flex-negative: 0;\n          flex-shrink: 0;\n  border: 1px solid #d9d9d9;\n  position: relative;\n  overflow: hidden;\n  z-index: 1;\n}\n\n/*# sourceMappingURL=frame.vue.map */",map:{version:3,sources:["frame.vue","/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/draggable/frame.vue"],names:[],mappings:"AAAA,gBAAgB;AAChB;;;;EAIE;AACF;;;;;EAKE;AACF;;;;EAIE;AACF;;;;;EAKE;AACF;;;;;;;EAOE;AACF;;;;;;;EAOE;AACF;;;;EAIE;AACF;;EAEE;AACF;;EAEE;AACF;;EAEE;AACF,sBAAsB;AACtB;;;EAGE;AACF;6BAC6B;AAC7B;6BAC6B;AAC7B;6BAC6B;AAC7B;;EAEE;AACF;;;;;EAKE;AACF;;;EAGE;AACF;;;EAGE;AACF;;EAEE;AACF;;EAEE;AACF;ECkTA,cAAA;EACA,YAAA;EDhTE;;IAEE;EACF;;IAEE;EACF;;IAEE;AACJ;AACA;EACE,UAAU;AACZ;AACA;EACE,WAAW;AACb;AACA;EACE,4BAA4B;EAC5B,UAAU;AACZ;AACA;EACE,6BAA8B;EAC9B,mCAAoC;AACtC;AACA;EACE,6BAA8B;AAChC;AAEA;ECyRA,sBAAA;MAAA,oBAAA;UAAA,cAAA;EACA,yBAAA;EACA,kBAAA;EACA,gBAAA;EACA,UAAA;ADvRA;;AAEA,oCAAoC",file:"frame.vue",sourcesContent:["@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-frame-draggable__wrapper {\n  overflow: auto;\n  height: 100%;\n  /**\n   * scrollbar width\n   */\n  /**\n   * scrollbar bg\n   */\n  /**\n   * Handle\n   */\n}\n.vm-frame-draggable__wrapper::-webkit-scrollbar {\n  width: 4px;\n}\n.vm-frame-draggable__wrapper::-webkit-scrollbar:horizontal {\n  height: 4px;\n}\n.vm-frame-draggable__wrapper::-webkit-scrollbar-track {\n  background: rgba(0, 0, 0, 0);\n  z-index: 0;\n}\n.vm-frame-draggable__wrapper::-webkit-scrollbar-thumb {\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid rgba(0, 0, 0, 0.2);\n}\n.vm-frame-draggable__wrapper::-webkit-scrollbar-corner {\n  background: rgba(0, 0, 0, 0.2);\n}\n\n.vm-frame-draggable__content {\n  flex-shrink: 0;\n  border: 1px solid #d9d9d9;\n  position: relative;\n  overflow: hidden;\n  z-index: 1;\n}\n\n/*# sourceMappingURL=frame.vue.map */",'<template>\n\t<vm-inner\n\t\tref="inner"\n\t\t:show-ruler="showRuler"\n\t\t:scroll-left="scrollLeft"\n\t\t:scroll-top="scrollTop"\n\t\t:frame-w="width"\n\t\t:frame-h="height"\n\t\t:client-w="clientW"\n\t\t:client-h="clientH"\n\t\t:scale="scale"\n\t\t:border-size="borderSize"\n\t\t:guides.sync="guides"\n\t\t:theme="theme"\n\t\t:class="classes"\n\t\tclass="vm-frame-draggable" \n\t\t@client-resize="handleClientResize" \n\t>\n\t\t<template #content>\n\t\t\t<div \n\t\t\t\tref="wrapper" \n\t\t\t\t:style="wrapperStyle"\n\t\t\t\tclass="vm-frame-draggable__wrapper" \n\t\t\t\t@scroll="handleScroll"\n\t\t\t>\n\t\t\t\t<div :style="hackStyle">\n\t\t\t\t\t\x3c!-- 以上仅辅助Frame，所以frameStyle作用在content上 --\x3e\n\t\t\t\t\t<div\n\t\t\t\t\t\tref="content"\n\t\t\t\t\t\t:style="[contentStyle, frameStyle]"\n\t\t\t\t\t\tclass="vm-frame-draggable__content"\n\t\t\t\t\t\tstyle="position: relative;"\n\t\t\t\t\t\t@dragover.prevent\n\t\t\t\t\t\t@drop="handleDrop"\n\t\t\t\t\t>\n\t\t\t\t\t\t<vm-grid-lines v-if="showLines" :width="width" :height="height" :grid="[10, 10]" />\n\t\t\t\t\t\t<vm-align-lines v-if="showLines" :data-source="dataSource" :editor="editor"/>\n\t\t\t\t\t\t\x3c!-- TODO: 不操作引用修改 --\x3e\n\t\t\t\t\t\t<vm-draggable\n\t\t\t\t\t\t\tv-for="(it, index) in dataSource"\n\t\t\t\t\t\t\tref="draggable"\n\t\t\t\t\t\t\t:key="it.id"\n\t\t\t\t\t\t\t:x.sync="it.x"\n\t\t\t\t\t\t\t:y.sync="it.y"\n\t\t\t\t\t\t\t:z.sync="it.z"\n\t\t\t\t\t\t\t:w.sync="it.w"\n\t\t\t\t\t\t\t:h.sync="it.h"\n\t\t\t\t\t\t\t:r.sync="it.r"\n\t\t\t\t\t\t\t:module="it.module"\n\t\t\t\t\t\t\t:parent="it.parent"\n\t\t\t\t\t\t\t:disabled="it.disabled"\n\t\t\t\t\t\t\t:handles="it.handles"\n\t\t\t\t\t\t\t:min-w="it.minW"\n\t\t\t\t\t\t\t:min-h="it.minH"\n\t\t\t\t\t\t\t:scale="scale"\n\t\t\t\t\t\t\t:grid="it.grid"\n\t\t\t\t\t\t\t:guides="guides"\n\t\t\t\t\t\t\t:offset="[scrollLeft || 0, scrollTop || 0]"\n\t\t\t\t\t\t\t:active="it.active"\n\t\t\t\t\t\t\t:restrain="it.restrain"\n\t\t\t\t\t\t\t:closeable="it.closeable || typeof it.closeable === \'undefined\'"\n\t\t\t\t\t\t\t:draggable="it.draggable || typeof it.draggable === \'undefined\'"\n\t\t\t\t\t\t\t:rotatable="it.rotatable || typeof it.rotatable === \'undefined\'"\n\t\t\t\t\t\t\t:resizable="it.resizable || typeof it.resizable === \'undefined\'"\n\t\t\t\t\t\t\t@activated="$emit(\'activated\', it)"\n\t\t\t\t\t\t\t@deactivated="$emit(\'deactivated\', arguments[0], it)"\n\t\t\t\t\t\t\t@dragging="$emit(\'dragging\', it)"\n\t\t\t\t\t\t\t@resizing="$emit(\'resizing\', it)"\n\t\t\t\t\t\t\t@rotating="$emit(\'rotating\', it)"\n\t\t\t\t\t\t\t@resize-end="$emit(\'resize-end\', it)"\n\t\t\t\t\t\t\t@drag-end="$emit(\'drag-end\', it)"\n\t\t\t\t\t\t\t@delete="$emit(\'change\', { type: \'DELETE\', id: it.id })"\n\t\t\t\t\t\t\t@end="handleEnd(arguments[0], it.id, index)"\n\t\t\t\t\t\t\t@contextmenu.prevent.native="handleShowMenu($event, it)"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\x3c!-- vm-type让组件内部处理如何渲染或其他操作 --\x3e\n\t\t\t\t\t\t\t<component\n\t\t\t\t\t\t\t\t:is="`vm-${it.module}-viewer`"\n\t\t\t\t\t\t\t\t:index="index"\n\t\t\t\t\t\t\t\t:vm="vm"\n\t\t\t\t\t\t\t\tv-bind="it"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</vm-draggable>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\t\t<template #content-extra>\n\t\t\t<vm-thumbnail\n\t\t\t\tv-if="showThumbnail"\n\t\t\t\t:data-source="dataSource"\n\t\t\t\t:scale="scale"\n\t\t\t\t:frame-w="width"\n\t\t\t\t:frame-h="height"\n\t\t\t\t:client-w="clientW"\n\t\t\t\t:client-h="clientH"\n\t\t\t\t:scroll-left="scrollLeft"\n\t\t\t\t:scroll-top="scrollTop"\n\t\t\t\t:border-size="borderSize"\n\t\t\t\t:class="classes"\n\t\t\t\t:theme="theme"\n\t\t\t\t@scroll="handleScrollThumbnail"\n\t\t\t/>\n\t\t</template>\t\n\t\t<template #footer>\n\t\t\t<vm-zoom-bar\n\t\t\t\tv-if="showZoomBar"\n\t\t\t\t:scale.sync="scale"\n\t\t\t\t:border-size="borderSize"\n\t\t\t\t:frame-w="width"\n\t\t\t\t:frame-h="height"\n\t\t\t\t:client-w="clientW"\n\t\t\t\t:client-h="clientH"\n\t\t\t\t:class="classes"\n\t\t\t\t:theme="theme"\n\t\t\t/>\n\t\t</template>\n\t</vm-inner>\n</template>\n\n<script>\nimport Draggable from \'../../../base/draggable.vue\';\nimport GridLines from \'./grid-lines.vue\';\nimport AlignLines from \'./align-lines.vue\';\nimport Inner from \'./inner.vue\';\nimport ZoomBar from \'./zoom-bar.vue\';\nimport Thumbnail from \'./thumbnail.vue\';\nimport { RightMenu } from \'./right-menu.vue\';\nimport { getUid, cloneDeep, throttle } from \'../../../utils/helper\';\nimport { WIDGET_TO_FRAME, PAGE_MOULE, RIGHT_MENU_MAP } from \'../../../utils/constants\';\n\nexport default {\n\tname: \'vm-frame\',\n\tcomponents: {\n\t\t\'vm-draggable\': Draggable,\n\t\t\'vm-grid-lines\': GridLines,\n\t\t\'vm-align-lines\': AlignLines,\n\t\t\'vm-inner\': Inner,\n\t\t\'vm-zoom-bar\': ZoomBar,\n\t\t\'vm-thumbnail\': Thumbnail,\n\t},\n\tprops: {\n\t\twidth: {\n\t\t\ttype: Number,\n\t\t\tvalidator: v => v > 0,\n\t\t},\n\t\theight: {\n\t\t\ttype: Number,\n\t\t\tvalidator: v => v > 0,\n\t\t},\n\t\tdataSource: Array,\n\t\teditor: Object,\n\t\tframeStyle: Object,\n\t\tshowLines: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowRuler: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowZoomBar: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowThumbnail: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\ttheme: String,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tvm: {\n\t\t\t\ttype: \'frame\'\n\t\t\t},\n\t\t\tscrollLeft: 0,\n\t\t\tscrollTop: 0,\n\t\t\tscale: 1,\n\t\t\txRuleLines: [],\n\t\t\tyRuleLines: [],\n\n\t\t\t// 容器的宽高\n\t\t\tclientW: 0,\n\t\t\tclientH: 0,\n\n\t\t\t// 参考线\n\t\t\tguides: [[], []]\n\t\t};\n\t},\n\tcomputed: {\n\t\t// 四周留白\n\t\tborderSize() {\n\t\t\tlet size = this.showRuler ? 20 : 0;\n\t\t\treturn {\n\t\t\t\ttop: size,\n\t\t\t\tleft: size,\n\t\t\t\tbottom: size,\n\t\t\t\tright: size\n\t\t\t};\n\t\t},\n\t\twrapperStyle() {\n\t\t\treturn {\n\t\t\t\tpaddingTop: `${this.borderSize.top}px`,\n\t\t\t\tpaddingLeft: `${this.borderSize.left}px`,\n\t\t\t};\n\t\t},\n\t\tcontentStyle() {\n\t\t\treturn {\n\t\t\t\twidth: `${this.width}px`,\n\t\t\t\theight: `${this.height}px`,\n\t\t\t\ttransform: `scale(${this.scale})`,\n\t\t\t\ttransformOrigin: `0 0`,\n\t\t\t};\n\t\t},\n\n\t\thackStyle() {\n\t\t\treturn {\n\t\t\t\twidth: `${Math.max(this.clientW - this.borderSize.left, this.width * this.scale + this.borderSize.left)}px`,\n\t\t\t\theight: `${this.height * this.scale + this.borderSize.bottom}px`\n\t\t\t};\n\t\t},\n\n\t\tclasses() {\n\t\t\treturn {\n\t\t\t\t\'is-dark\': this.theme === \'dark\'\n\t\t\t};\n\t\t}\n\t},\n\tmethods: {\n\t\t/**\n\t\t * 1. 自适应布局\n\t\t * 2. 滚动条最右侧显示（hackStyle）, 容易导致无限计划\n\t\t * tips: vm-combo, width 为auto时，会出现一直计算，直到width小于最大的width\n\t\t */\n\t\thandleClientResize(w, h) {\n\t\t\tif (!this.$refs.wrapper) return;\n\n\t\t\tthis.clientW = w; \n\t\t\tthis.clientH = h; \n\t\t},\n\n\t\thandleScroll: throttle(function (e) {\n\t\t\tthis.scrollLeft = e.target.scrollLeft;\n\t\t\tthis.scrollTop = e.target.scrollTop;\n\t\t}, 50),\n\n\t\thandleScrollThumbnail(x, y) {\n\n\t\t\tthis.scrollLeft = x;\n\t\t\tthis.$refs.wrapper.scrollLeft = x;\n\n\t\t\tthis.scrollTop = y;\n\t\t\tthis.$refs.wrapper.scrollTop = y;\n\t\t},\n\n\t\thandleDrop(e) {\n\t\t\tlet { module, index } = JSON.parse(e.dataTransfer.getData(WIDGET_TO_FRAME)) || {};\n\t\t\tlet result = this.$parent.$options.modules[module];\n\t\t\t// 不存在的模块\n\t\t\tif (!result) return;\n\t\t\tif (result.max && result.max <= this.dataSource.filter(i => i.module === module).length) {\n\t\t\t\tthis.$emit(\'error\', {\n\t\t\t\t\ttype: \'create\',\n\t\t\t\t\tmsg: `当前模块最多只能创建${result.max}个`\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet { x, y } = this.$refs.content.getBoundingClientRect();\n\n\t\t\tlet mouseX = e.pageX || e.clientX + document.documentElement.scrollLeft || 0;\n\t\t\tlet mouseY = e.pageY || e.clientY + document.documentElement.scrollTop || 0;\n\n\t\t\tlet id = getUid();\n\t\t\tlet rowIndex = this.dataSource.length;\n\n\t\t\tlet data = {\n\t\t\t\t...cloneDeep(\n\t\t\t\t\ttypeof result.data === \'function\'\n\t\t\t\t\t\t? result.data(index, this.dataSource)\n\t\t\t\t\t\t: result.data\n\t\t\t\t),\n\t\t\t\tmodule,\n\t\t\t\tid\n\t\t\t};\n\n\t\t\t// 不可拖拽的情况下\n\t\t\tif (!e.fake && (data.draggable || typeof data.draggable === \'undefined\')) {\n\t\t\t\tdata.x = Math.round((mouseX - x) / this.scale);\n\t\t\t\tdata.y = Math.round((mouseY - y) / this.scale);\n\t\t\t} else {\n\t\t\t\tdata.x = 0;\n\t\t\t\tdata.y = 0;\n\t\t\t}\n\n\t\t\tlet action = {\n\t\t\t\ttype: \'CREATE\',\n\t\t\t\tindex: rowIndex,\n\t\t\t\tid,\n\t\t\t\tdata\n\t\t\t};\n\t\t\tthis.$emit(\'change\', action);\n\n\t\t\t// 新元素处于激活状态\n\t\t\tthis.setActived(rowIndex);\n\t\t},\n\t\thandleEnd(original, id, index) {\n\t\t\tlet action = {\n\t\t\t\ttype: \'UPDATE\',\n\t\t\t\tid,\n\t\t\t\tindex,\n\t\t\t\toriginal\n\t\t\t};\n\t\t\tthis.$emit(\'change\', action);\n\t\t},\n\t\t/**\n\t\t * index因为都是最后一个插入\n\t\t * 所以不用像sortable/frame.vue一样做判断\n\t\t */\n\t\tsetActived(index) {\n\t\t\tthis.$nextTick(() => {\n\t\t\t\ttry {\n\t\t\t\t\tthis.$refs.draggable[index].setActived();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\thandleShowMenu(event, it) {\n\t\t\tif (it.module === PAGE_MOULE) return;\n\t\t\tconst onSelect = type => {\n\t\t\t\tlet changed;\n\t\t\t\t// 根据z降序，相等则后面的z放在前面\n\t\t\t\tlet data = this.dataSource\n\t\t\t\t\t.slice()\n\t\t\t\t\t.filter(v => v.module !== PAGE_MOULE)\n\t\t\t\t\t.reverse()\n\t\t\t\t\t.sort((a, b) => b.z - a.z);\n\t\t\t\tlet index = data.findIndex(v => v.id === it.id);\n\n\t\t\t\tconst { TOP, BOTTOM, UP, DOWN, DELETE } = RIGHT_MENU_MAP;\n\t\t\t\tswitch (type) {\n\t\t\t\t\tcase TOP:\n\t\t\t\t\t\tif (index === 0) return;\n\t\t\t\t\t\tchanged = data[0];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase BOTTOM:\n\t\t\t\t\t\tif (index === data.length - 1) return;\n\t\t\t\t\t\tchanged = data[data.length - 1];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase UP:\n\t\t\t\t\t\tif (index === 0) return;\n\t\t\t\t\t\tchanged = data[index - 1];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DOWN:\n\t\t\t\t\t\tif (index === data.length - 1) return;\n\t\t\t\t\t\tchanged = data[index + 1];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DELETE:\n\t\t\t\t\t\tthis.$emit(\'change\', { type: \'DELETE\', id: it.id });\n\t\t\t\t\t\treturn;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet current = this.dataSource.findIndex(v => v.id === it.id);\n\t\t\t\tlet target = this.dataSource.findIndex(v => v.id === changed.id);\n\n\t\t\t\tlet action = {\n\t\t\t\t\ttype: \'SORT\',\n\t\t\t\t\tchanged: [current, target],\n\t\t\t\t\thistory: true\n\t\t\t\t};\n\n\t\t\t\tthis.$emit(\'change\', action);\n\t\t\t};\n\n\n\t\t\t// init\n\t\t\tRightMenu.popup({ event, onSelect });\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\n@import "../../../style/index.scss";\n\n$block: vm-frame-draggable;\n\n@include block($block) {\n\t@include element(wrapper) {\n\t\toverflow: auto;\n\t\theight: 100%; // 兼容无ruler模式\n\t\t@include scroller();\n\t}\n\t@include element(content) {\n\t\t// 不可缩小\n\t\tflex-shrink: 0;\n\t\tborder: 1px solid $border;\n\t\tposition: relative;\n\t\toverflow: hidden;\n\t\tz-index: 1;\n\t}\n}\n</style>\n']},media:void 0})}),rn,void 0,!1,void 0,!1,R,void 0,void 0),sn={name:"vm-frame-inner",props:{hasPage:Boolean}},ln=function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"vm-frame-sortable--inner"},[this._t("content")],2)};ln._withStripped=!0;function An(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}var dn={name:"vm-frame",components:{"vm-sortable":q,"vm-inner":N({render:ln,staticRenderFns:[]},(function(t){t&&t("data-v-641aa406_0",{source:"@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-frame-sortable--inner {\n  -webkit-box-flex: 1;\n  -webkit-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  overflow: auto;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  position: relative;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n\n/*# sourceMappingURL=inner.vue.map */",map:{version:3,sources:["inner.vue","/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/sortable/inner.vue"],names:[],mappings:"AAAA,gBAAgB;AAChB;;;;EAIE;ACcF;;;;;EAAA;ADPA;;;;EAIE;AACF;;;;;EAKE;AACF;;;;;;;EAOE;AACF;;;;;;;EAOE;AACF;;;;EAIE;AACF;;EAEE;AACF;;EAEE;AACF;;EAEE;AACF,sBAAsB;AACtB;;;EAGE;AACF;6BAC6B;AAC7B;6BAC6B;AAC7B;6BAC6B;AAC7B;;EAEE;AACF;;;;;EAKE;AACF;;;EAGE;AACF;;;EAGE;AACF;;EAEE;AACF;;EAEE;AACF;ECnEA,mBAAA;EAAA,eAAA;MAAA,WAAA;UAAA,OAAA;EACA,cAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,kBAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,wBAAA;EAAA,+BAAA;MAAA,qBAAA;UAAA,uBAAA;ADqEA;;AAEA,oCAAoC",file:"inner.vue",sourcesContent:["@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-frame-sortable--inner {\n  flex: 1;\n  overflow: auto;\n  display: flex;\n  position: relative;\n  align-items: center;\n  justify-content: center;\n}\n\n/*# sourceMappingURL=inner.vue.map */",'<template>\n\t<div class="vm-frame-sortable--inner">\n\t\t<slot name="content" />\n\t</div>\n</template>\n\n<script>\nexport default {\n\tname: \'vm-frame-inner\',\n\tprops: {\n\t\thasPage: Boolean\n\t}\n};\n<\/script>\n\n<style lang="scss">\n@import "../../../style/index.scss";\n\n$block: vm-frame-sortable--inner;\n@include block($block) {\n\tflex: 1;\n\toverflow: auto;\n\tdisplay: flex; \n\tposition: relative;\n\talign-items: center;\n\tjustify-content: center;\n}\n</style>']},media:void 0})}),sn,void 0,!1,void 0,!1,R,void 0,void 0)},props:{width:Number,height:Number,dataSource:Array,editor:Object,frameStyle:Object},data:function(){return{dragType:"@wya/vm",dragWaiting:!1,vm:{type:"frame"}}},computed:{style:function(){return{width:this.width?"".concat(this.width,"px"):"auto",height:this.height?"".concat(this.height,"px"):"auto"}},hasPage:function(){return this.dataSource.some((function(t){return"page"===t.module}))}},created:function(){this.timer=null},beforeDestory:function(){clearTimeout(this.timer)},methods:{handleDragEnter:function(t){var n=this;this.timer=setTimeout((function(){n.dragWaiting=!n.$refs.sort||n.$refs.sort.every((function(t){return!1===t.highlight}))}),300)},handleDragLeave:function(t){clearTimeout(this.timer),this.dragWaiting=!1},handleDrop:function(t){clearTimeout(this.timer),this.dragWaiting=!1;var n=this.dataSource.length;this.$refs.sort&&this.$refs.sort.forEach((function(t,e){!0===t.highlight&&(n=t.index+1,t.highlight=!1)}));var e=JSON.parse(t.dataTransfer.getData("@wya/vm"))||{},r=e.module,i=e.index,a=this.$parent.$options.modules[r];if(a)if(a.max&&a.max<=this.dataSource.filter((function(t){return t.module===r})).length)this.$emit("error",{type:"create",msg:"当前模块最多只能创建".concat(a.max,"个")});else{var l=D(),A=function(t){for(var n=arguments,e=1;e<arguments.length;e++){var r=null!=n[e]?n[e]:{};e%2?An(r,!0).forEach((function(n){s(t,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):An(r).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}({},o.cloneDeep("function"==typeof a.data?a.data(i,this.dataSource):a.data),{module:r,id:l});switch(a.insertion){case"first":n=0;break;case"last":n=this.dataSource.length}this.$emit("change",{type:"CREATE",index:n,id:l,data:A}),this.setActived(n)}},setActived:function(t){var n=this;this.$nextTick((function(){try{n.$refs.sort.find((function(n){return n.index===t})).setActived()}catch(t){console.error(t)}}))},handleSorting:function(t){this.$emit("change",{type:"SORT",changed:t,history:!1})},handleSortEnd:function(t){this.$emit("change",{type:"SORT",original:t,history:!0})}}},mn=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("vm-inner",{staticClass:"vm-frame-sortable",attrs:{"has-page":t.hasPage},scopedSlots:t._u([{key:"content",fn:function(){return[e("div",{staticClass:"vm-frame-sortable__wrapper",style:[t.style,t.frameStyle],on:{dragover:function(t){t.preventDefault()},dragenter:t.handleDragEnter,dragleave:t.handleDragLeave,drop:t.handleDrop}},[e("transition-group",{attrs:{tag:"div",name:"flip-list"}},t._l(t.dataSource,(function(n,r){return e("div",{key:n.id,staticClass:"vm-frame-sortable__item"},[e("div",{style:n.wrapperStyle},[e("vm-sortable",{ref:"sort",refInFor:!0,attrs:{index:r,type:t.dragType,disabled:n.disabled,draggable:n.draggable||void 0===n.draggable,closeable:n.closeable||void 0===n.closeable},on:{activated:function(e){return t.$emit("activated",n,r)},deactivated:function(e){return t.$emit("deactivated",n,r)},delete:function(e){return t.$emit("change",{type:"delete",id:n.id})},sorting:t.handleSorting,"sort-end":t.handleSortEnd}},[e("vm-"+n.module+"-viewer",t._b({tag:"component",staticStyle:{"min-height":"3px"},attrs:{index:r,vm:t.vm}},"component",n,!1))],1)],1),t._v(" "),n.placeholder?e("div",{style:{height:n.placeholder+"px"}}):t._e()])})),0)],1)]},proxy:!0}])})};mn._withStripped=!0;var cn={Draggable:an,Sortable:N({render:mn,staticRenderFns:[]},(function(t){t&&t("data-v-0b10ecea_0",{source:"@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-frame-sortable {\n  background: #f7f6fa;\n}\n.vm-frame-sortable__wrapper {\n  -webkit-flex-shrink: 0;\n      -ms-flex-negative: 0;\n          flex-shrink: 0;\n  border: 1px solid #d9d9d9;\n  margin-left: 20px;\n  position: relative;\n  overflow: auto;\n  /**\n   * scrollbar width\n   */\n  /**\n   * scrollbar bg\n   */\n  /**\n   * Handle\n   */\n}\n.vm-frame-sortable__wrapper::-webkit-scrollbar {\n  width: 4px;\n}\n.vm-frame-sortable__wrapper::-webkit-scrollbar:horizontal {\n  height: 4px;\n}\n.vm-frame-sortable__wrapper::-webkit-scrollbar-track {\n  background: rgba(0, 0, 0, 0);\n  z-index: 0;\n}\n.vm-frame-sortable__wrapper::-webkit-scrollbar-thumb {\n  background: rgba(0, 0, 0, .2);\n  border: 1px solid rgba(0, 0, 0, .2);\n}\n.vm-frame-sortable__wrapper::-webkit-scrollbar-corner {\n  background: rgba(0, 0, 0, .2);\n}\n.vm-frame-sortable__item {\n  -webkit-transition: all 0.5s;\n  transition: all 0.5s;\n}\n.flip-list-enter,\n.flip-list-leave-to {\n  opacity: 0;\n}\n.flip-list-leave-active {\n  display: none;\n}\n\n/*# sourceMappingURL=frame.vue.map */",map:{version:3,sources:["frame.vue","/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/sortable/frame.vue"],names:[],mappings:"AAAA,gBAAgB;AAChB;;;;EAIE;AACF;;;;;EAKE;AACF;;;;EAIE;AACF;;;;;EAKE;AACF;;;;;;;EAOE;AACF;;;;;;;EAOE;AACF;;;;EAIE;AC4LF;;EAAA;ADxLA;;EAEE;AACF;;EAEE;AACF,sBAAsB;AACtB;;;EAGE;AACF;6BAC6B;AAC7B;6BAC6B;AAC7B;6BAC6B;AAC7B;;EAEE;AACF;;;;;EAKE;AACF;;;EAGE;AACF;;;EAGE;ACmIF;;EAAA;AD/HA;;EAEE;AACF;ECiIA,mBAAA;AD/HA;AACA;ECgIA,sBAAA;MAAA,oBAAA;UAAA,cAAA;EACA,yBAAA;EACA,iBAAA;EACA,kBAAA;EACA,cAAA;ED9HE;;IAEE;EACF;;IAEE;EACF;;IAEE;AACJ;AACA;EACE,UAAU;AACZ;AACA;EACE,WAAW;AACb;AACA;EACE,4BAA4B;EAC5B,UAAU;AACZ;AACA;EACE,6BAA8B;EAC9B,mCAAoC;AACtC;AACA;EACE,6BAA8B;AAChC;AAEA;ECsGA,4BAAA;EAAA,oBAAA;ADpGA;ACyGA;;EAEA,UAAA;ADtGA;ACwGA;EACA,aAAA;ADrGA;;AAEA,oCAAoC",file:"frame.vue",sourcesContent:["@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-frame-sortable {\n  background: #f7f6fa;\n}\n.vm-frame-sortable__wrapper {\n  flex-shrink: 0;\n  border: 1px solid #d9d9d9;\n  margin-left: 20px;\n  position: relative;\n  overflow: auto;\n  /**\n   * scrollbar width\n   */\n  /**\n   * scrollbar bg\n   */\n  /**\n   * Handle\n   */\n}\n.vm-frame-sortable__wrapper::-webkit-scrollbar {\n  width: 4px;\n}\n.vm-frame-sortable__wrapper::-webkit-scrollbar:horizontal {\n  height: 4px;\n}\n.vm-frame-sortable__wrapper::-webkit-scrollbar-track {\n  background: rgba(0, 0, 0, 0);\n  z-index: 0;\n}\n.vm-frame-sortable__wrapper::-webkit-scrollbar-thumb {\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid rgba(0, 0, 0, 0.2);\n}\n.vm-frame-sortable__wrapper::-webkit-scrollbar-corner {\n  background: rgba(0, 0, 0, 0.2);\n}\n\n.vm-frame-sortable__item {\n  transition: all 0.5s;\n}\n\n.flip-list-enter,\n.flip-list-leave-to {\n  opacity: 0;\n}\n\n.flip-list-leave-active {\n  display: none;\n}\n\n/*# sourceMappingURL=frame.vue.map */",'<template>\n\t<vm-inner :has-page="hasPage" class="vm-frame-sortable">\n\t\t<template #content>\n\t\t\t<div \n\t\t\t\t:style="[style, frameStyle]" \n\t\t\t\tclass="vm-frame-sortable__wrapper"\n\t\t\t\t@dragover.prevent\n\t\t\t\t@dragenter="handleDragEnter"\n\t\t\t\t@dragleave="handleDragLeave"\n\t\t\t\t@drop="handleDrop"\n\t\t\t>\n\t\t\t\t<transition-group tag="div" name="flip-list">\n\t\t\t\t\t<div v-for="(it, index) in dataSource" :key="it.id" class="vm-frame-sortable__item">\n\t\t\t\t\t\t\x3c!-- TODO: 不操作引用修改 --\x3e\n\t\t\t\t\t\t<div :style="it.wrapperStyle">\n\t\t\t\t\t\t\t<vm-sortable\n\t\t\t\t\t\t\t\tref="sort"\n\t\t\t\t\t\t\t\t:index="index"\n\t\t\t\t\t\t\t\t:type="dragType"\n\t\t\t\t\t\t\t\t:disabled="it.disabled"\n\t\t\t\t\t\t\t\t:draggable="it.draggable || typeof it.draggable === \'undefined\'"\n\t\t\t\t\t\t\t\t:closeable="it.closeable || typeof it.closeable === \'undefined\'"\n\t\t\t\t\t\t\t\t@activated="$emit(\'activated\', it, index)"\n\t\t\t\t\t\t\t\t@deactivated="$emit(\'deactivated\', it, index)"\n\t\t\t\t\t\t\t\t@delete="$emit(\'change\', { type: \'delete\', id: it.id })"\n\t\t\t\t\t\t\t\t@sorting="handleSorting"\n\t\t\t\t\t\t\t\t@sort-end="handleSortEnd"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<component \n\t\t\t\t\t\t\t\t\t:is="`vm-${it.module}-viewer`" \n\t\t\t\t\t\t\t\t\t:index="index"\n\t\t\t\t\t\t\t\t\t:vm="vm"\n\t\t\t\t\t\t\t\t\tv-bind="it" \n\t\t\t\t\t\t\t\t\tstyle="min-height: 3px"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</vm-sortable>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-if="it.placeholder" :style="{height: `${it.placeholder}px`}"/>\n\t\t\t\t\t</div>\n\t\t\t\t</transition-group>\n\t\t\t</div>\n\t\t</template>\n\t</vm-inner>\n\t\n</template>\n\n<script>\nimport Inner from \'./inner.vue\';\nimport Sortable from \'../../../base/sortable.vue\';\nimport { getUid, cloneDeep } from \'../../../utils/helper\';\nimport { SORT_IN_FRAME, WIDGET_TO_FRAME, PAGE_MOULE } from \'../../../utils/constants\';\n\nexport default {\n\tname: \'vm-frame\',\n\tcomponents: {\n\t\t\'vm-sortable\': Sortable,\n\t\t\'vm-inner\': Inner,\n\t},\n\tprops: {\n\t\twidth: Number,\n\t\theight: Number,\n\t\tdataSource: Array,\n\t\teditor: Object,\n\t\tframeStyle: Object,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tdragType: SORT_IN_FRAME,\n\t\t\tdragWaiting: false,\n\t\t\tvm: {\n\t\t\t\ttype: \'frame\'\n\t\t\t}\n\t\t};\n\t},\n\tcomputed: {\n\t\tstyle() {\n\t\t\tconst w = !this.width ? \'auto\' : `${this.width}px`;\n\t\t\tconst h = !this.height ? \'auto\' : `${this.height}px`;\n\t\t\treturn {\n\t\t\t\twidth: w,\n\t\t\t\theight: h\n\t\t\t};\n\t\t},\n\t\thasPage() {\n\t\t\treturn this.dataSource.some(i => i.module === PAGE_MOULE);\n\t\t}\n\t},\n\tcreated() {\n\t\tthis.timer = null;\n\t},\n\tbeforeDestory() {\n\t\tclearTimeout(this.timer);\n\t},\n\tmethods: {\n\t\t/**\n\t\t * TODO：\n\t\t * 1. dragWaiting等待时，默认插入到最后一个\n\t\t * 2. 区分是widget还是内部排序\n\t\t */\n\t\thandleDragEnter(e) {\n\t\t\tthis.timer = setTimeout(() => {\n\t\t\t\tthis.dragWaiting = !this.$refs.sort || this.$refs.sort.every(i => i.highlight === false);\n\t\t\t}, 300);\n\t\t},\n\t\thandleDragLeave(e) {\n\t\t\tclearTimeout(this.timer);\n\t\t\tthis.dragWaiting = false;\n\t\t},\n\t\thandleDrop(e) {\n\t\t\tclearTimeout(this.timer);\n\t\t\tthis.dragWaiting = false;\n\n\t\t\tlet rowIndex = this.dataSource.length;\n\t\t\t/**\n\t\t\t * 清理高亮, 设置插入位置\n\t\t\t */\n\t\t\tif (this.$refs.sort) {\n\t\t\t\tthis.$refs.sort.forEach((instance, index) => {\n\t\t\t\t\tif (instance.highlight === true) {\n\t\t\t\t\t\trowIndex = instance.index + 1;\n\t\t\t\t\t\tinstance.highlight = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tlet { module, index } = JSON.parse(e.dataTransfer.getData(WIDGET_TO_FRAME)) || {};\n\t\t\tlet result = this.$parent.$options.modules[module];\n\t\t\t// 不存在的模块\n\t\t\tif (!result) return;\n\n\t\t\tif (result.max && result.max <= this.dataSource.filter(i => i.module === module).length) {\n\t\t\t\tthis.$emit(\'error\', {\n\t\t\t\t\ttype: \'create\',\n\t\t\t\t\tmsg: `当前模块最多只能创建${result.max}个`\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tlet id = getUid();\n\n\t\t\tlet data = {\n\t\t\t\t...cloneDeep(\n\t\t\t\t\ttypeof result.data === \'function\' \n\t\t\t\t\t\t? result.data(index, this.dataSource) \n\t\t\t\t\t\t: result.data\n\t\t\t\t),\n\t\t\t\tmodule,\n\t\t\t\tid,\n\t\t\t};\n\n\t\t\t// 只能插入到第一个位置\n\t\t\tswitch (result.insertion) {\n\t\t\t\tcase \'first\':\n\t\t\t\t\trowIndex = 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \'last\':\n\t\t\t\t\trowIndex = this.dataSource.length;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tthis.$emit(\'change\', { \n\t\t\t\ttype: \'CREATE\', \n\t\t\t\tindex: rowIndex,\n\t\t\t\tid,\n\t\t\t\tdata\n\t\t\t});\n\n\t\t\t// 新元素处于激活状态\n\t\t\tthis.setActived(rowIndex);\n\t\t},\n\n\t\t/**\n\t\t * refs.sort是递增的，和index无关\n\t\t */\n\t\tsetActived(index) {\n\t\t\tthis.$nextTick(() => {\n\t\t\t\ttry {\n\t\t\t\t\tlet target = this.$refs.sort.find(i => i.index === index);\n\t\t\t\t\ttarget.setActived();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * 交换位置\n\t\t */\n\t\thandleSorting(v) {\n\t\t\tthis.$emit(\'change\', {\n\t\t\t\ttype: \'SORT\',\n\t\t\t\tchanged: v,\n\t\t\t\thistory: false\n\t\t\t});\n\t\t},\n\n\n\t\thandleSortEnd(v) {\n\t\t\tthis.$emit(\'change\', {\n\t\t\t\ttype: \'SORT\',\n\t\t\t\toriginal: v,\n\t\t\t\thistory: true\n\t\t\t});\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\n@import "../../../style/index.scss";\n\n$block: vm-frame-sortable;\n\n@include block($block) {\n\tbackground: #f7f6fa;\n\t@include element(wrapper) {\n\t\tflex-shrink: 0;\n\t\tborder: 1px solid $border;\n\t\tmargin-left: 20px;\n\t\tposition: relative;\n\t\toverflow: auto;\n\t\t@include scroller();\n\t}\n\t@include element(item) {\n\t\ttransition: all .5s;\n\t}\n}\n\n// 开始消失/进入的元素\n.flip-list-enter, \n.flip-list-leave-to{\n\topacity: 0;\n}\n.flip-list-leave-active {\n\tdisplay: none;\n}\n</style>\n']},media:void 0})}),dn,void 0,!1,void 0,!1,R,void 0,void 0)},pn={name:"vm-widget",components:{"vc-customer":b,"vm-widget-item":Z},props:{width:Number,height:Number,type:{type:String,default:"free"},dataSource:Array,contentStyle:Object},data:function(){var t=this.$parent.$options.modules,n={},e=0;for(var r in t)if(e++,$(t,r)&&"basic"!==t[r].type){var i=t[r],o=i.type||"undefined";n[o]||(n[o]=[]),(i.showWidget||void 0===i.showWidget)&&n[o].push({module:i.module,component:i.Widget||i.name,widgets:i.widgets,draggable:!(i.widgets||!i.Viewer||!i.Editor),active:!(1!==e||!i.widgets)})}return{toolsList:n,showTip:!0,currentTab:Object.keys(n)[0]}},computed:{style:function(){return{width:0===this.width?"auto":"".concat(this.width,"px"),height:0===this.height?"auto":"".concat(this.height,"px")}}},created:function(){},methods:{handleEvent:function(t){var n=this;return{change:function(){for(var e=arguments,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=e[o];return n.$emit.apply(n,["change",t].concat(i))}}}}},un=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-widget",style:t.style},[e("div",{staticClass:"vm-widget__wrapper"},[e("p",{staticClass:"vm-widget__header"},[t._v("组件库")]),t._v(" "),t.showTip?e("div",{staticClass:"vm-widget__tip"},[e("span",{staticClass:"vm-widget__icon-warn"},[t._v("!")]),t._v(" "),e("p",[t._v("可拖动数据组件到指定位置")]),t._v(" "),e("span",{on:{click:function(n){t.showTip=!t.showTip}}},[t._v("✕")])]):t._e(),t._v(" "),e("div",{staticClass:"vm-widget__menu"},[e("div",{staticClass:"vm-widget__tabs"},t._l(t.toolsList,(function(n,r){return"undefined"!==r?e("p",{key:r,class:{"is-active":t.currentTab==r},on:{click:function(n){t.currentTab=r}}},[t._v(t._s(r))]):t._e()})),0),t._v(" "),e("div",{staticClass:"vm-widget__content",style:t.contentStyle},t._l(t.toolsList[t.currentTab],(function(n){return e("vm-widget-item",{key:n.module,attrs:{draggable:n.draggable,module:n.module}},[e("div",{staticClass:"vm-widget__title",class:{"is-active":n.active,"is-draggable":n.draggable,"is-click":n.widgets},on:{click:function(t){n.widgets&&(n.active=!n.active)}}},["string"==typeof n.component?e("p",{domProps:{innerHTML:t._s(n.component)}}):e("vm-"+n.module+"-widget",t._g({tag:"component"},t.handleEvent(n.module))),t._v(" "),n.widgets?e("div",{staticClass:"vm-widget__arrow"}):t._e()],1),t._v(" "),n.active?e("div",{staticClass:"vm-widget__combo"},t._l(n.widgets,(function(r,i){return e("vm-widget-item",{key:i,staticClass:"vm-widget__item",attrs:{module:n.module,index:i,draggable:""}},[r.render?[e("vc-customer",{attrs:{render:r.render,index:i}})]:[e("img",{attrs:{src:r.image}}),t._v(" "),e("p",[t._v(t._s(r.name))])]],2)})),1):t._e()])})),1)])])])};un._withStripped=!0;var hn=N({render:un,staticRenderFns:[]},(function(t){t&&t("data-v-f3116662_0",{source:"@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-widget {\n  -webkit-box-flex: 0;\n  -webkit-flex: 0 0 284px;\n      -ms-flex: 0 0 284px;\n          flex: 0 0 284px;\n  width: 284px;\n  z-index: 10;\n}\n.vm-widget__wrapper {\n  background: #fff;\n  padding: 10px 0 0;\n  height: 100%;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-align: stretch;\n  -webkit-align-items: stretch;\n      -ms-flex-align: stretch;\n          align-items: stretch;\n}\n.vm-widget__header {\n  font-size: 15px;\n  color: #000;\n  padding: 8px 15px;\n  font-weight: 400;\n}\n.vm-widget__tip {\n  background: #FDF5E8;\n  height: 40px;\n  margin: 2px 9px 15px;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  padding: 0 10px;\n  color: #666;\n  border-radius: 4px;\n  border: none;\n}\n.vm-widget__tip p {\n  -webkit-box-flex: 1;\n  -webkit-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n}\n.vm-widget__tip span {\n  cursor: pointer;\n}\n.vm-widget__icon-warn {\n  width: 14px;\n  height: 14px;\n  background: #EC9C39;\n  border-radius: 100%;\n  color: #fff;\n  font-size: 12px;\n  line-height: 14px;\n  text-align: center;\n  margin-right: 7px;\n}\n.vm-widget__menu {\n  border-top: 1px solid #d9d9d9;\n  overflow-y: auto;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-flex: 1;\n  -webkit-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  -webkit-box-pack: justify;\n  -webkit-justify-content: space-between;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  -webkit-box-align: stretch;\n  -webkit-align-items: stretch;\n      -ms-flex-align: stretch;\n          align-items: stretch;\n  -webkit-flex-wrap: nowrap;\n      -ms-flex-wrap: nowrap;\n          flex-wrap: nowrap;\n}\n.vm-widget__tabs {\n  width: 48px;\n  height: 100%;\n  padding: 0;\n  color: #666;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  line-height: 24px;\n  font-size: 12px;\n  border-right: 1px solid #d9d9d9;\n  -webkit-box-pack: start;\n  -webkit-justify-content: flex-start;\n      -ms-flex-pack: start;\n          justify-content: flex-start;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  /**\n   * scrollbar width\n   */\n  /**\n   * scrollbar bg\n   */\n  /**\n   * Handle\n   */\n}\n.vm-widget__tabs::-webkit-scrollbar {\n  width: 4px;\n}\n.vm-widget__tabs::-webkit-scrollbar:horizontal {\n  height: 4px;\n}\n.vm-widget__tabs::-webkit-scrollbar-track {\n  background: rgba(0, 0, 0, 0);\n  z-index: 0;\n}\n.vm-widget__tabs::-webkit-scrollbar-thumb {\n  background: rgba(0, 0, 0, .2);\n  border: 1px solid rgba(0, 0, 0, .2);\n}\n.vm-widget__tabs::-webkit-scrollbar-corner {\n  background: rgba(0, 0, 0, .2);\n}\n.vm-widget__tabs p {\n  text-align: center;\n  height: 49px;\n  cursor: pointer;\n  line-height: 49px;\n}\n.vm-widget__tabs p.is-active {\n  color: #000000;\n  background-color: #efefef;\n}\n.vm-widget__content {\n  width: 236px;\n  overflow: auto;\n  height: 100%;\n  /**\n   * scrollbar width\n   */\n  /**\n   * scrollbar bg\n   */\n  /**\n   * Handle\n   */\n}\n.vm-widget__content::-webkit-scrollbar {\n  width: 4px;\n}\n.vm-widget__content::-webkit-scrollbar:horizontal {\n  height: 4px;\n}\n.vm-widget__content::-webkit-scrollbar-track {\n  background: rgba(0, 0, 0, 0);\n  z-index: 0;\n}\n.vm-widget__content::-webkit-scrollbar-thumb {\n  background: rgba(0, 0, 0, .2);\n  border: 1px solid rgba(0, 0, 0, .2);\n}\n.vm-widget__content::-webkit-scrollbar-corner {\n  background: rgba(0, 0, 0, .2);\n}\n.vm-widget__title {\n  padding: 15px 12px;\n  font-size: 12px;\n  color: #000;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n  -webkit-justify-content: space-between;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  cursor: pointer;\n  border-bottom: 1px solid #d9d9d9;\n}\n.vm-widget__title.is-draggable {\n  cursor: move;\n}\n.vm-widget__title.is-click {\n  cursor: pointer;\n}\n.vm-widget__title.is-active {\n  color: #5495f6;\n}\n.vm-widget__title.is-active .vm-widget__arrow {\n  -webkit-transform: rotate(-135deg);\n      -ms-transform: rotate(-135deg);\n          transform: rotate(-135deg);\n}\n.vm-widget__arrow {\n  width: 8px;\n  height: 8px;\n  border: 2px solid #d9d9d9;\n  border-top: 0;\n  border-left: 0;\n  -webkit-transform: rotate(45deg);\n      -ms-transform: rotate(45deg);\n          transform: rotate(45deg);\n  -webkit-transition: -webkit-transform 0.2s ease-in-out;\n  transition: -webkit-transform 0.2s ease-in-out;\n  transition: transform 0.2s ease-in-out;\n  transition: transform 0.2s ease-in-out, -webkit-transform 0.2s ease-in-out;\n}\n.vm-widget__combo {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-flex-wrap: wrap;\n      -ms-flex-wrap: wrap;\n          flex-wrap: wrap;\n  width: 100%;\n  border-bottom: 1px solid #d9d9d9;\n  padding: 6px 6px;\n}\n.vm-widget__item {\n  -webkit-box-flex: 0;\n  -webkit-flex: 0 0 50%;\n      -ms-flex: 0 0 50%;\n          flex: 0 0 50%;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  padding: 6px 6px;\n  cursor: move;\n}\n.vm-widget__item img {\n  width: 100%;\n}\n.vm-widget__item p {\n  padding-top: 8px;\n}\n\n/*# sourceMappingURL=widget.vue.map */",map:{version:3,sources:["widget.vue","/Users/deot/Desktop/wya/github/wya-vm/src/combo/widget/widget.vue"],names:[],mappings:"AAAA,gBAAgB;AAChB;;;;EAIE;AACF;;;;;EAKE;AACF;;;;EAIE;AACF;;;;;EAKE;ACgJF;;;;;;;EAAA;AAsBA;;;;;;;EAAA;AAsBA;;;;EAAA;AAqBA;;EAAA;AASA;;EAAA;AAIA;;EAAA;AAUA,sBAAA;AAaA;;;EAAA;ADjNA;6BAC6B;AAC7B;6BAC6B;AAC7B;6BAC6B;AAC7B;;EAEE;AACF;;;;;EAKE;AC+GF;;;EAAA;AAkBA;;;EAAA;AAUA;;EAAA;AD/HA;;EAEE;AACF;ECoEA,mBAAA;EAAA,uBAAA;MAAA,mBAAA;UAAA,eAAA;EACA,YAJA;EAKA,WAAA;ADlEA;AACA;ECmEA,gBAAA;EACA,iBAAA;EACA,YAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,4BAAA;EAAA,6BAAA;EAAA,8BAAA;MAAA,0BAAA;UAAA,sBAAA;EACA,0BAAA;EAAA,4BAAA;MAAA,uBAAA;UAAA,oBAAA;ADjEA;AAEA;ECkEA,eAAA;EACA,WAAA;EACA,iBAAA;EACA,gBAAA;ADhEA;AAEA;ECiEA,mBAAA;EACA,YAAA;EACA,oBAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,eAAA;EACA,WAAA;EACA,kBAAA;EACA,YAAA;AD/DA;ACgEA;EACA,mBAAA;EAAA,eAAA;MAAA,WAAA;UAAA,OAAA;AD9DA;ACgEA;EAEA,eAAA;AD/DA;AAEA;ECiEA,WAAA;EACA,YAAA;EACA,mBAAA;EACA,mBAAA;EACA,WAAA;EACA,eAAA;EACA,iBAAA;EACA,kBAAA;EACA,iBAAA;AD/DA;AAEA;ECgEA,6BAAA;EACA,gBAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,mBAAA;EAAA,eAAA;MAAA,WAAA;UAAA,OAAA;EACA,yBAAA;EAAA,sCAAA;MAAA,sBAAA;UAAA,8BAAA;EACA,0BAAA;EAAA,4BAAA;MAAA,uBAAA;UAAA,oBAAA;EACA,yBAAA;MAAA,qBAAA;UAAA,iBAAA;AD9DA;AAEA;EC+DA,WA7DA;EA8DA,YAAA;EACA,UAAA;EACA,WAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,iBAAA;EACA,eAAA;EACA,+BAAA;EACA,uBAAA;EAAA,mCAAA;MAAA,oBAAA;UAAA,2BAAA;EACA,4BAAA;EAAA,6BAAA;EAAA,8BAAA;MAAA,0BAAA;UAAA,sBAAA;ED7DE;;IAEE;EACF;;IAEE;EACF;;IAEE;AACJ;AACA;EACE,UAAU;AACZ;AACA;EACE,WAAW;AACb;AACA;EACE,4BAA4B;EAC5B,UAAU;AACZ;AACA;EACE,6BAA8B;EAC9B,mCAAoC;AACtC;AACA;EACE,6BAA8B;AAChC;ACqCA;EACA,kBAAA;EACA,YAAA;EACA,eAAA;EACA,iBAAA;ADnCA;ACoCA;EACA,cAAA;EACA,yBAAA;ADlCA;AAEA;ECqCA,YAnFA;EAoFA,cAAA;EACA,YAAA;EDnCE;;IAEE;EACF;;IAEE;EACF;;IAEE;AACJ;AACA;EACE,UAAU;AACZ;AACA;EACE,WAAW;AACb;AACA;EACE,4BAA4B;EAC5B,UAAU;AACZ;AACA;EACE,6BAA8B;EAC9B,mCAAoC;AACtC;AACA;EACE,6BAA8B;AAChC;AAEA;ECYA,kBAAA;EACA,eAAA;EACA,WAAA;EAEA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,yBAAA;EAAA,sCAAA;MAAA,sBAAA;UAAA,8BAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,eAAA;EACA,gCAAA;ADXA;AC3CA;EAwDA,YAAA;ADVA;AC9CA;EA2DA,eAAA;ADTA;AClDA;EA8DA,cAAA;ADRA;ACSA;EACA,kCAAA;MAAA,8BAAA;UAAA,0BAAA;ADPA;AAEA;ECUA,UAAA;EACA,WAAA;EACA,yBAAA;EACA,aAAA;EACA,cAAA;EACA,gCAAA;MAAA,4BAAA;UAAA,wBAAA;EACA,sDAAA;EAAA,8CAAA;EAAA,sCAAA;EAAA,0EAAA;ADRA;AAEA;ECSA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,uBAAA;MAAA,mBAAA;UAAA,eAAA;EACA,WAAA;EACA,gCAAA;EAEA,gBAAA;ADRA;AAEA;ECSA,mBAAA;EAAA,qBAAA;MAAA,iBAAA;UAAA,aAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,4BAAA;EAAA,6BAAA;EAAA,8BAAA;MAAA,0BAAA;UAAA,sBAAA;EACA,gBAAA;EACA,YAAA;ADPA;ACQA;EACA,WAAA;ADNA;ACSA;EACA,gBAAA;ADPA;;AAEA,qCAAqC",file:"widget.vue",sourcesContent:["@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-widget {\n  flex: 0 0 284px;\n  width: 284px;\n  z-index: 10;\n}\n.vm-widget__wrapper {\n  background: #fff;\n  padding: 10px 0 0;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n}\n\n.vm-widget__header {\n  font-size: 15px;\n  color: #000;\n  padding: 8px 15px;\n  font-weight: 400;\n}\n\n.vm-widget__tip {\n  background: #FDF5E8;\n  height: 40px;\n  margin: 2px 9px 15px;\n  display: flex;\n  align-items: center;\n  padding: 0 10px;\n  color: #666;\n  border-radius: 4px;\n  border: none;\n}\n.vm-widget__tip p {\n  flex: 1;\n}\n.vm-widget__tip span {\n  cursor: pointer;\n}\n\n.vm-widget__icon-warn {\n  width: 14px;\n  height: 14px;\n  background: #EC9C39;\n  border-radius: 100%;\n  color: #fff;\n  font-size: 12px;\n  line-height: 14px;\n  text-align: center;\n  margin-right: 7px;\n}\n\n.vm-widget__menu {\n  border-top: 1px solid #d9d9d9;\n  overflow-y: auto;\n  display: flex;\n  flex: 1;\n  justify-content: space-between;\n  align-items: stretch;\n  flex-wrap: nowrap;\n}\n\n.vm-widget__tabs {\n  width: 48px;\n  height: 100%;\n  padding: 0;\n  color: #666;\n  display: flex;\n  line-height: 24px;\n  font-size: 12px;\n  border-right: 1px solid #d9d9d9;\n  justify-content: flex-start;\n  flex-direction: column;\n  /**\n   * scrollbar width\n   */\n  /**\n   * scrollbar bg\n   */\n  /**\n   * Handle\n   */\n}\n.vm-widget__tabs::-webkit-scrollbar {\n  width: 4px;\n}\n.vm-widget__tabs::-webkit-scrollbar:horizontal {\n  height: 4px;\n}\n.vm-widget__tabs::-webkit-scrollbar-track {\n  background: rgba(0, 0, 0, 0);\n  z-index: 0;\n}\n.vm-widget__tabs::-webkit-scrollbar-thumb {\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid rgba(0, 0, 0, 0.2);\n}\n.vm-widget__tabs::-webkit-scrollbar-corner {\n  background: rgba(0, 0, 0, 0.2);\n}\n.vm-widget__tabs p {\n  text-align: center;\n  height: 49px;\n  cursor: pointer;\n  line-height: 49px;\n}\n.vm-widget__tabs p.is-active {\n  color: #000000;\n  background-color: #efefef;\n}\n\n.vm-widget__content {\n  width: 236px;\n  overflow: auto;\n  height: 100%;\n  /**\n   * scrollbar width\n   */\n  /**\n   * scrollbar bg\n   */\n  /**\n   * Handle\n   */\n}\n.vm-widget__content::-webkit-scrollbar {\n  width: 4px;\n}\n.vm-widget__content::-webkit-scrollbar:horizontal {\n  height: 4px;\n}\n.vm-widget__content::-webkit-scrollbar-track {\n  background: rgba(0, 0, 0, 0);\n  z-index: 0;\n}\n.vm-widget__content::-webkit-scrollbar-thumb {\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid rgba(0, 0, 0, 0.2);\n}\n.vm-widget__content::-webkit-scrollbar-corner {\n  background: rgba(0, 0, 0, 0.2);\n}\n\n.vm-widget__title {\n  padding: 15px 12px;\n  font-size: 12px;\n  color: #000;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  cursor: pointer;\n  border-bottom: 1px solid #d9d9d9;\n}\n.vm-widget__title.is-draggable {\n  cursor: move;\n}\n\n.vm-widget__title.is-click {\n  cursor: pointer;\n}\n\n.vm-widget__title.is-active {\n  color: #5495f6;\n}\n.vm-widget__title.is-active .vm-widget__arrow {\n  transform: rotate(-135deg);\n}\n\n.vm-widget__arrow {\n  width: 8px;\n  height: 8px;\n  border: 2px solid #d9d9d9;\n  border-top: 0;\n  border-left: 0;\n  transform: rotate(45deg);\n  transition: transform 0.2s ease-in-out;\n}\n\n.vm-widget__combo {\n  display: flex;\n  flex-wrap: wrap;\n  width: 100%;\n  border-bottom: 1px solid #d9d9d9;\n  padding: 6px 6px;\n}\n\n.vm-widget__item {\n  flex: 0 0 50%;\n  display: flex;\n  align-items: center;\n  flex-direction: column;\n  padding: 6px 6px;\n  cursor: move;\n}\n.vm-widget__item img {\n  width: 100%;\n}\n.vm-widget__item p {\n  padding-top: 8px;\n}\n\n/*# sourceMappingURL=widget.vue.map */",'<template>\n\t<div :style="style" class="vm-widget">\n\t\t<div class="vm-widget__wrapper">\n\t\t\t<p class="vm-widget__header">组件库</p>\n\t\t\t<div v-if="showTip" class="vm-widget__tip">\n\t\t\t\t<span class="vm-widget__icon-warn">!</span>\n\t\t\t\t<p>可拖动数据组件到指定位置</p>\n\t\t\t\t<span @click="showTip = !showTip">✕</span>\n\t\t\t</div>\n\t\t\t<div class="vm-widget__menu">\n\t\t\t\t<div class="vm-widget__tabs">\n\t\t\t\t\t<p\n\t\t\t\t\t\tv-for="(item, key) in toolsList"\n\t\t\t\t\t\tv-if="key !== \'undefined\'"\n\t\t\t\t\t\t:key="key"\n\t\t\t\t\t\t:class="{ \'is-active\': currentTab == key}"\n\t\t\t\t\t\t@click="currentTab = key"\n\t\t\t\t\t>{{ key }}</p>\n\t\t\t\t</div>\n\t\t\t\t<div :style="contentStyle" class="vm-widget__content">\n\t\t\t\t\t<vm-widget-item\n\t\t\t\t\t\tv-for="(it) in toolsList[currentTab]"\n\t\t\t\t\t\t:key="it.module"\n\t\t\t\t\t\t:draggable="it.draggable"\n\t\t\t\t\t\t:module="it.module"\n\t\t\t\t\t>\n\t\t\t\t\t\t\x3c!-- 组件标题 --\x3e\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t:class="{ \'is-active\': it.active, \'is-draggable\': it.draggable, \'is-click\': it.widgets }"\n\t\t\t\t\t\t\tclass="vm-widget__title"\n\t\t\t\t\t\t\t@click="it.widgets && (it.active = !it.active)"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<p v-if="typeof it.component === \'string\'" v-html="it.component"/>\n\t\t\t\t\t\t\t<component v-else :is="`vm-${it.module}-widget`" v-on="handleEvent(it.module)"/>\n\t\t\t\t\t\t\t<div v-if="it.widgets" class="vm-widget__arrow" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\x3c!-- 子元素 --\x3e\n\t\t\t\t\t\t<div v-if="it.active" class="vm-widget__combo">\n\t\t\t\t\t\t\t<vm-widget-item\n\t\t\t\t\t\t\t\tv-for="(widget, index) in it.widgets"\n\t\t\t\t\t\t\t\t:key="index"\n\t\t\t\t\t\t\t\t:module="it.module"\n\t\t\t\t\t\t\t\t:index="index"\n\t\t\t\t\t\t\t\tdraggable\n\t\t\t\t\t\t\t\tclass="vm-widget__item"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<template v-if="widget.render">\n\t\t\t\t\t\t\t\t\t<vc-customer\n\t\t\t\t\t\t\t\t\t\t:render="widget.render"\n\t\t\t\t\t\t\t\t\t\t:index="index"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<img :src="widget.image" >\n\t\t\t\t\t\t\t\t\t<p>{{ widget.name }}</p>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</vm-widget-item>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</vm-widget-item>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport Widget from \'../../base/widget.vue\';\nimport { hasOwn } from \'../../utils/helper\';\nimport { WIDGET_TO_FRAME } from \'../../utils/constants\';\nimport { Customer } from \'../../vc\';\n\nexport default {\n\tname: \'vm-widget\',\n\tcomponents: {\n\t\t\'vc-customer\': Customer,\n\t\t\'vm-widget-item\': Widget,\n\t},\n\tprops: {\n\t\twidth: Number,\n\t\theight: Number,\n\t\ttype: {\n\t\t\ttype: String,\n\t\t\tdefault: \'free\' // sort-list\n\t\t},\n\t\tdataSource: Array,\n\t\tcontentStyle: Object\n\t},\n\tdata() {\n\t\tconst { modules } = this.$parent.$options;\n\t\tlet toolsList = {};\n\t\tlet index = 0;\n\t\tfor (let key in modules) {\n\t\t\tindex++;\n\t\t\t// 过滤页面设置\n\t\t\tif (hasOwn(modules, key) && modules[key].type !== \'basic\') {\n\t\t\t\tlet item = modules[key];\n\t\t\t\tlet type = item.type || \'undefined\';\n\t\t\t\tif (!toolsList[type]) {\n\t\t\t\t\ttoolsList[type] = [];\n\t\t\t\t}\n\t\t\t\tif (item.showWidget || typeof item.showWidget === \'undefined\') {\n\t\t\t\t\ttoolsList[type].push({\n\t\t\t\t\t\tmodule: item.module,\n\t\t\t\t\t\tcomponent: item.Widget || item.name,\n\t\t\t\t\t\twidgets: item.widgets,\n\t\t\t\t\t\t// 最外层拖拽\n\t\t\t\t\t\tdraggable: !!(!item.widgets && item.Viewer && item.Editor),\n\n\t\t\t\t\t\t// 更多, 由click事件控制\n\t\t\t\t\t\tactive: !!(index === 1 && item.widgets)\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\ttoolsList,\n\t\t\tshowTip: true,\n\t\t\tcurrentTab: Object.keys(toolsList)[0]\n\t\t};\n\t},\n\tcomputed: {\n\t\tstyle() {\n\t\t\tconst w = this.width === 0 ? \'auto\' : `${this.width}px`;\n\t\t\tconst h = this.height === 0 ? \'auto\' : `${this.height}px`;\n\n\t\t\treturn {\n\t\t\t\twidth: w,\n\t\t\t\theight: h\n\t\t\t};\n\t\t}\n\t},\n\tcreated() {\n\t\t// console.log(this.$options.modules);\n\t},\n\tmethods: {\n\t\thandleEvent(module) {\n\t\t\treturn {\n\t\t\t\tchange: (...rest) => this.$emit(\'change\', module, ...rest)\n\t\t\t};\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\n@import "../../style/index.scss";\n\n$block: vm-widget;\n$tabs-w: 48px;\n$content-w: 236px;\n$w: $tabs-w + $content-w;\n\n@include block($block) {\n\tflex: 0 0 $w;\n\twidth: $w;\n\tz-index: 10;\n\t@include element(wrapper) {\n\t\tbackground: $white;\n\t\tpadding: 10px 0 0;\n\t\theight: 100%;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: stretch;\n\t}\n\t@include element(header) {\n\t\tfont-size: 15px;\n\t\tcolor: #000;\n\t\tpadding: 8px 15px;\n\t\tfont-weight: 400;\n\t}\n\t@include element(tip) {\n\t\tbackground: #FDF5E8;\n\t\theight: 40px;\n\t\tmargin: 2px 9px 15px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tpadding: 0 10px;\n\t\tcolor: $assit;\n\t\tborder-radius: 4px;\n\t\tborder:none;\n\t\tp {\n\t\t\tflex: 1;\n\t\t}\n\t\tspan {\n\t\t\t// color: $assit;\n\t\t\tcursor: pointer;\n\t\t}\n\t}\n\t@include element(icon-warn) {\n\t\twidth: 14px;\n\t\theight: 14px;\n\t\tbackground: #EC9C39;\n\t\tborder-radius: 100%;\n\t\tcolor: $white;\n\t\tfont-size: 12px;\n\t\tline-height: 14px;\n\t\ttext-align: center;\n\t\tmargin-right: 7px;\n\t}\n\t@include element(menu) {\n\t\tborder-top: 1px solid $border;\n\t\toverflow-y: auto;\n\t\tdisplay: flex;\n\t\tflex:1;\n\t\tjustify-content: space-between;\n\t\talign-items: stretch;\n\t\tflex-wrap: nowrap;\n\t}\n\t@include element(tabs) {\n\t\twidth: $tabs-w;\n\t\theight: 100%;\n\t\tpadding: 0;\n\t\tcolor: $assit;\n\t\tdisplay: flex;\n\t\tline-height: 24px;\n\t\tfont-size: 12px;\n\t\tborder-right: 1px solid $border;\n\t\tjustify-content: flex-start;\n\t\tflex-direction: column;\n\t\t@include scroller();\n\t\tp {\n\t\t\ttext-align: center;\n\t\t\theight: 49px;\n\t\t\tcursor: pointer;\n\t\t\tline-height: 49px;\n\t\t\t&.is-active {\n\t\t\t\tcolor: $black;\n\t\t\t\tbackground-color: $acitved;\n\t\t\t}\n\t\t}\n\t}\n\t@include element(content) {\n\t\twidth: $content-w;\n\t\toverflow: auto;\n\t\theight: 100%;\n\t\t@include scroller();\n\t}\n\n\t@include element(title) {\n\t\tpadding: 15px 12px;\n\t\tfont-size: 12px;\n\t\tcolor: #000;\n\t\t// font-weight: bold;\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tcursor: pointer;\n\t\tborder-bottom: 1px solid $border;\n\t\t@include when(draggable) {\n\t\t\tcursor: move;\n\t\t}\n\t\t@include when(click) {\n\t\t\tcursor: pointer;\n\t\t}\n\t\t@include when(active) {\n\t\t\tcolor: $primary;\n\t\t\t.vm-widget__arrow {\n\t\t\t\ttransform: rotate(-135deg);\n\t\t\t}\n\t\t}\n\t}\n\t@include element(arrow) {\n\t\twidth: 8px;\n\t\theight: 8px;\n\t\tborder: 2px solid $border;\n\t\tborder-top: 0;\n\t\tborder-left: 0;\n\t\ttransform: rotate(45deg);\n\t\ttransition: transform 0.2s ease-in-out;\n\t}\n\t@include element(combo) {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\twidth: 100%;\n\t\tborder-bottom: 1px solid $border;\n\t\t// justify-content: center;\n\t\tpadding: 6px 6px;\n\t}\n\t@include element(item) {\n\t\tflex: 0 0 50%;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tflex-direction: column;\n\t\tpadding: 6px 6px;\n\t\tcursor: move;\n\t\timg {\n\t\t\twidth: 100%;\n\t\t\t// border: 1px dashed $border;\n\t\t}\n\t\tp {\n\t\t\tpadding-top: 8px;\n\t\t}\n\t}\n}\n\n</style>\n']},media:void 0})}),pn,void 0,!1,void 0,!1,R,void 0,void 0),gn={name:"vm-editor",components:{},props:{dataSource:Array,value:Object,width:{type:Number,default:327}},data:function(){return{currentId:this.value.id}},computed:{},watch:{"value.module":{handler:function(t){this.resetCurEditor(this.value.id)}}},methods:{resetCurEditor:o.debounce((function(t){this.currentId=t}),50),handleChange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"===C(t))for(var n in t){var e=t[n];["x","y","z","r","w","h"].includes(n)&&(e=Number(e)),$(t,n)&&!S(e)&&this.$emit("change",{type:"update",id:this.currentId,changed:s({},n,e)})}}}},bn=function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"vm-editor vm-hack-editor",style:{flex:"0 0 "+this.width+"px"}},[n("div",{staticClass:"vm-editor__wrapper"},[n("vm-"+this.value.module+"-editor",this._b({ref:"target",tag:"component",on:{change:this.handleChange}},"component",this.value,!1,!0))],1)])};bn._withStripped=!0;var fn=N({render:bn,staticRenderFns:[]},(function(t){t&&t("data-v-58f8b684_0",{source:"@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-editor {\n  -webkit-flex-shrink: 0;\n      -ms-flex-negative: 0;\n          flex-shrink: 0;\n}\n.vm-editor__wrapper {\n  position: relative;\n  padding: 0;\n  height: 100%;\n  border: 1px solid rgba(0, 0, 0, 0.10196);\n  border-radius: 0px;\n  -webkit-box-shadow: 0 2px 12px rgba(0, 0, 0, .15);\n          box-shadow: 0 2px 12px rgba(0, 0, 0, .15);\n  background: #fff;\n  z-index: 2;\n}\n.vm-editor__arrow {\n  left: -7px;\n  top: 20px;\n  width: 14px;\n  height: 14px;\n  -webkit-transform: translateX(-50%) rotate(45deg);\n      -ms-transform: translateX(-50%) rotate(45deg);\n          transform: translateX(-50%) rotate(45deg);\n  -webkit-box-shadow: -3px 3px 7px rgba(0, 0, 0, .07);\n          box-shadow: -3px 3px 7px rgba(0, 0, 0, .07);\n  background: #fff;\n  -webkit-transform: rotate(45deg);\n      -ms-transform: rotate(45deg);\n          transform: rotate(45deg);\n  position: absolute;\n  border-color: rgba(0, 0, 0, 0);\n  border-style: solid;\n  border-left: 1px solid rgba(0, 0, 0, 0.10196);\n  border-bottom: 1px solid rgba(0, 0, 0, 0.10196);\n}\n\n/*# sourceMappingURL=editor.vue.map */",map:{version:3,sources:["editor.vue","/Users/deot/Desktop/wya/github/wya-vm/src/combo/editor/editor.vue"],names:[],mappings:"AAAA,gBAAgB;AAChB;;;;EAIE;AACF;;;;;EAKE;AACF;;;;EAIE;AACF;;;;;EAKE;AACF;;;;;;;EAOE;AACF;;;;;;;EAOE;AACF;;;;EAIE;AACF;;EAEE;AACF;;EAEE;AACF;;EAEE;AACF,sBAAsB;AACtB;;;EAGE;AACF;6BAC6B;AAC7B;6BAC6B;AAC7B;6BAC6B;AAC7B;;EAEE;AACF;;;;;EAKE;AACF;;;EAGE;AACF;;;EAGE;AACF;;EAEE;AACF;;EAEE;AACF;ECCA,sBAAA;MAAA,oBAAA;UAAA,cAAA;ADCA;ACDA;EAMA,kBAAA;EACA,UAAA;EACA,YAAA;EACA,wCAAA;EACA,kBAAA;EACA,iDAAA;UAAA,yCAAA;EACA,gBAAA;EACA,UAAA;ADFA;ACXA;EAgBA,UAAA;EACA,SAAA;EACA,WAAA;EACA,YAAA;EACA,iDAAA;MAAA,6CAAA;UAAA,yCAAA;EACA,mDAAA;UAAA,2CAAA;EACA,gBAAA;EACA,gCAAA;MAAA,4BAAA;UAAA,wBAAA;EACA,kBAAA;EACA,8BAAA;EACA,mBAAA;EACA,6CAAA;EACA,+CAAA;ADDA;;AAEA,qCAAqC",file:"editor.vue",sourcesContent:["@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n/**\n * TODO: 使用vc-scroller;\n */\n.vm-editor {\n  flex-shrink: 0;\n}\n.vm-editor__wrapper {\n  position: relative;\n  padding: 0;\n  height: 100%;\n  border: 1px solid #0000001a;\n  border-radius: 0px;\n  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.15);\n  background: #fff;\n  z-index: 2;\n}\n\n.vm-editor__arrow {\n  left: -7px;\n  top: 20px;\n  width: 14px;\n  height: 14px;\n  transform: translateX(-50%) rotate(45deg);\n  box-shadow: -3px 3px 7px rgba(0, 0, 0, 0.07);\n  background: #fff;\n  transform: rotate(45deg);\n  position: absolute;\n  border-color: #0000;\n  border-style: solid;\n  border-left: 1px solid #0000001a;\n  border-bottom: 1px solid #0000001a;\n}\n\n/*# sourceMappingURL=editor.vue.map */",'<template>\n\t<div \n\t\t:style="{flex: `0 0 ${width}px` }" \n\t\tclass="vm-editor vm-hack-editor"\n\t>\n\t\t<div class="vm-editor__wrapper">\n\t\t\t\x3c!-- <div class="vm-editor__arrow" /> --\x3e\n\t\t\t<component\n\t\t\t\tref="target"\n\t\t\t\t:is="`vm-${value.module}-editor`"\n\t\t\t\tv-bind.sync="value"\n\t\t\t\t@change="handleChange"\n\t\t\t/>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { valueIsNaN, hasOwn, getUid, debounce } from "../../utils/helper";\n\nexport default {\n\tname: \'vm-editor\',\n\tcomponents: {\n\t},\n\tprops: {\n\t\tdataSource: Array,\n\t\tvalue: Object,\n\t\twidth: {\n\t\t\ttype: Number,\n\t\t\tdefault: 327\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tcurrentId: this.value.id\n\t\t};\n\t},\n\tcomputed: {\n\t},\n\twatch: {\n\t\t"value.module": {\n\t\t\thandler(v) {\n\t\t\t\tthis.resetCurEditor(this.value.id);\n\t\t\t}\n\t\t}\n\t},\n\tmethods: {\n\n\t\t/**\n\t\t * 延迟触发\n\t\t * 用户端在激活时不要立马做操作，否者会存在问题\n\t\t * TODO: 失焦时为异步情况，editor会被销毁，可以设计一个专门为API(传id)\n\t\t */\n\t\tresetCurEditor: debounce(function (id) {\n\t\t\tthis.currentId = id;\n\t\t}, 50),\n\n\t\t/**\n\t\t * hack操作\n\t\t * 业务上避免使用该操作\n\t\t */\n\t\thandleChange(opts = {}) {\n\t\t\tif (typeof opts !== \'object\') return;\n\t\t\tfor (let key in opts) {\n\t\t\t\tlet val = opts[key];\n\n\t\t\t\t[\'x\', \'y\', \'z\', \'r\', \'w\', \'h\'].includes(key) && (val = Number(val));\n\n\t\t\t\tif (hasOwn(opts, key) && !valueIsNaN(val)) {\n\t\t\t\t\tthis.$emit(\'change\', {\n\t\t\t\t\t\ttype: \'update\',\n\t\t\t\t\t\tid: this.currentId,\n\t\t\t\t\t\tchanged: {\n\t\t\t\t\t\t\t[key]: val\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n};\n<\/script>\n<style lang="scss">\n@import "../../style/index.scss";\n\n$block: vm-editor;\n\n@include block($block) {\n\tflex-shrink: 0;\n\t// margin-left: 20px;\n\t// min-width: 446px; // 暂时写死\n\t// max-width: 446px;\n\t// flex: 0 0 354px;\n\t@include element(wrapper) {\n\t\tposition: relative;\n\t\tpadding: 0;\n\t\theight: 100%;\n\t\tborder: 1px solid #0000001a;\n\t\tborder-radius: 0px;\n\t\tbox-shadow: 0 2px 12px rgba(0, 0, 0, 0.15);\n\t\tbackground: #fff;\n\t\tz-index: 2;\n\t}\n\t@include element(arrow) {\n\t\tleft: -7px;\n\t\ttop: 20px;\n\t\twidth: 14px;\n\t\theight: 14px;\n\t\ttransform: translateX(-50%) rotate(45deg);\n\t\tbox-shadow: -3px 3px 7px rgba(0, 0, 0, 0.07);\n\t\tbackground: #fff;\n\t\ttransform: rotate(45deg);\n\t\tposition: absolute;\n\t\tborder-color: #0000;\n\t\tborder-style: solid;\n\t\tborder-left: 1px solid #0000001a;\n\t\tborder-bottom: 1px solid #0000001a;\n\t}\n}\n</style>\n']},media:void 0})}),gn,void 0,!1,void 0,!1,R,void 0,void 0);function vn(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function xn(t){for(var n=arguments,e=1;e<arguments.length;e++){var r=null!=n[e]?n[e]:{};e%2?vn(r,!0).forEach((function(n){s(t,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vn(r).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}var En=l(ft.components(["Preview","PreviewPopup"]),2),yn=En[0],wn=En[1];n.Draggable=L,n.Sortable=q,n.Widget=Z,n.createVMDrags=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dt,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=n.mode,r=void 0===e?"draggable":e;try{Object.keys(t).forEach((function(n){"page"===t[n].module&&(t[n].data=xn({},o.cloneDeep("function"==typeof t[n].data?t[n].data(0,t):t[n].data),{draggable:!1,closeable:!1,resizable:!1,rotatable:!1}))}));var i=o.cloneDeep(n.Combo||Ot),a=o.cloneDeep(n.Frame||("draggable"===r?cn.Draggable:cn.Sortable)),s=o.cloneDeep(n.Widget||hn),l=o.cloneDeep(n.Preview||yn),A=o.cloneDeep(n.Editor||fn),d={},m={},c={};Object.keys(t).forEach((function(n,e){var r=o.kebabCase(n),i=t[n],a=i.Viewer,s=i.Editor,l=i.Widget;d["vm-".concat(r,"-viewer")]=a,m["vm-".concat(r,"-editor")]=s,c["vm-".concat(r,"-widget")]=l})),i.modules=t,i.viewers=d,i.editors=m,a.components=xn({},a.components,{},d),A.components=xn({},A.components,{},m),s.components=xn({},s.components,{},c),i.components=xn({},i.components,{"vm-frame":a,"vm-editor":A,"vm-widget":s}),l.components=xn({},l.components,{},d);var p=o.cloneDeep(i),u=o.cloneDeep(l),h=new f(wn,{mode:r,promise:!1,components:{"vm-preview":l}});return u.popup=h.popup,u.destroy=h.destroy,p.previewManager=h,{Combo:p,Preview:u}}catch(t){throw console.error("[wya-vm/register]",t),new Error(t)}}}}]);